
### 1. 基本概念

#### **(1) 接口分类**

- **按数据传送格式**：
    
    - **并行接口**：接口与总线、接口与外设均并行传送。适用于距离近、设备本身并行的场合 1。
        
    - **串行接口**：接口与总线并行，但与外设串行传送（需串-并转换）。适用于距离远、线少或是串行设备 2。
        
- **按时序控制方式**：
    
    - **同步接口**：由统一时序信号控制 3。
        
    - **异步接口**：采用应答（握手）方式 4。
        
- **按 I/O 传送控制方式**：直接程序传送接口、中断接口、DMA 接口 5。
    

#### **(2) 总线定义与分类**

- **定义**：一组能为多个部件**分时共享**的信息传送线路及控制逻辑 6。
    
- **分类**：
    
    - **按功能**：CPU 内总线、部件内总线、系统总线（板级）、外总线（通信）7。
        
    - **按时序**：同步总线（统一时钟）、异步总线（握手信号）、扩展同步总线 8。
        
    - **按数据格式**：并行总线、串行总线 9。
        

#### **(3) 中断定义与应用**

- **定义**：CPU 暂停现行程序，转去执行随机事态的中断处理程序，处理完后自动恢复原程序 10。
    
- **应用**：管理中低速 I/O、故障处理、实时处理、人机对话 11。
    
- **关键过程**：
    
    - **请求**：外设发 `IREQ`，需满足“完成”且“未屏蔽” 12。
        
    - **判优**：硬件（链式/8259A）或软件决定响应谁 13。
        
    - **响应**：CPU 发 `INTA`，关中断，保断点，取向量 14。
        
    - **处理**：保护现场 $\to$ 服务 $\to$ 恢复现场 $\to$ 返回 15。
        

#### **(4) DMA 定义与应用**

- **定义**：直接存储器访问。依靠硬件在**主存与外设**间进行**批量、快速**传送，**无需 CPU 干预** 16。
    
- **应用**：高速 I/O 设备（磁盘、显卡）、DRAM 刷新 17。
    
- **关键过程**：
    
    - **请求**：接口缓冲满/空时向 DMA 控制器发请求。
        
    - **判优/响应**：DMA 控制器向 CPU 申请总线，CPU 在**存取周期结束**时让出总线 18。
        
    - **处理**：DMA 接管总线，发地址和读写命令，直接传送数据。
        

---

### 2. 中断接口的组成、设计及中断全过程

#### **(1) 中断接口的组成**

一个标准的中断接口（如基于 8259A）通常包含以下部分 19：

1. **寄存器组**：
    
    - **命令字寄存器**：接收 CPU 的控制命令。
        
    - **状态字寄存器**：反馈设备状态（忙/闲/错）。
        
    - **数据缓冲器**：暂存数据。
        
2. **控制逻辑**：
    
    - **地址译码（R选择）**：选中接口。
        
    - **请求逻辑**：生成中断请求信号。
        
3. **中断控制器 (8259A)**：核心部件，负责接收请求、判优、屏蔽，并向 CPU 提供**中断类型码**。
    

#### **(2) 中断接口设计（扩展设计）**

当硬件中断线（如 IRQ2）不足时，采用 **“硬件共享 + 软件查询”** 的设计 20：

- **硬件**：多个外设的请求信号通过“或门”连到同一根 IRQ 线。
    
- **软件**：CPU 响应后进入同一个服务程序，先**查询各设备的状态寄存器**，判断具体是哪个设备申请，再跳转到对应的处理代码。
    

#### **(3) 中断全过程**

这是软硬件协同的接力赛 21212121：

+1

1. **初始化**：CPU 设置屏蔽字和中断向量。
    
2. **启动**：CPU 发命令启动外设。
    
3. **请求**：外设完成工作，接口发 `IREQ`，8259A 判优后发 `INT` 给 CPU。
    
4. **响应 (硬件 IT 周期)**：
    
    - CPU 发 `INTA`。
        
    - **关中断**，保护断点 (PC, PSW)。
        
    - 获取 **中断类型码**，查 **向量表**，得到入口地址。
        
5. **处理 (软件服务程序)**：
    
    - **保护现场**（压栈）。
        
    - **开中断**（如果是多重中断）。
        
    - 执行服务。
        
    - **关中断**，**恢复现场**。
        
    - **中断返回** (`IRET`)。
        

---

### 3. 磁盘调用过程（DMA 方式的三个阶段）

磁盘读写是 DMA 的典型应用，全过程分为三个阶段 22：

#### **第一阶段：初始化 (预处理)**

- **由 CPU 执行**。
    
- CPU 向 **磁盘适配器** 发送寻址信息（驱动器号、磁道、扇区）。
    
- CPU 向 **DMA 控制器** 发送控制信息（传送方向、主存首地址、交换数据量）。
    
- 适配器启动寻道，准备数据。
    

#### **第二阶段：数据传送 (DMA 传送)**

- **由 DMA 控制器 主导**。
    
- 当适配器的缓冲器准备好（读盘满/写盘空）时，发 DMA 请求。
    
- DMA 控制器接管总线，指挥数据在 **适配器 RAM** 和 **主存** 之间直接传输。
    
- 此过程 **CPU 不参与**，仅暂停总线使用。
    

#### **第三阶段：善后处理 (后处理)**

- **由 中断系统 执行**。
    
- 批量数据传送结束（计数器为 0），适配器向 CPU 发出 **中断请求**。
    
- CPU 响应中断，检查传送状态（是否成功、校验错），决定是否结束或继续读写下一扇区。