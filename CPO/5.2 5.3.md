# 5.2 模型机系统总线组成

这一节（**课件 P3-P7**）以一个具体的教学模型机为例，展示了系统总线到底由哪些线组成，以及它们是如何配合工作的。

#### **1. 总线信号的物理组成 (78条线)**

模型机的总线被定义为 **78 条信号线**，按功能分为四大类 1：

- **① 电源与地线 (16条)**：
    
    - 包括 +5V, -5V, +12V, -12V 等电源线和地线。
        
    - _特点_：设计了**附加地线**，用于隔离电源线和信号线，**抑制干扰** 2。
        
- **② 地址线 (16条)**：
    
    - $A_0 \sim A_{15}$。
        
    - _能力_：寻址空间为 $2^{16} = 64KB$（包含主存和 I/O 端口）3。
        
- **③ 数据线 (16条)**：
    
    - $D_0 \sim D_{15}$，意味着这是一个 16 位的机器 4。
        
- **④ 控制信号线 (30条)** —— **最复杂的一组** 5：
    
    - **时序类**：同步定时信号、复位信号。
        
    - **总线仲裁类**：`BREQ` (总线请求), `BACK` (总线响应), `BUSY` (总线忙)。
        
    - **中断类**：`IREQ` (中断请求), `INTA` (中断响应)。
        
    - **数据传输类**：`MEMR/W` (读写内存), `IOR/W` (读写接口)。
        

#### **2. 总线操作与时序 (Bus Timing)**

这一部分深入讲解了**异步控制**的三种握手协议（必考点）6：

- **不互锁 (Non-Interlocked)**：
    
    - 主设备发请求，发完就撤；从设备发回答，发完就撤。
        
    - _特点_：**速度最快**，但不可靠（万一没以此收到怎么办？）。
        
- **半互锁 (Semi-Interlocked)**：
    
    - 主设备发请求，**一直保持**直到收到回答才撤销。
        
    - _特点_：保证了请求一定被送达。
        
- **全互锁 (Fully-Interlocked)** —— **最可靠**：
    
    - 主设备发请求 $\rightarrow$ 从设备发回答 $\rightarrow$ 主设备撤销请求 $\rightarrow$ 从设备撤销回答。
        
    - _特点_：像两个人握手，确认彼此都松开手了才算结束，极其可靠但**速度最慢**。



# 5.3 直接程序传送方式与接口


这一节（**课件 P8-P10**）介绍了最原始、最简单的 I/O 控制方式，通常被称为 **“程序查询方式” (Polling)**。

#### **1. 核心原理**

- **完全由软件主导**：I/O 操作的每一步（启动、检查、传送）都必须由 CPU 执行指令来完成 。
    
- **工作流程（P10 流程图）** ：
    
    1. **启动**：CPU 向外设发“启动”命令。
        
    2. **踏步等待 (Busy Wait)**：CPU 不断地读取接口的状态寄存器，询问：“做完了吗？做完了吗？”（循环检测状态标志）。
        
    3. **传送**：一旦检测到“外设工作完成”，CPU 执行数据传送指令（输入/输出）。
        

#### **2. 接口状态字 (Status Word)**

为了配合查询，接口中必须设置状态触发器 ：

- `00`：**空闲**。
    
- `01`：**工作**（CPU 看到这个状态就必须继续等）。
    
- `10`：**结束**（CPU 看到这个状态就可以传数据了）。
    

#### **3. 优缺点与适用场景**

- **优点**：硬件极其简单（只要几个状态位），容易实现 。
    
- **缺点**：**CPU 效率极低**。CPU 在外设工作期间（通常很慢）完全被“卡死”在查询循环中，无法做其他计算，**并行程度低**。
    
- **适用**：对 CPU 效率要求不高的地方，或者**硬件诊断、调试**程序中 。
    

---

### 🧠 总结

- **5.2** 告诉你：模型机的总线不仅有数据和地址，还定义了复杂的**握手时序（全互锁最稳）**。
    
- **5.3** 告诉你：最笨的 I/O 方法是**程序查询**，CPU 像个保姆一样时刻盯着外设，虽然简单但太浪费 CPU 时间。
    

这就是为什么后来我们要发明 **中断**（CPU 可以去忙别的，外设好了叫我）和 **DMA**（专门雇个搬运工）的原因，这正是接下来两节的内容。