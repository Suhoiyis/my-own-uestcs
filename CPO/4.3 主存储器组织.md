
# 01. 主存储器的逻辑设计

设计主存的核心逻辑就是两个字：**扩展**。因为单片存储芯片的容量（字数 $\times$ 位数）通常都很小，无法满足计算机的总需求。

我们通过**“字扩展”**、**“位扩展”**以及**“片选逻辑”**来解决这个问题。

---

### 1. 设计前的准备 (Prerequisites)

在动手设计之前，必须明确两个核心指标 1：

1. **目标容量**：总共需要多少**字数**（单元数）和**位数**（字长）？
    
    - _例如_：模型机通常按字编址，每字 16 位。
        
2. **选用芯片**：手头有哪些规格的芯片？
    
    - _例如_：$1K \times 4$ 位，$2K \times 8$ 位等。
        

---

### 2. 三大扩展方式 (Three Expansion Methods)

#### **① 位扩展 (Bit Expansion) —— “加宽”**

- **场景**：芯片的**字数够**（地址线够用），但**位数不够**（数据线太少）。
    
- **做法**：
    
    - 将多片芯片的**地址线**、**片选信号 ($CS$)**、**读写控制线 ($R/W$)** 全部**并联**（接在一起）。
        
    - 将它们的**数据线**分别接到系统数据总线的不同位上（如第一片接 $D_0-D_3$，第二片接 $D_4-D_7$）。
        
- **效果**：所有芯片**同时工作**，共同组成一个完整的字。
    
- _比喻_：一个人搬不动 8 块砖，那就两个人并排站，每人搬 4 块，听同一个口令一起搬。
    

#### **② 字扩展 (Word Expansion) —— “加长”**

- **场景**：芯片的**位数够**（数据线够用），但**字数不够**（容量太小）。
    
- **做法**：
    
    - 将多片芯片的**地址线**（低位）、**数据线**、**读写控制线**全部**并联**。
        
    - **关键点**：**片选信号 ($CS$) 不能并联！**
        
    - 需要利用**高位地址线**通过译码器产生不同的片选信号，每次只让其中**一片**（或一组）芯片工作。
        
- **效果**：扩展了寻址范围。
    
- _比喻_：类似住旅馆，房间号不够了，就多盖几层楼（多加几组芯片），用楼层号（高位地址）来区分去哪一层。
    

#### **③ 字位同时扩展 (Word & Bit Expansion)**

- **场景**：字数和位数都不够。
    
- **做法**：先进行位扩展组成“存储组”，再对这些“组”进行字扩展。
    

---

### 3. 核心难点：地址分配与片选逻辑 (Address Decoding)

这是考试的计算大题重灾区。你需要根据总容量和芯片容量，计算出需要多少芯片，并设计电路。

**经典案例分析（参考课件 P7-P10）：**

- **题目**：用 $2114 (1K \times 4\text{位})$ 芯片组成 $4K \times 8\text{位}$ 的存储器。
    
- **解题步骤**：
    
    1. **算数量**：
        
        - 总容量 = $4K \times 8\text{位}$。
            
        - 单片 = $1K \times 4\text{位}$。
            
        - 需要芯片数 = $(4K/1K) \times (8/4) = 4 \times 2 = 8$ 片。
            
    2. **分组**：
        
        - 每 2 片进行**位扩展**（$1K \times 4 \to 1K \times 8$），组成一组。
            
        - 共需要 4 组（$1K \times 8 \to 4K \times 8$）。
            
    3. **分地址**：
        
        - 单片是 1K，需要 10 根地址线 ($A_0 \sim A_9$) 作为**片内地址**，直接连到所有芯片上。
            
        - 总需求 4K，需要 12 根地址线 ($A_0 \sim A_{11}$)。
            
        - 多出来的 **高位地址 ($A_{10}, A_{11}$)** 用来做**片选**。
            
    4. **设计片选逻辑**（核心）：
        
        - 利用 $A_{11}$ 和 $A_{10}$ 的组合（00, 01, 10, 11）产生 4 个信号 ($\overline{CS_0} \sim \overline{CS_3}$)，分别控制 4 组芯片 3。
            

---

### 4. 总结：设计存储器的“三步走”

1. **算**：根据总容量 $\div$ 单片容量，算出要几片，分几组。
    
2. **连**：
    
    - **数据线**：分段连接（位扩展）。
        
    - **低位地址线**：全部并联（片内寻址）。
        
    - **控制线**（读写）：全部并联。
        
3. **译**：
    
    - **高位地址线** $\to$ **译码器/门电路** $\to$ **片选信号 ($CS$)**。