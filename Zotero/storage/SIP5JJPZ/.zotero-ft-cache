分类号 TP391 学校代号 10462
密 级 公开 学 号 332207050649
硕士学位论文
面向稳态视觉诱发电位的脑解码个体适配
性技术研究
学 位 类 型 : 专业学位
学 位 申 请 人 : 张思源
导 师 姓 名 及 职 称 : 南姣芬副教授
学 科 / 领 域 代 码 : 085404
学 科 / 领 域 名 称 : 计算机技术
培 养 学 院 : 计算机科学与技术学院
论 文 提 交 日 期 : 2025 年 5 月


A Dissertation Submitted to
Zhengzhou University of Light Industry
for the Degree of Master
Research on Individual Adaptation Techniques for Brain
Decoding of Steady-State Visual Evoked Potentials
By Siyuan Zhang
Supervisor: Prof. Jiaofen Nan
Computer Technology
School of Computer Science and Technology
May 2025


I
摘要
稳态视觉诱发电位(Steady-State Visual Evoked Potential, SSVEP)作为脑机接口
(Brain-Computer Interface, BCI)的重要范式,其识别性能受个体神经响应差异性的制
约。本研究围绕 SSVEP 识别中的个体适配性问题,从数据长度适配、滤波器组参数适
配以及跨被试适配三个维度展开脑解码技术研究,主要内容如下:
(1)针对个体时域响应差异性导致的数据长度适配问题,提出基于改进任务相关
成 分 分 析 ( Task-related Component Analysis, TRCA ) 的 数 据 长 度 适 配 方 法 。 传 统
SSVEP 识别普遍采用预设长度(通常为 0.5-1 秒)的脑电信号片段进行解码,这种策略
忽视了不同被试的神经响应速度差异。本研究创新性地构建自适应机制,通过协方差
分析量化不同数据长度下特征的分类性能,建立数据长度-分类性能映射模型。通过在
TRCA 的特征提取阶段中引入与协方差分析更匹配的典型相关分析,实现特征提取过
程与最优数据长度的协同优化。该方法在 Benchmark 数据集和 BETA 数据集上的解码
正确率分别为 97.04%和 77.21%,与传统的 TRCA 方法相比分别提升了 2.77%和 4.68%。
实验结果显示,该方法有效解决了预设数据长度方法在面对个体响应差异时导致解码
性能下降的问题,有效提升 SSVEP 解码的准确率。
(2)针对滤波器组参数固化导致的个体特征失配问题,提出基于麻雀优化算法
(Sparrow Search Algorithm, SSA)的 TRCA 滤波器组优化框架。现有 SSVEP 识别系统
普遍采用预设参数的滤波器组技术,这种经验性的参数设置难以适配不同被试间的频
域响应特性差异。本研究将群体智能优化算法引入 SSVEP 的信号识别中,构建 SSA
TRCA 双阶段优化模型:第一阶段通过 SSA 全局搜索确定个体最优滤波器组参数组合;
第二阶段采用 TRCA 进行多子频带特征提取、融合与分类决策。结果表明,优化后的
滤波器组使 TRCA 在 Benchmark 数据集上的识别准确率提升至 91.27%,较原始 TRCA
提高了 1.44%;在 CA 数据集上达到 81.67%,提升幅度为 1.40%。该双阶段优化模型
有效缓解了由于个体差异性导致的滤波器组性能下降问题,显著增强了 SSVEP 信号的
解码准确率。
(3)针对现有 SSVEP 解码技术在跨被试上适配性较差的问题,提出了一种基于
特征迁移的多决策融合模型。该模型通过双域网络将源域和目标域数据映射至正弦-余
弦模板,以减少跨主体域间的差异并提升迁移效果。为增强目标域主体的测试性能,
采用基于源混叠矩阵估计和锁相时移的数据增强方法,以扩展目标域训练样本,并将


II
其融入改进的集成任务相关成分分析(TRCA based on kendall,eTRCA-K)与任务判别
成分分析(Task Discriminant Component Analysis, TDCA)的训练过程。最终,融合双
域网络、eTRCA-K 及 TDCA 的输出结果,用于 SSVEP 信号分类。实验结果表明,在
数据长度为 0.5s 的条件下,该方法在 Benchmark 数据集和 BETA 数据集上的识别准确
率分别达到 78.94% 和 65.69%。相比于 OS-SSVEP 方法,准确率分别提升了 2.41% 和
1.73%。结果表明,该方法有效缓解了跨受试者特征迁移过程中的域间差异问题,显著
提高了跨被试 SSVEP 解码的准确性。
综上所述,本研究从被试内和跨被试两个角度,围绕 SSVEP 解码过程中的个体差
异性问题,进行了三项研究,解决了被试内数据长度适配、个性化参数适配以及跨被
试迁移适配问题。结果表明,所提的方法在识别准确率和信息传输速率方面具有显著
优势。
关键词:脑电;稳态视觉诱发电位;任务相关成分分析;迁移学习


III
ABSTRACT
Steady-State Visual Evoked Potential (SSVEP) is a critical paradigm in Brain-Computer
Interfaces (BCI), but its classification performance is constrained by individual variability in
neural responses. This study addresses the challenge of individual adaptation in SSVEP
recognition by investigating three key dimensions: data length adaptation, filter bank
parameter optimization, and cross-subject adaptation. The main contributions are as follows:
(1) To address the issue of data length adaptation caused by individual differences in
temporal neural responses, a dynamic data length adaptation method is proposed based on an
improved Task-related Component Analysis (TRCA). Conventional SSVEP classification
methods typically utilize fixed-length EEG segments (commonly 0.5–1 second) for decoding,
disregarding inter-subject variations in neural response latency. To tackle this limitation, an
adaptive mechanism is introduced by leveraging covariance analysis to quantify classification
performance across different segment lengths, thereby establishing a mapping model between
data length and classification accuracy. Furthermore, canonical correlation analysis is
incorporated into the TRCA feature extraction process to better align with covariance analysis,
enabling joint optimization of feature extraction and optimal data length selection.
Experimental results demonstrate that the proposed approach achieves classification
accuracies of 97.04% and 77.21% on the Benchmark and BETA datasets, respectively,
outperforming traditional TRCA by 2.77% and 4.68%. These findings validate the efficacy of
the proposed method in mitigating the performance degradation caused by fixed-length data
selection, significantly enhancing SSVEP decoding accuracy.
(2) To overcome the issue of feature mismatches caused by fixed filter bank parameters,
a TRCA-based filter bank optimization framework is introduced by utilizing the Sparrow
Search Algorithm (SSA). Existing SSVEP classification systems commonly employ pre
defined filter bank configurations, which fail to accommodate inter-subject differences in
spectral response characteristics. This study integrates swarm intelligence optimization into
SSVEP recognition, constructing an SSA-TRCA two-stage optimization model. In the first
stage, SSA performs a global search to determine the subject-specific optimal filter bank
parameters. In the second stage, TRCA is employed for multi-subband feature extraction,
fusion, and classification. Experimental results indicate that the optimized filter bank


IV
improves TRCA’s classification accuracy to 91.27% on the Benchmark dataset (an increase of
1.44%) and 81.67% on the CA dataset (an improvement of 1.40%). This two-stage
optimization effectively mitigates the performance degradation induced by inter-subject
variability in filter bank design, significantly enhancing SSVEP decoding accuracy.
(3) To address the challenge of cross-subject adaptation in SSVEP decoding, a multi
decision fusion model is proposed based on feature transfer learning. This model employs a
dual-domain network to map source and target domain data onto a sine-cosine template,
thereby reducing domain shifts and enhancing transfer effectiveness. To further improve
target-domain classification performance, a data augmentation strategy incorporating source
aliasing matrix estimation and phase-locked time-shift is introduced, increasing the diversity
of target-domain training samples. These augmented samples are then incorporated into an
improved ensemble TRCA framework (eTRCA-K) based on Kendall’s correlation and Task
Discriminant Component Analysis (TDCA). The final classification decision is obtained by
fusing outputs from the dual-domain network, eTRCA-K, and TDCA. Experimental results
demonstrate that under a 0.5s data length condition, the proposed approach achieves
classification accuracies of 78.94% and 65.69% on the Benchmark and BETA datasets,
respectively, outperforming the OS-SSVEP method by 2.41% and 1.73%. These results
confirm that the proposed method effectively mitigates domain shifts in cross-subject transfer
learning, substantially improving SSVEP decoding accuracy across subjects.
In summary, this study systematically investigates the challenge of individual variability
in SSVEP decoding from both within-subject and cross-subject perspectives. Three key
advancements are introduced, addressing subject-specific data length adaptation, personalized
parameter optimization, and cross-subject transfer learning. Experimental results validate the
proposed methods' superiority in classification accuracy and information transfer rate,
offering significant advancements for SSVEP-based BCI applications.
keywords: EEG; Steady-State Visual Evoked Potential; TRCA; Transfer learning


目录
第一章 绪论...............................................................................................1
1.1 背景和意义.......................................................................................1
1.2 国内外研究现状...............................................................................2
1.2.1 传统 SSVEP 解码技术研究现状...............................................2
1.2.2 基于深度学习的 SSVEP 解码技术研究现状 ..........................3
1.2.3 基于个体适配的 SSVEP 解码技术研究现状 ..........................4
1.3 本文研究内容及创新点...................................................................6
1.4 本文的组织框架...............................................................................6
第二章 基础理论及数据来源 ..................................................................8
2.1 SSVEP 信号的产生...........................................................................8
2.2 SSVEP 信号的特点...........................................................................8
2.3 SSVEP 脑电信号采集.......................................................................8
2.3.1 电极放置.....................................................................................8
2.3.2 实验设计.....................................................................................9
2.3.3 数据采集...................................................................................10
2.4 数据预处理.....................................................................................10
2.4.1 伪影去除...................................................................................10
2.4.2 滤波处理...................................................................................11
2.5 数据来源.........................................................................................11
2.5.1 Benchmark Dataset ....................................................................11
2.5.2 BETA Dataset.............................................................................12
2.5.3 CA Dataset .................................................................................12
2.6 评价指标.........................................................................................12
2.7 本章小结.........................................................................................13
第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法..........14
3.1 引言.................................................................................................14
3.2 方法.................................................................................................14
3.3 结果与分析.....................................................................................17
3.3.1 实验设置...................................................................................17
3.3.2 初始数据长度设置的影响.......................................................17
3.3.3 基于改进 TRCA 数据长度适配方法的回归结果..................18
3.3.4 AncTRCA 与 AncTRCA-CCA 的对比 ..................................19
3.3.5 不同方法的性能对比...............................................................22
3.4 本章小结.........................................................................................22


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法 .24
4.1 引言.................................................................................................24
4.2 方法.................................................................................................24
4.3 结果与分析.....................................................................................27
4.3.1 不同数据长度对 SSVEP 解码性能的影响 ............................27
4.3.2 不同滤波器组参数对 SSVEP 解码性能的影响 ....................30
4.3.3 不同滤波器组参数组合对 SSVEP 解码性能的影响 ............31
4.3.4 滤波器组参数适配技术对 SSVEP 解码性能的影响 ............33
4.4 本章小结.........................................................................................34 第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法 ..........36
5.1 引言.................................................................................................36
5.2 方法.................................................................................................36
5.3 结果与分析.....................................................................................42
5.3.1 基于 eTRCA-K 决策的 SSVEP 解码性能 ..........................42
5.3.2 多决策模型与主流模型的 SSVEP 解码性能对比 ................43
5.3.3 多决策跨被试适配模型的消融实验.......................................46
5.4 本章小结.........................................................................................48
第六章 总结与展望 ................................................................................50
6.1 论文工作总结.................................................................................50
6.2 未来工作展望.................................................................................51
参考文献...................................................................................................52


第一章 绪论
1
第一章 绪论
1.1 背景和意义
稳态视觉诱发电位(Steady-State Visual Evoked Potential,SSVEP)是一种由周期
性视觉刺激(如闪烁或振荡的光源)引发的大脑生理响应[1]。由于其信号稳定性好[2, 3]、
信噪比较高[4],SSVEP 已被广泛应用于脑机接口(Brain-Computer Interface,BCI)研
究[5, 6]。BCI 作为神经工程领域的前沿方向之一,为生物脑与外部设备之间提供了一种
无需依赖肌肉和外周神经系统的直接通信方式[7, 8],已被广泛用于拼写界面[9, 10]、游戏
[11, 12]和设备控制[13, 14]。根据与人脑的交互方式,BCI 可分为侵入式和非侵入式两类,
这两种技术近年来都取得了显著进展,并各具特点。侵入式 BCI 通过植入微电极直接
与神经元交互,具有较高的信噪比和低时延等优势。相比之下,非侵入式 BCI 由于无
创 性 和 便 捷 性 , 逐 渐 成 为 BCI 领 域 的 另 一 个 重 要 发 展 方 向 。 其 中 , 基 于 脑 电
(Electroencephalogram, EEG)的 BCI 技术凭借其成熟度、易用性及低成本优势,受到
了广泛关注[15]。EEG-BCI 主要包括基于运动想象(Motor Imagery, MI)的 BCI[16-18]、
基于事件相关电位(Event-Related Potentials, ERPs)的 BCI[19-21]以及基于 SSVEP 的
BCI[22]等多种实验范式。其中,基于 SSVEP 的 BCI 由于其无需用户大量训练、易于实
施、信息传输速率(information transfer rate, ITR)较高等优势,已被广泛应用于辅助
通信[23, 24]、医疗康复[25, 26]和智能控制[27, 28]等领域。
目前,许多学者基于 SSVEP 提出了各种特征提取及解码方法。例如典型相关分析
(Canonical Correlation Analysis,CCA)[29]、基于滤波器组的典型相关分析(Filter
Bank Canonical Correlation Analysis,FBCCA)[30]、任务相关成分分析(Task-Related
Component Analysis,TRCA)[31]等,均取得了显著成果。尽管 SSVEP 取得了不错的成
果,但个体差异性仍然是其应用推广的关键挑战之一。不同个体在 SSVEP 响应的幅值、
相位、谐波成分及信噪比等方面存在显著差异,这些个体间的神经生理差异可能受到
年龄、疲劳程度、注意力水平及视力状况等因素的影响,导致同一算法在不同受试者
上的性能表现存在较大波动。此外,即使是同一受试者,其 SSVEP 反应在不同时间点
或实验环境下也可能有所变化,从而进一步增加了解码的复杂性。因此,提高 SSVEP
解码技术对个体差异的适应性,不仅是提升系统解码性能和用户体验的关键,也是提
高 BCI 在实际应用中稳定性和普适性的核心挑战之一。
综上所述,面向 BCI 系统的应用需求,从差异化角度出发,进行 SSVEP 脑解码个


第一章 绪论
2
体适配性技术研究具有重要的价值。
1.2 国内外研究现状
1.2.1 传统 SSVEP 解码技术研究现状
SSVEP 识别的传统算法在早期阶段主要依赖短时傅里叶变换(short-time Fourier
transform,STFT)技术获取信号的频谱特征以实现频率成分的识别[32]。然而,此类算
法对数据长度有较高的依赖性,过短的数据长度无法保证其正确率,随后基于 STFT 的
算法逐渐被计算效率更高、短时适应性更强的算法所取代。2007 年,Gao 等人[29]提出
了 CCA 的方法,在 SSVEP 识别中取得了较好的效果,该方法旨在通过计算多通道脑
电信号与不同视觉刺激频率对应的正弦参考信号之间的相关性,实现目标刺激的识别
[33]。鉴于 CCA 算法展现出的优异性能,后续研究者们围绕其多维度优化开展了持续探
索。例如,Chen 等人[30]开发了 FBCCA 算法,该算法利用带通滤波器组将输入的脑电
信号分解为多个子频带成分,然后在这多个子频带成分上执行 CCA 算法,显著提高了
CCA 方法的性能。此外,Zhang 等人[34]开发了一种基于多变量同步指数的频率识别方
法,该方法通过 S-估计算子构建脑电信号与多组参考信号间的同步指数特征,实现不
同频率成分的分类识别。
近年来,随着研究的深入,个体数据在算法设计中的作用逐渐受到重视。其中,
基于空间滤波器的频率识别方法因其能够提取个体独有特征而广受关注。该方法通过
训练受试者特定的空间滤波器,以增强目标信号与背景噪声的区分能力,从而提高识
别精度[35]。其中,TRCA 是一种具有代表性的算法[31],其基本原理是在不同试次的脑
电信号中寻找最优的协方差结构,以构建空间滤波器,从而提取与任务最相关的信号
成分。并且,该研究组在其随后的研究中基于“在相同的混合系数下,每个刺激的空间
滤波器是相似的”这一发现提出了集成的任务相关成分分析(ensemble Task-related
Component Analysis,eTRCA)。鉴于 TRCA 的优势,很多学者在其基础上进行了变形
和改进。例如,Wong 等人[36] 提出了一种跨刺激的学习方法,该方法不仅能够学习目
标刺激的特征,还能泛化到其他刺激的数据,进一步提高了 TRCA 的适应性和稳健性。
与此同时,学者相继提出了多种高性能算法框架,包括最大化信号分数分析算法[37],
任务判别成分分析(Task Discriminant Component Analysis, TDCA)框架[38],以及相关
成分分析等[39]创新方法。


第一章 绪论
3
1.2.2 基于深度学习的 SSVEP 解码技术研究现状
近年来,随着深度学习在图像、语音、文本等领域取得了显著的进展,基于神经
网络和深度学习的算法在 SSVEP 领域也受到更多的青睐[40]。深度学习可以从原始信号
中 自 动 提 取 应 用 于 分 类 的 特 征 , 并 提 高 分 类 准 确 性 。 卷 积 神 经 网 络 ( Convolutional
Neural Networks,CNN)是 SSVEP 解码中最常用的深度学习模型。例如, Kwak 等[41]
提了一种简单的三层卷积神经网络模型,用于分析五种视觉刺激编码频率的脑电数据。
Li 等人[42]提出了一种基于卷积神经网络的非线性模型,即卷积相关分析(Conv-CA)。
Ravi[43]等使用快速傅里叶变换将时域 SSVEP 数据转化为频域数据,并设计了一个复杂
频谱的卷积神经网络。Lawhern[44]等人采用了一种名为 EEGNet 的紧凑型卷积神经网络,
他们采用了深度可分离卷积来构建一个基于 EEG 的特定网络,该网络融合了包括空间
和时间滤波的特征提取概念,实现了显著的性能提升。随后,Waytowich [3]等人,改进
了 EEGNet 并将其应用于异步的 SSVEP-BCI 系统。Guney [45]等人提出了一种深度神经
网络框架,用于处理 SSVEP 子频带信号。该框架在谐波的子频带、通道和时间维度上
进行卷积操作,并通过全连接层进行分类,在两个 SSVEP 数据集上实现了有史以来最
高的 ITR。Pan[46]等人提出了一种名为 SSVEPNet 的网络用于频率识别,该网络基于一
维卷积和 LSTM 模块,同时,采用了谱归一化和标签平滑技术以提升网络性能。在两
个数据集上的实验结果验证了该网络在 SSVEP 分类任务中的有效性。
近年来,基于 Transformer 模型的注意力机制在深度学习领域引起了广泛关注,并
被 应 用 于 SSVEP-BCIs 中 [47] 。 Bagchi and Bathula[48] 提 出 了 一 种 名 为 EEG
ConTransformer 的网络,该网络融合了多头自注意力机制,用于捕捉脑区间的交互模
式 , 并 结 合 卷 积 滤 波 器 以 学 习 时 间 序 列 特 征 。 Chen 等 人 [47] 提 出 了 一 种 基 于
Transformer 的深度神经网络模型,该模型采用 SSVEP 数据的频谱特征作为输入,使其
能够挖掘频谱信息与空间信息。这两种模型在分类准确率和 ITR 方面均优于其他基线
方法,表现出更优的性能。
最近,人们认为单个 SSVEP 分类模型经常存在过拟合或欠拟合问题,并且分类性
能可能较低[49]。为此,Yao[50]等人提出了一种名为 FB-EEGNet 的模型用于 SSVEP 频率
检测,该模型融合了多个神经网络的特征,从而显著提升分类精度。Deng[51]等人提出
了一种名为 TRCA-Net 的算法来提高 SSVEP 信号的分类性能,它首先利用 TRCA 算法
创建空间滤波器来提取与任务相关的特征,然后将来自不同滤波器的特征重新排列为
新的多通道信号,最后用深度 CNN 对重新排列的特征进行分类。然而,TRCA-Net 的
网络结构相对复杂,需要足够多的样本来训练模型,难以在有限的校准数据下有效解


第一章 绪论
4
码 SSVEP。为此,Li[52]等人提出了名为 Dis-ComNet 的判别压缩网络,该网络能使用有
限的校准数据来训练压缩神经网络,以提取更复杂的时空特征。此外,Lee[53]等人提出
了名为 OS-SSVEP 的融合框架,该框架利用源域数据训练网络并借助数据增强方法增
加目标域样本数据,以提取更多的特征。
1.2.3 基于个体适配的 SSVEP 解码技术研究现状
(1)被试内数据长度适配研究现状:目前 SSVEP 解码算法普遍采用预设长度
(通常为 0.5-1 秒)的脑电信号片段进行解码。由于脑电信号的动态变化特性以及个体
间的生理差异,预设的数据长度可能无法充分捕捉每位受试者的最佳神经响应模式,
从而影响系统的解码精度和适应性。近年来,随着自适应方法的提出,为 SSVEP 识别
和分析提供了新的思路。自适应方法主要是依据数据本身或性能判别等方法自适应地
调整被试解码所需的数据长度。例如,Yang[54]等人使用时空均衡算法来减少空间和时
间相关联背景噪声的不利影响,并基于多假设检验理论,采用激励终止方法对动态数
据长度进行自适应控制;Chen[33]等人开发了一种基于假设检验和交叉熵代价函数的无
训练动态方法,以自动确定最优数据长度。Lee[55]等人提出基于协方差分析的自适应方
法,为被试优化数据长度。Jiang 等人[56]提出了一种动态终止策略(dynamic stopping
strategies,DSS),该策略结合判别分析与贝叶斯估计,自适应调整单次频率识别所需
的数据长度。Da Cruz 等人[57] 则根据每个受试者的在线识别性能进行数据长度优化,
以提高实时识别效果。尽管这些方法可以实现被试解码数据长度的自适应优化,但是
在实际应用中仍然存在一定的局限性,例如计算复杂度较高、对参数敏感、在高噪声
环境下稳定性不足等问题。此外,尽管这些方法能够提高识别准确率,但可能导致
ITR 下降,从而影响系统的整体效率。因此,如何在个体自适应优化的同时有效平衡
正确率与 ITR,仍然是 SSVEP-BCI 研究中的关键挑战之一。
(2)被试内滤波器组个性化参数适配研究现状:自 Chen 等人[30]首次将滤波器组
技术引入 SSVEP 研究以来,其在 SSVEP 分析中的重要价值已得到广泛认可[58]。例如,
Nakanishi 等人[31]将其融入 TRCA 算法,Zhang 等人[59]应用于 CORCA 算法,LIU 等人
[38]用于 TDCA 算法,Zhang 等人[60]在其分层特征融合框架中采用该技术,Lee 等人[55]
则将其引入自适应数据长度算法框架。上述算法在 SSVEP 解码方面均展现出更优的性
能。尽管滤波器组技术在一定程度上提高了 SSVEP 的解码性能,然而,现有方法通常
采用预设参数的滤波器组,未能针对个体差异进行优化。不同个体在 SSVEP 响应频段、
谐波成分及噪声分布上存在显著差异。统一的滤波策略可能无法适应所有用户,导致


第一章 绪论
5
部分个体的信号解码效果不佳,从而影响整体系统的稳定性,进而影响系统的解码性
能。此外,预设的滤波参数可能无法动态适应不同实验条件下的噪声水平变化,例如
环境光干扰、电源工频噪声(50/60Hz)以及电极接触不良导致的低频伪影,这些因素
可能进一步降低 SSVEP 信号的信噪比,影响解码准确性。因此,个性化的滤波器组参
数成为提高 SSVEP 识别准确率的关键。
(3)跨被试适配研究现状:迁移学习旨在利用源域数据的知识来提升目标域的学
习效果,从而减少个体间差异对模型性能的影响。然而,在实际应用中,由于个体神
经响应的高度异质性,某些个体难以适应基于源域主体训练的模型,导致测试性能下
降。例如,不同被试受个体生理结构、注意力水平、疲劳程度、年龄及神经可塑性等
多种因素的影响。这些因素使得基于统一源域模型的迁移策略难以适用于所有目标域
受试者,影响分类性能和泛化能力。例如,Deng 等人[53]提出了一种基于最小二乘变换
的迁移学习框架,该方法将源域和目标域数据映射至正弦-余弦模板,以减少跨主体域
间的差异。虽然 Deng 的方法在一定程度上提升了跨个体迁移的效果,但其框架中的数
据增强策略存在一定局限性。该方法采用了基于源混叠矩阵估计(Source Aliasing
Matrix Estimation,SAME) [61]的数据增强方式,该策略依赖正弦-余弦模板生成人工信
号。然而,由于 SSVEP 信号个体差异显著,通用的正弦-余弦模板难以精准适配所有
受试者的独特反应模式。例如,某些被试的 SSVEP 信号可能包含较强的特定谐波成分
或存在相位偏移,这些特征在模板中可能未被充分体现,导致目标域信号与增强数据
的匹配度较低,影响模型的识别效果。同时,实际采集的 SSVEP 数据受多种噪声和干
扰影响,包括电源噪声(50/60 Hz 工频干扰)、电极接触不良、眼电/肌电伪影、个体注
意力波动及脑电非平稳性等,这些因素使得 SSVEP 数据的时间域和频率域特征具有复
杂的噪声分布。然而,SAME 数据增强策略在添加随机高斯噪声时,并未考虑真实噪
声的统计特性和复杂分布,例如,真实噪声可能具有特定的频率分布或非高斯特性,
而高斯噪声的简单叠加可能会掩盖目标信号的有效特征,使得模型难以区分有效信号
与噪声特征,降低了对目标域个体数据的适应能力。因此,如何优化特征迁移框架及
数据增强策略,使其更符合个体 SSVEP 信号的特征,是提高跨被试解码性能的关键问
题。
综上所述,在 SSVEP 解码的个体适配性上仍然存在诸多亟待解决的难题。在被试
内数据长度适配技术方面,现有方法虽在一定程度上提升了解码精度,却无法兼顾正
确率与 ITR,致使 ITR 表现欠佳;在滤波器组参数适配方面,当前预设参数的做法,
难以契合不同个体在 SSVEP 响应频段、谐波成分等方面的差异,显著降低了解码准确


第一章 绪论
6
率;在跨被试适配方面,现有的 SSVEP 数据增强和特征迁移框架泛化能力不足,导致
识别准确率得不到保障。
1.3 本文研究内容及创新点
本文的研究内容及创新点如下:
(1)针对个体时域响应差异性导致的数据长度适配问题,创新性地提出一种基于
改进 TRCA 的数据长度适配方法。该方法通过协方差分析构建数据长度与分类性能之
间的映射模型,实现数据长度的自适应调整。通过在 TRCA 的特征提取阶段中引入与
协方差分析更匹配的典型相关分析,实现特征提取过程与最优数据长度的协同优化。
该方法充分整合了协方差分析和改进 TRCA 的优势,显著提升了 SSVEP 的识别性能。
(2)针对滤波器组参数固化导致的个体特征适配问题,提出基于 SSA 的 TRCA
滤波器组优化框架,构建 SSA-TRCA 双阶段优化模型。该模型在第一阶段利用 SSA 进
行全局搜索,自动确定最优的个体滤波器组参数组合;第二阶段基于优化后的参数组
合,采用 TRCA 提取多子频带特征并完成分类。该双阶段优化模型弥补了个体差异性
导致的滤波器组性能下降问题,显著改善了 SSVEP 识别系统的分类性能与鲁棒性。
(3)针对跨被试适配问题,提出了一种基于特征迁移的多决策融合模型。该模型
首先构建双域神经网络,将源域与目标域数据统一映射至正弦-余弦模板空间,降低域
间 分 布 差 异 , 增 强 迁 移 能 力 。 为 提 升 目 标 域 测 试 性 能 , 引 入 SAME 与 锁 相 时 移
(phase-locked time-shift,PLTS)[62]的数据增强方法扩展目标样本,并将其融入改进的
集成任务相关成分分析(TRCA based on kendall,eTRCA-K)与 TDCA 的训练过程中。
最终,双域网络、eTRCA-K 与 TDCA 的多模型输出通过融合策略完成分类决策。该方
法显著提升了 SSVEP 跨主体特征迁移的适应性与分类性能,具备良好的泛化能力。
1.4 本文的组织框架
本文主要针对个体差异导致的 SSVEP-BCI 解码模型适配问题,以提升 SSVEP-BCI
的解码准确率和适应性为出发点。从被试内和跨被试两个层面提出改进方案。全文共
分为六个章节,各章节的具体内容安排如下:
第一章,绪论。本章首先介绍 SSVEP 及其在 BCI 系统中的研究背景及重要性,重
点讨论 SSVEP 在 BCI 应用中的优势。随后,介绍传统学习方法、深度学习方法以及个
体适配方法在 SSVEP 信号解码中的研究进展。接着,阐述本文的主要研究内容与创新
点,重点介绍数据长度适配、滤波器组适配及跨被试适配。最后,对全文的章节结构


第一章 绪论
7
进行简要说明。
第二章,基础理论及数据来源。本章介绍了 SSVEP 的基本原理、信号特性、采集
与预处理方法,以及相关数据集与评价指标。首先,介绍 SSVEP 信号的产生机制,阐
述其与枕叶视觉皮层神经活动的关系。其次,分析 SSVEP 信号的特点,包括其稳定性、
信噪比优势等。随后,详细介绍 SSVEP 脑电信号的采集,涵盖电极放置、实验设计、
数据采集等关键环节。接着,探讨 SSVEP 信号的预处理方法,包括伪影去除、滤波处
理等技术。最后,介绍研究所使用的 SSVEP 数据集,并阐述数据参数设置及主要评价
指标,为后续研究奠定基础。
第三章,基于改进 TRCA 数据长度适配的 SSVEP 解码方法。本章针对被试内
SSVEP 信号解码中的数据长度适配问题,首先,描述自适应数据长度方法的概念,分
析个体差异对 SSVEP 信号解码的影响,以及预设数据长度方法的局限性。随后介绍了
本章所提出方法的详细步骤。最后,通过实验结果分析,评估本章方法的有效性及泛
化能力。
第四章,基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法。本章针对被试内
SSVEP 信号解码中的滤波器组适配问题,首先,描述滤波器组方法在信号处理中的应
用及其在 SSVEP 分析中的重要性,分析现有研究中预设滤波器组参数的局限性。随后
介绍了本章所提出方法的详细步骤。最后基于实验结果,评估该方法的有效性以及存
在的局限性。
第五章,基于多决策融合模型的跨被试适配 SSVEP 解码方法。本章针对跨被试
SSVEP 信号解码中的适配问题,首先,描述迁移学习在 SSVEP 研究中的应用及其在跨
个体脑电信号分析中的重要性,分析个体差异对迁移学习模型性能的影响。接着,详
细阐述了所提方法的具体实现步骤。最后,通过实验结果对该方法的泛化能力进行评
估,系统分析各个模块的贡献,以验证其在跨个体 SSVEP 解码中的有效性和稳定性。
第六章,总结与展望。本章对本文在 SSVEP 信号解码中的个体差异适应性问题的
研究工作进行了总结,并分析了所提方法的优势与局限性。随后,结合 SSVEP 信号处
理、自适应优化及迁移学习的发展趋势,探讨未来研究方向,以进一步提升方法的泛
化能力和实用性,为 SSVEP-BCI 系统的广泛应用提供更稳健的技术支持。


第二章 基础理论及数据来源
8
第二章 基础理论及数据来源
2.1 SSVEP 信号的产生
大脑的功能分区包括额叶、顶叶、枕叶和颞叶,各区域协同作用以实现复杂的认
知和感知功能。额叶主要负责高级认知,如语言生成、问题解决和运动控制,同时对
行为调节起关键作用。顶叶在空间认知、视觉处理和体感信息整合方面发挥重要作用。
枕叶则是视觉信息的核心处理区域,负责对视觉刺激的解析与反馈。而颞叶主要涉及
听觉处理、语言理解、情绪调控以及非视觉记忆的存储。
稳态视觉诱发电位的产生机制与枕叶的神经生理特性密切相关。其产生机制源于
视觉皮层神经元对特定频率刺激的同步振荡现象。当视觉系统接收到固定频率的闪烁
光或图案时,枕叶视觉皮层的神经元群会被同步激活,形成与刺激频率一致的周期性
电位波动。
2.2 SSVEP 信号的特点
SSVEP 信号具有稳定性强、信噪比高、个体差异明显以及受视觉注意力影响等特
点。由于 SSVEP 是由周期性视觉刺激诱发,其信号在相同实验条件下具有较高的重复
性和稳定性,适用于脑机接口等应用。同时,相较于运动想象等需要复杂认知训练的
脑电范式,SSVEP 信号具有天然的应用优势:被试无需特殊训练,只需保持正常视觉
功能与基础注意力即可诱发稳定响应。然而,不同个体的 SSVEP 响应强度存在差异,
可能受神经结构、生理状态和注意力因素的影响,这种个体差异可能影响 SSVEP-BCI
系统的性能。此外,尽管 SSVEP 可被无意注意触发,但主动关注某一特定频率的刺激
可以增强该频率的 SSVEP 响应,提高信号的可检测性。
2.3 SSVEP 脑电信号采集
2.3.1 电极放置
SSVEP 脑电信号的采集要求精准的电极放置,以便准确捕捉到大脑对视觉刺激的
响应。电极的放置位置直接影响到信号的质量和稳定性。通常,SSVEP 信号采集使用
国际 10-20 系统来进行电极放置(如图 2-1 所示)。为了确保捕捉到稳定的视觉诱发反
应,电极应当主要放置在视觉皮层区域,特别是位于枕叶的电极,如 O1、O2、Oz 等。
这些电极与视觉处理区域的信号活动相关,能够有效记录到与视觉刺激频率相对应的


第二章 基础理论及数据来源
9
脑电反应。此外,为了提高信号的质量,可能需要根据研究的具体目标,增加其他区
域的电极。为了减少电极接触不良引起的噪声和伪影,电极的连接和电导必须保持良
好,确保信号采集的稳定性。
图 2-1 10-20 系统脑电图放置法
2.3.2 实验设计
(1)刺激呈现
SSVEP 信号的诱发依赖于特定视觉刺激源对视觉通路的节律性激活。实验设计中,
视觉刺激源多采用光栅或棋盘格的周期性闪烁模式,其频率范围通常设定为 6-16 Hz。
为实现多指令编码,常采用频率间隔大于 0.2 Hz 的编码策略。此外通常使用高对比度
(如黑白交替)来增强 SSVEP 的响应幅度。
(2) 刺激持续时间和间隔
刺激的持续时间和间隔是影响 SSVEP 信号质量的重要因素。一般而言,刺激的呈
现时间应足够长(通常为 2-3 秒),以确保大脑对视觉刺激产生稳定且显著的神经反应。
为了避免相邻刺激之间的干扰,每次刺激后需设置适当的间隔时间,使大脑活动得以
恢复至基线水平。间隔时间可根据实验需求进行调整,通常为 1-2 秒,以优化信号质量
并减少潜在的累积效应。
(3) 参与者的任务要求
实验任务的设计应确保参与者始终聚焦于视觉刺激,从而有效增强 SSVEP 信号的


第二章 基础理论及数据来源
10
强度。常见的任务要求受试者监视并响应特定频率的刺激。
为确保实验的顺利进行,受试者需具备正常视力,无色盲、色弱等视觉障碍。此
外,为了避免因疲劳或注意力下降而影响实验结果,任务难度应适中,实验时长不宜
过长。每轮任务之间需安排适当的休息,以帮助受试者保持良好的状态,提高实验的
稳定性和可靠性。
(4) 试次和随机化
为了提高实验结果的可靠性,通常采用多次试验来确保 SSVEP 反应的稳定性。在
每个试次中,可对刺激的频率进行随机化,以减少顺序效应可能带来的偏差。此外,
实验设计应确保每种刺激条件下均包含足够的重复试次,以便通过信号平均提高信噪
比,从而获得更精准和稳健的 SSVEP 数据。
2.3.3 数据采集
在确保电极正确放置和实验设计合理的前提下,脑电信号的采集通常依赖于高性
能的 EEG 放大器。EEG 系统需具备足够高的采样率(通常为 500 Hz 或更高)以及较
低的噪声水平,以精准捕捉高频率的 SSVEP 信号,确保数据的质量和稳定性。
图 2-2 SSVEP-BCI 系统结构
2.4 数据预处理
2.4.1 伪影去除
EEG 信号容易受到多种生理及环境因素的干扰,因此需要采用适当的方法去除伪
影,以提高信号的信噪比。
(1)眼动伪影


第二章 基础理论及数据来源
11
眨眼和眼球运动会在前额及颞叶区域产生显著的低频干扰,影响 SSVEP 信号的稳
定性。常用的去伪影方法为独立成分分析,用于分离并去除眼动相关成分,或利用回
归分析减小眼动信号对 EEG 的影响。
(2)肌电伪影
面部及颞部肌肉活动可在高频范围引入噪声,从而影响 SSVEP 信号的检测。常用
的处理方法包括高频滤波以衰减肌电伪影,或直接剔除肌电活动较强的试次。
(3)工频噪声
电源辐射可能导致 EEG 信号中出现固定频率的噪声。通常使用带阻滤波(如 50
Hz 陷波滤波)去除工频干扰。
2.4.2 滤波处理
滤波是 EEG 数据预处理中不可或缺的步骤,通常采用低通滤波、高通滤波及带通
滤波等方法,以去除非目标频率成分,提高 SSVEP 信号的清晰度。
(1)低通滤波
用于去除高频噪声,包括肌电伪影及环境干扰。一般选取 100 Hz 以下的截止频率,
具体数值依据实验需求确定。
(2)高通滤波
主要用于去除 EEG 信号中的直流漂移及低频噪声,通常设置 0.5 Hz 至 1 Hz 的截
止频率,以保留有效的脑电活动信息。
(3)带通滤波
针对 SSVEP 信号的特性,通常采用 5-100 Hz 的带通滤波以去除非目标频率成分,
以最大限度保留目标信号,同时抑制低频和高频噪声。
2.5 数据来源
本研究主要基于清华大学的 Benchmark Dataset (http://bci.med.tsinghua.edu.cn/)[63]、
BETA Dataset(http://bci.med.tsinghua.edu.cn/)[64]和 CA Dataset (http://gigadb.org)[65]进行实
施。
2.5.1 Benchmark Dataset
该数据集收集了 35 名健康受试者的 SSVEP-BCI 记录。实验范式包括 40 类刺激目
标(对应 40 个字符),刺激频率范围为 8~15.8Hz,频率间隔为 0.2Hz。对于每个受试


第二章 基础理论及数据来源
12
者,实验由 6 个 block 组成,每个 block 包含 40 次试验,对应以随机顺序显示的 40 个
字符。每次试验持续 6s(其中,目标提示 0.5s,对应于一个拼写字符的固定频率刺激
5s,刺激后休息 0.5s)。EEG 数据由 64 通道 Synams2 系统获取,最初采样频率为 1000
Hz,随后降低采样频率至 250 Hz。更多信息可在文献[63]中找到。
2.5.2 BETA Dataset
该数据集收集了 70 名健康受试者的 SSVEP-BCI 记录,作为 Benchmark Dataset
的扩展,该数据集在刺激目标个数、刺激频率范围以及间隔和 Benchmark Dataset 保持
一致。需要注意的是 block 从原来的 6 个变为了 4 个,并且刺激时间也有所改变,对于
前 15 个人,每次试验持续 3s(其中,目标提示 0.5s,对应于一个拼写字符的固定频率
刺激 2s,刺激后休息 0.5s)。对于后 55 个人,每次试验持续 4s(其中,目标提示 0.5s,
对应于一个拼写字符的固定频率刺激 3s,刺激后休息 0.5s)。更多的信息可在[64]中找到。
2.5.3 CA Dataset
CA Dataset 中 所 涉 及 的 EEG 数 据 由 NEUROSCAN EEG 放 大 器 和 64 导 联
Neuroscan Quik-Cap EEG 帽获取。该数据集收集了 35 名健康受试者的 SSVEP-BCI 记录,
平均年龄 23.9 岁,包括 22 名男性和 13 名女性。实验范式包含 40 类双频刺激目标,在
数据采集过程中,刺激目标随机出现,并且每种刺激都被重复 5 次。每次试验持续 4s
(试验以 1 秒的提示期开始,在此期间,刺激目标以红色突出显示,使参与者能够集
中注意力,随后是 2 秒的刺激期,参与者仅专注于之前提示的目标,最后是 1 秒的休
息)。采集到的实验数据经过降采样处理,将采样率从 1000 Hz 降至 250 Hz,随后应用
梳状滤波器消除直流信号并减少中频干扰。更多信息可在文献[65]中找到。
基于上述数据集进行 SSVEP 解码时,采用的通道为 Pz,PO5,PO3,POz,PO4, PO6,
O1,Oz 和 O2[63]。考虑到 SSVEP 响应的视觉延迟[66],选择刺激开始后 140ms 的脑电信
号进行分析。
2.6 评价指标
在本研究中评价 SSVEP 识别效果主要通过识别正确率和 ITR 两个指标进行。正确
率代表的是通过本文方法判断正确的刺激数量占总刺激数量的百分比。
ITR 是 BCI 中最常用的性能评价指标[67]。ITR 是一个考虑准确性和数据长度的综合
指标。ITR 的定义如下:


第二章 基础理论及数据来源
13
22 2
1- p 60
ITR(bits / min)= (log N + plog p +(1 - p)log )
N - 1 T (2-1)
式中,N 为刺激频率的个数,P 为平均识别精度,T 为识别所用的平均数据长度
(秒)。
2.7 本章小结
本章主要对 SSVEP 产生原理、信号特点、脑电信号采集实验过程、数据预处理方
法、所使用数据集以及评价指标进行了详细阐述。首先,总结了 SSVEP 产生的原理和
相关理论;继而,分析了 SSVEP 脑电信号的特点;随后,归纳了 SSVEP 脑电信号采
集实验的常用过程和方法;接着,详细阐述了常用的数据预处理方法;然后介绍了本
研究所使用的数据集;最后介绍了评价指标。


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
14
第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
3.1 引言
由于个体间脑部神经活动存在显著差异,采用统一设定的数据长度进行 SSVEP 信
号解码难以兼顾所有被试的脑电响应特征。即使在同一被试的不同实验中,受注意力
状态或身体状况等因素影响,固定的数据长度可能无法持续保证解码性能。近年来,
自适应方法的提出为 SSVEP 信号识别与分析提供了新的思路,其核心在于根据脑电数
据的自身特性或识别性能指标,动态调整用于解码的数据长度[33, 54, 55, 57]。虽然这些方
法都取得了一定解码的效果,却未能有效平衡正确率与 ITR 之间的关系(正确率虽然
比较高,但是 ITR 较低)。
为了解决这一问题,本研究提出了基于改进 TRCA 的数据长度适配方法,创新性
地构建自适应机制,通过协方差分析量化不同数据长度下特征的分类性能,建立数据
长度-分类性能映射模型。通过在 TRCA 的特征提取阶段中引入与协方差分析更匹配的
典型相关分析,实现特征提取过程与最优数据长度的协同优化,从而达成正确率和信
息传输速率双高的目标。
3.2 方法
图 3-1 为本文方法的实现流程(图中显示的输入数据为 Benchmark 数据集一个被
试的 240 次试验(40 个 trial 重复 6 次))。其详细步骤如下:
步骤 1:对输入数据划分训练集和测试集。每次迭代将所有刺激的任意一次 Trial
数据作为测试集(数据维度为 40*9*1,40 为刺激类别,9 为通道数,1 为 Trial 数),其
他数据作为训练集(数据维度为 40*9*5,40 为刺激类别,9 为通道数,5 为 Trial 数)。
因此,总共迭代 6 次,保证所有的 Trial 都被分且仅被分为测试集一次。
步骤 2:数据长度设置和数据截取。假如信号开始时间记为 T0 ,则 EEG 信号在时间
Tn 时的数据长度为 0 ( 1, 2, ..., 57)
Tn T n  。在截取测试集和训练集时,就需选择Tn T0
长度的信号。在本研究中,为了保证训练权重的最短数据长度,初始数据长度设置为
0.2s,也就是截取数据长度的初始时间 T1 为 0.2s;最大数据长度设置为 3s (若最大数据
长度设置过大,即便分类结果正确,ITR 也会很低)。
步骤 3:频带分解。将测试集中的所有刺激类别分别通过带通滤波器组[30]分解为 5
个子频带成分(数据维度为 1*9*5*1,第一个 1 为刺激类别,9 为通道数,5 为子频带数,


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
15
图 3-1 本章方法实现流程(图中以 Benchmark 数据集举例)
最后的 1 为试验次数)。同样,将训练集信号通过带通滤波器组分解为 5 个子频带成分
并按照刺激类别分开(数据维度为 40*9*5*5,40 为刺激类别,9 为通道数,第 1 个 5 为
子频带数,最后的 5 为试验次数)。分解的五个频带的范围分别为 8-88Hz、16-88Hz、
24-88Hz、32-88Hz、40-88Hz[30]。在实现带通滤波时,每个子带的通带两侧增加了 2 Hz
的额外带宽,例如第一个子带的通带设置为 6-90Hz。
步骤 4:计算不同频带的权重。针对相同的子频带信号,将训练集同一刺激类别的
5 次 trial 信号按照试验间协方差最大化原理进行分析,从而求出每类刺激的不同频带权
重 ij
W (i 为刺激类别, i  1, 2, ..., 40 ,j 为子频带类别, j  1, 2, ..., 5 )。权重 ij
W 的详细
计算步骤如下:
假设某一刺激第 h 次试验的 EEG 信号为 ( ) , 1, 2, ...,
cs
NN
h t
Rh N

X   。Nc,Ns,Nt
分别为通道数,采样点数和 Trial 数,则第 h 次试验的线性组合记为公式(3-1)。
(h) T (h)
y  w X (3-1)
TRCA 的目标是优化权重向量 R Nc1
w  使得 1 2 ( )
() ( )
, ,... , Nh
hh
y y y ( N h 为 Trial 数)


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
16
间表现出最大的相似性。该权重向量是通过最大化所有组合之间的协方差之和得到的。
这些所有协方差组合的总和为公式(3-2)所示。
12
() ( )
t tc 12 12 1 2 12 12 12 12 12
N NN h h (h ) (h ) jj j j h ,h =1 h ,h =1 j , j =1 hh hh
Cov y y = w w Cov(X , X )

 
( ,)
T
= w Sw (3-2)
这里 1
1
(h ) j
X, 2
2
(h ) j
X 分 别 表 示 (h1)
X 的 第 j1 通 道 信 号 和 (h2 )
X 的 第 j2 通 道 ,
(, )
12 12
(h ) (h ) jj
Cov X X 表示计算两者之间的协方差。其中 1 2 1 2
( ,1 , )
jj c
S  S  j j  N 被定义为:
12
t
12 12 12 12
N
(h ) (h ) jj j j h ,h =1 hh
S Cov(X , X )

  (3-3)
定义 ( )
(1) ( 2)
[ ... Nt ]

X  X X X 是所有试验的合并矩阵。为了得到 w 的有限解,约
束条件是 T 
y  w X 的方差归一化为 1。
12
() 1
c
12 12
N T
jj
jj j , j =1
Var y w w Cov( X , X )

 
 w Qw (3-4)
j1
X

和
j2
X

分别表示

X 的第 j1 和第 j2 个通道的信号。
那么受约束的优化结果为:
ˆ
T
T
()
= argmax ( )
w
w Sw
w w Qw (3-5)
最佳权重向量 wˆ 是矩阵 -1
Q S 最大特征值对应的特征向量。所求出来的 wˆ 即为这个
刺激某个频带的 ij
W ,将所有刺激的所有频带的 ij
W 组合为权重矩阵 W(数据维度为 40*5*9,
40 为刺激类别,5 为频带数,9 为通道数)。
步骤 5:对训练集分解的子频带信号求平均。将步骤 3 中得到的训练集相同类刺激
的 5 次 Trial 按照相同的子频带求平均,称之为训练集平均信号(数据维度为 40*9*5,
40 为刺激类别,9 为通道数,5 为频带数)。
步骤 6:子频带信号通道加权求和并求出相关系数矩阵。使用权重矩阵 W 对训练
集平均信号和测试集信号进行通道加权求和(例如, ij 23
W  W 时,使用 23
W 对测试信号的
第三个频带进行通道加权求和,对训练集平均信号的第 2 类刺激的第 3 个频带进行通
道加权求和),并使用典型相关分析求出两者的相关系数。所有的相关系数构成相关系
数矩阵(矩阵维度为 40*5,40 为刺激类别数,5 为子频带数)
步骤 7:求解加权矩阵。按照设置好的参数[30]对相关系数矩阵的子频带数维度加
权求和得到加权矩阵(矩阵维度为 40*1,40 为刺激类别数)。
步骤 8:求解归一化矩阵。对加权矩阵使用 softmax 函数进行归一化处理得到归一
化矩阵。其公式为:


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
17
i i i 40
n n=1
exp(a )
C = softmax(a )=
exp(a )
 (3-6)
其中, ai (i=1,2,...,40)为某个刺激类别的相关系数, Ci 为 ai 归一化后的结果。
此时归一化矩阵维度为 40*1,40 为刺激类别数(其中的相关系数称为 Ci,i=1,
2,...,40)。
步骤 9:协方差分析。将不同的数据长度Tn 作为自变量,与刺激类别对应的相关系
数作为因变量,不同的刺激类别作为不同的分组进行协方差分析。在这里协方差分析
是基于 matlab 中的 AOCTOOL 工具箱。
步骤 10:判断交互项作用是否显著。如果交互项作用不显著,则Tn 增加一个步长
0.05s,并判断Tn 是否大于 3s,如果是则输出结果(Tn 时最大相关系数对应的刺激类别),
否则回到步骤 2,按照Tn 截取新数据长度的数据; 如果交互项作用是显著的,那就意味
着每个组的斜率存在显著差异(p<0.05),则使用多重比较(matlab 中的 multcompare 函
数)判断斜率最大的那条回归线的斜率是否显著(p<0.05)大于其它刺激类别回归线的斜
率。如果是则输出结果( Tn 时最大相关系数对应的刺激类别),此时Tn 即为这个试验的
最佳判别时间,否则Tn 增加一个步长 0.05s,并判断Tn 是否大于 3s(如果是则输出结果,
即Tn 时最大相关系数对应的刺激类别;否则回到步骤 2 截取新数据长度的数据)。
3.3 结果与分析
3.3.1 实验设置
由于 BETA 数据集的特殊性(前 15 个被试的刺激时长为 2s,小于 3.2 节设定的最
大数据长度 3s),因此使用 BETA 数据集时,只使用了后 55 名被试的数据,即 S16-S70。
本文方法根据 TRCA 在求取特征时(即相关系数)所采用的策略,分为两种变体:
第一种为未在 TRCA 特征提取阶段引入 CCA 分析的数据长度适配方法,即基于传统
TRCA 的数据长度适配方法(AncTRCA);第二种为在 TRCA 特征提取阶段引入 CCA
分析的数据长度适配方法,即基于改进 TRCA 的数据长度适配方法(AncTRCA-CCA)。
3.3.2 初始数据长度设置的影响
图 3-2 展示了基于 AncTRCA-CCA 在 Benchmark 数据集上不同初始数据长度下所
获得的结果。从图中可以看出,不同的初始数据长度完全会影响 SSVEP 的识别结果。
正如所看到的,从正确率来看,没有发现两个不同初始数据长度造成的差异,但是


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
18
0.2s 所获得的适应被试解码的数据长度明显变小、信息传输速率明显提高。因此,后
续的研究均基于 0.2s 的初始数据长度进行。
图 3-2 基于 Benchmark 数据集不同初始数据长度对本文方法的影响
3.3.3 基于改进 TRCA 数据长度适配方法的回归结果
图 3-3 基于 Benchmark 数据集的回归线斜率比较
图 3-3 所示为 Benchmark 数据集任意选择一次试验(数据长度为 3s)的协方差分
析结果,在图中所描述的 SSVEP 信号的正确标签应该为 1。从图 3 中可以看出,这次
试验中刺激 1 对应的归一化后相关系数的回归线斜率最大,可以初步判断这次的分类


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
19
结果为 1。接着通过多重比较发现,第 1 组和另外 39 个组的斜率明显不同,且均大于
另外 39 个组的斜率,确定此次输出的结果为 1,与正确标签对应。
3.3.4 AncTRCA 与 AncTRCA-CCA 的对比
图 3-4 基于 Benchmark 数据集获得的数据长度。(a) AncTRCA; (b) AncTRCA-CCA
图 3-4,图 3-5 分别展示了基于 Benchmark 数据集(图 3-4)和基于 BETA 数据集
(图 3-5)部分被试在 AncTRCA 和 AncTRCA-CCA 上获得的适合被试解码的数据长度。
从两图中可以看出来,两种方法获得的数据长度随受试者变动的曲线在整体趋势上是
一样的(例如,图 3-4 中被试 3 在(a)中的数据长度最小,同样在(b)中也是最小,最大的
被试情况也是如此)。不同之处在于,AncTRCA-CCA 获得的适合被试解码的数据长度
明显比 AncTRCA 更小(例如图 3-5 蓝线所示)。
图 3-5 基于 BETA 数据集部分被试获得的数据长度。(a) AncTRCA;(b) AncTRCA-CCA


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
20
图 3-6 基于 Benchmark 数据集在不同方法下获得的正确率及信息传输速率。(a) AncTRCA 获得
的正确率;(b) AncTRCA-CCA 获得的正确率;(c) AncTRCA 获得的信息传输速率;(d) AncTRCA
CCA 获得的信息传输速率
图 3-6 展示了基于 Benchmark 数据集在 AncTRCA 和 AncTRCA-CCA 上获得的正
确率和信息传输速率的结果。从正确率来看,虽然所有个体的平均正确率相差不大,
但对于不同个体,两种方法的识别正确率却不完全相同。从信息传输速率来看, 两种
方法获得的信息传输速率随着受试者变动的曲线在整体趋势是一样的。例如,被试 3
的信息传输速率在(c)中是最高的,在(d)中也最高;被试 19 的信息传输速率在(c)中是
最低的,在(d)中也最低。然而,与 AncTRCA 相比,AncTRCA-CCA 所获得的平均信
息传输速率明显更高。此外,在 BETA 数据集上情况也如此(图 3-7)。
图 3-7 基于 BETA 数据集部分被试在不同方法下获得的正确率及信息传输速率。(a) AncTRCA


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
21
获得的正确率;(b) AncTRCA-CCA 获得的正确率;(c) AncTRCA 获得的信息传输速率;(d)
AncTRCA-CCA 获得的信息传输速率
图 3-8 基于 Benchmark 数据集在 AncTRCA 和 AncTRCA-CCA 上的统计对比结果
图 3-8 显示,在 Benchmark 数据集上,虽然 AncTRCA 与 AncTRCA-CCA 在正确
率上无显著性差异,但 AncTRCA-CCA 所获得的适合被试解码的数据长度显著性更小,
信息传输速率显著性更高。在 BETA 数据集上也是如此(图 3-9)。
图 3-9 基于 BETA 数据集在 AncTRCA 和 AncTRCA-CCA 上的统计对比结果


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
22
3.3.5 不同方法的性能对比
表 1-1 和表 1-2 分别展示了不同方法在 Benchmark 数据集和 BETA 数据集上的性能
表现。其中,CCA 和 TRCA 为预设数据长度方法,而 AncTRCA 和 AncTRCA-CCA 属
于数据长度适配方法。从 Benchmark 数据集的结果来看,在数据长度适配方法中,
AncTRCA 在识别正确率上优于预设数据长度下的 TRCA 和 CCA,但其信息传输速率
远低于预设数据长度下的 TRCA。因此,相较于预设数据长度方法,并非所有数据长
度适配方法都能在保证较高识别准确率的同时实现较快的信息传输速率。然而,
AncTRCA-CCA 与预设数据长度下的 TRCA 相比,不仅在识别正确率上保持领先,还
取得了最高的信息传输速率。此外,在 BETA 数据集上的实验结果亦呈现出相同趋势,
进一步验证了 AncTRCA-CCA 的泛化能力。
表 1-1 基于 Benchmark 数据集上多种方法的结果对比
方法 正确率 信息传输速率(比特/分钟) 数据长度(秒)
CCA 66.48%(±22.96) 86.25(±40.86) 1.47
TRCA 94.27%(±11.32) 146.34(±26.22) 1.47
AncTRCA 97.36%(±3.08) 133.80(±28.87) 1.84(±0.44)
AncTRCA-CCA 97.04%(±3.01) 161.48(±43.94) 1.47(±0.48)
注:粗体表示最佳结果。
表 1-2 基于 BETA 数据集上多种方法的结果对比
方法 正确率 信息传输速率(比特/分钟) 数据长度(秒)
CCA 66.91%(±26.42) 71.19(±39.18) 1.95
TRCA 72.53% (±21.17) 78.89(±35.18) 1.95
AncTRCA 77.93%(±18.36) 75.02(±49.29) 2.21(±0.26)
AncTRCA-CCA 77.21%(±19.13) 81.73(±61.94) 1.95(±0.32)
注:粗体表示最佳结果。
3.4 本章小结
传统 SSVEP 识别系统普遍采用预设长度的(通常为 0.5-1 秒)的脑电信号片段进
行解码,这种策略忽视了不同被试的神经响应速度差异。针对这一问题,本文创新性
地提出一种基于改进 TRCA 的数据长度适配方法。该算法借助协方差分析实现对数据
长度的自适应调整,从而更好地适配不同被试的脑电信号特性。通过在 TRCA 的特征
提取阶段中引入与协方差分析更匹配的典型相关分析,实现特征提取过程与最优数据
长度的协同优化。该方法在 Benchmark 数据集和 BETA 数据集上的解码正确率分别为
97.04%和 77.21%,与传统的 TRCA 方法相比分别提升了 2.77%和 4.68%。实验结果显


第三章 基于改进 TRCA 数据长度适配的 SSVEP 解码方法
23
示,该方法有效解决了预设数据长度方法在面对个体响应差异时导致解码性能下降的
问题,有效提升 SSVEP 解码的准确率。


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
24
第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
4.1 引言
在第三章中,我们针对个体间神经响应速度的差异,提出了基于改进 TRCA 的数
据长度适配方法,实现了数据长度的自适应调节,从而在准确率与 ITR 之间取得了更
优的平衡。在该方法中,滤波器组技术作为特征提取的重要组成部分,已初步展现出
其在提升解码性能方面的潜力。
滤波器组的设计通常依赖三个关键参数:(1)融合各子频带特征的权重;(2)子
频带的数量;(3)子频带的上截至频率。目前多数基于滤波器组的 SSVEP 识别方法大
多采用预设的滤波器组参数,即融合权重设置为 1.25、0.25,子频带数为 5,上截至频
率为 90Hz。Wang[58],Nan[68],Zhang[59] 等研究均采用了这一预设参数。尽管该参数设
置在部分被试中能够提升识别性能,但由于脑电信号存在明显的个体差异,预设参数
在不同个体间的泛化能力有限,鲁棒性较差。
基于此,本章我们聚焦于滤波器组参数的个体化适配问题。本研究将群体智能优
化算法引入 SSVEP 的信号识别中,构建 SSA-TRCA 双阶段优化模型。该模型通过群体
智能优化算法在个体层面动态调整滤波器组的关键参数,从而弥补预设参数方案在面
对个体差异时的性能不足,增强系统的适应性与准确性。
4.2 方法
滤波器组技术包含了带通滤波、频带分解及频带融合等操作,能将 SSVEP 数据分
解为多个子频带成分,有效地提取嵌入在谐波成分中的独立信息[69]。这种方法能够提
高目标信号的信噪比,从而增强分类或识别的准确性。此外,不同子频带的信息可以
通过加权融合的方式优化特征提取,提高系统的鲁棒性。
通常使用滤波器组技术的过程为:首先使用带通滤波将原始信号分为多个子频带,
然后使用特征提取方法进行特征提取,最后将不同子频带的特征进行融合。若用 Nm、
V 和 分别表示子频带个数、上截止频率、子频带权重融合。根据研究结果,SSVEP
谐波的信噪比会随着响应频率的增加而降低,因此权重δ被定义为:
()
()
()
1
2
...
a
a
a m
b
N












(4-1)


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
25
其中,a 和 b 是两个常量参数。在前人的研究中[58, 64, 65],基于相同的数据集
Benchmark 、 CA 、 BETA, 通 常 使 用 的 预 设 参 数 分 别 为 Nm=5 、 V=90Hz 、 a=1.25、
b=0.25。
图 4-1 本章方法详细流程
本章详细流程如图 4-1 所示,其具体步骤如下:
步骤 1:初始化麻雀种群参数并划分类别。初始化麻雀的个数及每只麻雀的参数,
其中 n 表示麻雀数量。在本章中麻雀数量设为 30,每只麻雀(每行)对应的参数(a、b、
Nm 和 V)在各自范围内随机取一个值。其中各个参数的范围为:a∈[0-1.5]、b∈[0-0.5]、
子频带个数 Nm∈[2-8]和上截止频率 V∈[72Hz,80Hz,88Hz](在实现带通滤波时,每个
子频带的上截止频率增加了 2 Hz 的额外带宽,即 V∈[74Hz,82Hz,90Hz],在下文的
描述中均使用增加带宽之后的上截止频率)。将初始化后的麻雀划分为 3 类(70%为发
现者,30%为追随者,整个种群中随机 20%为警戒者)。
步骤 2:子频带分解及确定子频带的下截止频率。按照对应麻雀的滤波器组参数将
数据分解为 Nm 个子频带,第 m 个子频带的下截止频率设定为 m*8-2Hz(下截止频率通
常由数据集的刺激范围直接决定,例如,在 Benchmark 中的刺激范围为 8-15.8Hz,则
第 1 个子频带下截止频率为 1*8Hz,在实现带通滤波时,每个子频带的下截止频率需
增加 2 Hz 的额外带宽,故第 1 个子频带的下截止频率最终设置为 6Hz)。上截止频率为
对应麻雀的 V 值。
步骤 3:特征提取。利用 TRCA 算法提取各个子频带的特征。具体过程如下:
空间滤波器,即最佳权重向量 wˆ 的训练过程在 3.2 节中已经详细介绍,故不再赘
述。
在基于 TRCA 的频率识别方法中,空间滤波器可以使用所有训练 Trial 通过公式(3-5)
计算得出,对于训练数据 t
××
cs
NNN
nR

X  ,我们可以得到 Nf 个空间滤波器,


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
26
×1, 1, 2, ...,
Nc nf
w  R n  N , N f 为刺激频率的数量。对于测试数据 Nc×Ns
X  R 和模板信
号 × ( 1, ..., )
cs
NN nf
Y  R n  N (训练数据按 Nt 维度取平均),我们可以利用公式(4-2)计
算 X 和每一个模板信号之间的相关系数。
( , ), 1,2,...,
TT n n nn f
   w X w Y n  N (4-2)
这里 (,) 表示两个一维信号之间的相关分析计算,在本章中我们使用皮尔逊相关
分析。n 即为所求特征。
步骤 4:特征融合。按照对应麻雀的子频带融合权重将子频带的特征进行融合。
步骤 5:计算正确率及适应度值。将融合之后的特征进行分类得到每只麻雀的正确
率 P 及适应度值 1-P。
步骤 6:更新麻雀种群的参数值。不同类别的麻雀按照不同的公式进行参数更新。
具体过程如下:
发现者参数更新:
,2
1
max
,
,2
( ),
,
t ij
t ij
t
ij j
i
x exp R ST
iter
x
x Q L R ST


  

    

(4-3)
其中 xij 表示第 i 个麻雀在第 j 列中的值, i  1, 2, ..., n; j  1, 2, ..., 4; t 代表当前迭
代次数,itermax 为常数,表示最大迭代次数,在本研究中最大迭代次数为 100。α是[0,1]
之间的随机数。 R2 是[0,1]之间的随机数,表示预警值,ST 表示安全值,为 0.6。Q 是
[0,1] 之间服从正太分布的随机数,L 表示 1*4 的矩阵,其中矩阵内每个元素全部为 1,
Lj 表示 L 第 j 列的值。
追随者参数更新:
,, 2 11
2 ,
,,
( ),2
| | , otherwise
tt worst j i j t ij t tt best j i j best j j j
xx n
Q exp i n
xi
x x x AL



 
     

,
(4-4)
其中 xij 表示第 i 个麻雀在第 j 列中的值; ,
t
best j
x和,
t
worst j
x 分别表示在第 t 次迭代中最
佳组合参数(对应适应度值最小麻雀的参数)和最差组合参数(对应适应度值最大麻
雀的参数)中第 j 列的值;Q 是(0,1)之间服从正太分布的随机数; A 为 1*4 的随机矩
阵,且其中元素仅为 1 或-1,并且 1
()
TT
A A AA

 , Aj 表示 A 第 j 行的值;L 表示 1*4
的矩阵,其中矩阵内每个元素全部为 1, Lj 表示 L 第 j 列的值; n1 表示发现者的数量,
n2 表示追随者的数量。如果 A − A1 > A2
2 ,则当前滤波器组参数对研究对象不适合,
追随者将离开当前位置,否则,追随者将接近对应于最佳滤波器组参数的发现者。


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
27
警戒者参数更新:
,, 1
, ,, ,
( ),
( ),
||
t tt best j i j best j i g
t tt i j i j worst j
t
ij i g iw
x x x ff
x xx
x K ff
ff



   
 
  
 

,
(4-5)
其中 xij 表示第 i 个麻雀在第 j 列中的值; ,
t
best j
x和,
t
worst j
x 分别表示在第 t 次迭代中最
佳组合参数(对应适应度值最小麻雀的参数)和最差组合参数(对应适应度值最大麻
雀的参数)中第 j 列的值;变量是(0,1)之间服从正态分布的随机数,K 是(−1,1)
范围内均匀分布的随机数, 是防止分母变为零的最小值。 fi 、 fg 和 fw 分别是当前麻
雀的适应度值、当前全局最小适应度值和最大适应度值。
步骤 7:判断是否达到迭代停止条件。在本研究中,迭代次数为 100 次,如果没有
达到迭代次数,则返回第二步。否则输出参数 100
best
x (第 100 次迭代中麻雀种群中的适应
度值最小对应的参数)。
最后基于优化后的参数组合,采用 TRCA 算法完成分类。
4.3 结果与分析
在实施过程中,本章研究根据不同数据集特性进行了交叉验证在 Benchmark 上进
行 6 折交叉验证(因为每个刺激重复 6 次),在 CA 数据集上进行 5 折交叉验证(因为
每个刺激重复 5 次),在 BETA 数据集上进行 4 折交叉验证(因为每个刺激重复 4 次)。
4.3.1 不同数据长度对 SSVEP 解码性能的影响
(1)Benchmark


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
28
图 4-2 在 Benchmark 数据集上不同方法对比
从图 4-2 可以看出,随着数据长度的增加,所有方法的正确率均呈上升趋势,但提
升幅度有所不同。其中,本文方法和 TRCA 方法的正确率始终保持较高水平,且随着
数据长度的增加逐渐收敛,而 FBCCA 和 CCA 的正确率相对较低,但随着数据长度的
增加,其提升幅度更为显著。信息传输速率方面,CCA 和 FBCCA 方法随着数据长度
的增加稳步上升,而 TRCA 和本文方法则呈现先上升后下降的趋势。这表明,在较短
数据长度时,增加数据量有助于提升信息传输速率,但当数据长度超过一定范围后,
信息传输速率可能会受到影响。总体来看,本文方法在所有数据长度下均表现出最高
的正确率和信息传输速率,验证了其优越性。
(2)CA
图 4-3 在 CA 数据集上不同方法对比
由于 CA 数据集是基于双频刺激采集而来,所以 CCA、FBCCA 等方法无法使用,
因此对于 CA 数据集,本文方法无法与 CCA 和 FBCCA 进行对比。
从 图 4-3 可 以 看 出 , 随 着 数 据 长 度 的 增 加 , 本 研 究 所 获 得 的 正 确 率 趋 势 与
Benchmark 数据集(图 4-2(a))相同(随着数据长度的增加而增加)。但是信息传输
速率的趋势却截然不同。在 CA 数据集上,随着数据长度的增加,信息传输速率越来
越低(这属于数据集的特性,不在此过多讨论)。最重要的是,无论数据长度如何,本
文方法的正确率和信息传输速率依旧是最优的。


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
29
(3) BETA
为了验证本章方法在小样本数据集的有效性,我们在 BETA 数据集上进行了相同
的实验。
图 4-4 在 BETA 数据集上不同方法对比
根据图 4-4 的实验结果可见,随着数据长度从 0.5 秒扩展至 1 秒,两种算法的分类
正确率均表现出显著的时间依赖性提升。值得注意的是,在 BETA 数据集(图 4-4)中,
TRCA 方法在全部数据长度的正确率与信息传输速率均表现出微弱但稳定的优势。然
而,在 Benchmark(图 4-2)和 CA(图 4-3)数据集上,本章方法的性能显著优于
TRCA 方法。这一现象可能与数据集的规模特性相关:BETA 数据集的单刺激重复次数
最少(4 次/刺激),而 Benchmark(6 次/刺激)和 CA(5 次/刺激)具有更高的训练样
本密度。本文方法基于参数优化的设计范式对训练数据规模具有强依赖性,如表 4-1 所
示,当训练数据量最大时(Benchmark),本章方法相对 TRCA 的平均正确率差值达到
最大;而随着数据量缩减,该差值显著缩小甚至反转。这表明,本章方法在充分训练
条件下具有更强的特征表征能力,但在小样本场景中可能因参数过拟合而导致泛化性
能受限。
表 4-1 本文方法和 TRCA 方法在不同数据集上平均正确率的差值(本文方法减去 TRCA)
数据集 数据长度(s)
0.6 0.7 0.8 0.9 1.0
Benchmark 2.31% 1.75% 2.11% 1.52% 1.44%
CA 1.84% 1.52% 1.58% 1.17% 1.41%
BETA -0.19% -0.80% -0.94% -0.2411% -0.57%


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
30
由于 SSVEP 数据的特性(数据长度越大,则正确率越高),下面所有结果均基于
数据长度为 1s 情况下进行描述。此外由于小样本数据对本文方法的限制,因此下面结
果将在 Benchmark 和 CA 数据集上进行。
4.3.2 不同滤波器组参数对 SSVEP 解码性能的影响
图 4-5 不同参数对正确率的影响
从图 4-5(平均结果来自所有受试者,数据长度为 1 秒)可以得知,三类(4 个)
参数中的任何一种对结果都有影响(例如,子频带数量为 4 的正确率远高于子频带数
量为 10);而且,不同的参数对结果的影响不同,例如在 Benchmark 数据集上,正确
率随着 a 值的增加而提高,随着上截止频率的增加而降低,但却随着子频带数量的增
加先升后降。此外,同一类参数对不同数据集产生的影响不同。例如,在 Benchmark
数据集上(图 4-5(a)),随着上截止频率的增加,正确率不断降低,而在 CA 数据集
上(图 4-5(b))随着上截止频率的增加,正确率先升后降。并且对于两个数据集而言,
在 本 文 参 数 可 选 择 的 范 围 内 , 子 频 带 数 量 对 应 正 确 率 的 波 动 ( Benchmark : 83.68%
90.30%、CA:75.17%-80.20%)和子频带融合权重对应正确率的波动(Benchmark:
85.95%-90.39% 、 CA: 77.43%-80.37% )相 对较 大, 而上 截止 频率 引起 的波 动 较 小
(Benchmark:89.79%-90.33%、CA:79.89%-80.23%)。


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
31
4.3.3 不同滤波器组参数组合对 SSVEP 解码性能的影响
在本小节中采用网格搜索法时,对每一被试的 a、b、V 和 Nm 四个参数分别进行搜
索,目的是获得:1)固定 a=1.25、b=0.25、Nm=5 时对应着最高正确率的上截止频率;
2)固定 a=1.25、b=0.25、V=90Hz 时对应着最高正确率的子频带个数;3)固定子频带
个数为 5、V=90Hz 时对应着最高正确率的 a 和 b 值。
图 4-6 网格搜索和本文方法获得的参数情况
从图 4-6 可以看出,不同个体所得参数的差异性巨大,例如,在 Benchmark 中,
使用网格搜索时,被试 1 获得的参数 a 为 0.16,但被试 10 参数 a 却高达 1.46。而且参
数 b,子频带数量,上截止频率上的情况也是如此。而且,对同一被试,并未发现 4 个
参数之间有同时变动的趋势。例如在 Benchmark 数据上,采用本文方法,被试 17 的 a
值最高,但 b 值、子频道数量和上截止频率不一定高;在 CA 上也如此。此外,使用网
格搜索获得的参数值和本文方法获得的参数值差异较大。例如,在 CA 上,采用两种
方法获得的每个被试最佳 a 值都不相同。
从表 4-2(Benchmark)和表 4-3(CA)中可以看出,本文方法获得的参数优化组
合能获得与网格搜索最优参数值的组合类似好的结果(见均值结果),而且对某些被试
来说,本文方法还更好,例如无论在 Benchmark 还是 CA 上被试 1 使用网格搜索的正
确率均低于本文方法的正确率。与网格搜索不同的是,本文方法可以使用被试的部分
数据来寻找适合被试的参数组合,而网格搜索却需要被试的所有数据,当被试数据量
足够大时,本文方法依旧可以使用被试的部分数据来寻找适合被试的参数组合,其效


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
32
率将远高于网格搜索。
表 4-2 基于 Benchmark 数据集在数据长度为 1s 时所获得的参数情况及性能对比 网格搜索获得的参数组合 本文方法获得的参数组合
被试
序号
子频带
权重
ab
频带个
数
上截至
频率
(Hz)
正确率
(%)
子频带
权重
ab
频带
个数
上截至
频率
(Hz)
正确率(%)
S1 0.16 0.00 8 74 96.25 ± 1.07 0.61 0.07 5 82 99.17 ± 0.53
S2 0.03 0.00 6 82 97.08 ± 1.00 1.04 0.12 6 90 97.92 ± 0.42
S3 0.00 0.00 8 74 98.33 ± 0.83 0.06 0.23 8 90 99.17 ± 0.83
S4 0.00 0.00 5 74 97.92 ± 0.42 0.70 0.36 4 82 98.33 ± 0.53
S5 0.84 0.00 4 74 99.58 ± 0.42 1.02 0.31 2 82 99.58 ± 0.42
S6 0.09 0.00 4 82 94.17 ± 1.79 0.00 0.50 3 82 95.83 ± 1.24
S7 0.74 0.00 3 82 95.83 ± 1.05 0.50 0.09 3 90 95.83 ± 1.05
S8 0.48 0.00 6 74 93.33 ± 1.79 0.49 0.24 3 90 92.92 ± 1.00
S9 0.47 0.00 3 74 89.17 ± 1.05 0.00 0.00 3 90 90.00 ± 1.29
S10 1.46 0.00 3 82 95.00 ± 1.71 1.50 0.00 5 74 93.75 ± 1.55
S11 1.32 0.00 2 90 54.17 ± 2.79 1.31 0.00 3 74 54.58 ± 2.77
S12 1.36 0.00 2 90 98.75 ± 0.85 0.84 0.28 2 74 99.17 ± 0.83
S13 0.46 0.00 4 74 98.33 ± 0.83 1.34 0.10 5 74 97.92 ± 0.77
S14 0.28 0.00 2 74 98.75 ± 0.56 0.16 0.02 3 82 98.75 ± 0.56
S15 0.96 0.21 5 90 81.25 ± 3.15 1.50 0.36 4 74 77.08 ± 2.36
S16 0.98 0.00 3 74 87.50 ± 1.83 0.53 0.34 3 74 87.50 ± 2.58
S17 1.26 0.00 4 74 93.33 ± 1.90 1.50 0.14 2 74 92.50 ± 2.14
S18 0.65 0.00 4 90 91.25 ± 2.12 0.52 0.50 3 82 89.17 ± 2.47
S19 1.39 0.01 6 74 38.75 ± 3.34 1.38 0.28 8 82 35.00 ± 3.10
S20 0.69 0.02 3 74 96.25 ± 1.55 0.88 0.18 4 90 96.67 ± 1.24
S21 1.27 0.00 3 74 95.00 ± 1.12 1.21 0.03 3 74 95.00 ± 1.12
S22 0.00 0.00 6 74 98.75 ± 0.56 0.20 0.20 5 74 99.58 ± 0.42
S23 0.74 0.00 4 74 94.17 ± 2.30 0.88 0.05 5 74 95.00 ± 1.83
S24 0.26 0.00 3 74 98.33 ± 0.83 1.28 0.26 6 74 98.75 ± 0.56
S25 1.28 0.00 2 82 97.50 ± 0.65 0.93 0.25 3 82 97.50 ± 0.65
S26 1.33 0.00 2 82 100.0 ± 0.00 0.68 0.46 2 82 99.58 ± 0.42
S27 0.25 0.00 3 74 99.17 ± 0.53 0.82 0.31 5 82 99.58 ± 0.42
S28 0.00 0.00 4 74 100.0 ± 0.00 0.05 0.33 7 82 100.00 ± 0.00
S29 0.68 0.00 7 82 80.00 ± 1.29 1.18 0.47 4 90 80.00 ± 2.33
S30 1.00 0.00 3 90 92.50 ± 1.71 0.08 0.00 2 74 91.67 ± 2.11
S31 1.08 0.00 2 74 99.58 ± 0.42 0.74 0.37 6 90 99.58 ± 0.42
S32 0.07 0.00 3 74 100.0 ± 0.00 0.60 0.16 3 82 100.00 ± 0.00
S33 1.38 0.00 2 74 47.92 ± 4.35 0.00 0.27 2 82 53.33 ± 4.94
S34 1.32 0.00 4 74 98.75 ± 0.56 1.50 0.09 5 90 98.75 ± 0.56
S35 1.20 0.00 2 90 93.75 ± 1.41 1.18 0.20 3 74 93.75 ± 1.41
平均 - - - - 91.15 ± 2.49 - - - - 91.27 ± 2.50
表 4-3 CA 数据集在数据长度为 1s 时所获得的参数情况及性能对比 网格搜索获得的参数组合 本文方法获得的参数组合
被试 子频带 频带 上截至 正确率 子频带 频带 上截至 正确率(%)


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
33
序号 权重
ab
个数 频率
(Hz)
(%) 权重
ab
个数 频率
(Hz)
S1 1.44 0.00 2 82 48.00 ± 1.51 0.97 0.06 3 74 52.00 ± 2.54
S2 0.80 0.00 5 90 85.00 ± 2.60 1.15 0.07 5 74 79.50 ± 4.04
S3 0.40 0.00 4 74 92.50 ± 1.91 0.86 0.43 4 74 93.50 ± 1.99
S4 1.21 0.00 4 74 63.00 ± 0.85 0.00 0.00 2 74 64.00 ± 1.37
S5 0.55 0.00 4 74 100.0 ± 0.00 0.06 0.22 3 90 100.00 ± 0.00
S6 0.00 0.00 7 74 26.00 ± 3.72 0.11 0.15 6 74 30.00 ± 4.15
S7 1.35 0.00 3 82 63.50 ± 2.56 1.47 0.24 3 82 66.00 ± 2.35
S8 0.53 0.00 6 90 64.50 ± 1.33 0.52 0.50 5 82 63.50 ± 2.12
S9 1.43 0.00 2 82 94.00 ± 1.16 1.50 0.01 2 82 93.50 ± 1.55
S10 1.33 0.00 2 74 96.50 ± 1.37 1.30 0.35 5 74 97.50 ± 1.02
S11 1.28 0.00 2 82 82.00 ± 2.64 1.50 0.00 2 90 80.50 ± 2.54
S12 1.03 0.00 3 90 94.00 ± 2.12 1.28 0.21 2 90 94.00 ± 1.71
S13 0.92 0.00 5 74 88.50 ± 1.85 1.50 0.50 5 74 86.50 ± 1.55
S14 0.27 0.00 6 74 97.00 ± 1.12 0.92 0.25 7 90 97.50 ± 1.44
S15 0.46 0.00 4 74 97.50 ± 0.72 1.08 0.33 4 82 97.00 ± 0.46
S16 1.17 0.00 3 90 82.00 ± 1.96 1.14 0.07 2 82 83.00 ± 1.96
S17 0.68 0.00 5 90 98.50 ± 0.56 1.50 0.50 4 74 97.50 ± 0.00
S18 1.31 0.00 2 90 78.50 ± 2.94 1.50 0.44 2 90 78.00 ± 3.18
S19 1.35 0.00 2 74 100.0 ± 0.00 1.23 0.50 6 82 99.50 ± 0.46
S20 1.48 0.00 2 82 84.00 ± 3.03 0.76 0.00 2 90 82.50 ± 2.60
S21 0.43 0.00 6 82 80.00 ± 1.25 0.15 0.40 3 82 77.50 ± 2.98
S22 0.57 0.00 6 74 68.00 ± 1.83 0.64 0.06 7 74 67.00 ± 1.33
S23 0.12 0.00 9 90 85.50 ± 1.33 0.31 0.44 6 82 86.00 ± 1.85
S24 0.00 0.00 9 82 95.00 ± 0.00 1.42 0.39 7 82 95.00 ± 0.00
S25 1.18 0.00 2 74 94.50 ± 0.46 0.77 0.37 5 74 94.50 ± 0.46
S26 1.06 0.00 7 82 81.00 ± 1.55 1.24 0.00 6 90 81.00 ± 2.35
S27 0.52 0.20 6 90 75.50 ± 1.33 0.52 0.26 5 90 75.50 ± 3.10
S28 0.00 0.00 4 74 95.00 ± 0.00 1.08 0.11 4 82 95.00 ± 0.00
S29 1.45 0.00 2 74 95.50 ± 0.46 0.48 0.23 5 82 95.00 ± 0.00
S30 0.81 0.00 4 90 89.50 ± 1.51 0.18 0.13 4 82 88.50 ± 1.55
S31 0.00 0.00 9 82 82.00 ± 1.51 0.29 0.50 6 82 88.00 ± 1.83
S32 0.42 0.00 4 90 44.00 ± 2.66 0.01 0.45 5 74 45.00 ± 2.28
S33 0.41 0.00 5 82 96.50 ± 0.56 0.36 0.16 4 82 96.00 ± 0.91
S34 1.38 0.00 7 74 94.50 ± 1.51 1.50 0.00 4 74 94.00 ± 1.99
S35 0.00 0.00 5 90 47.00 ± 1.83 0.00 0.00 5 90 42.50 ± 2.60
平均 - - - - 81.67 ± 3.09 - - - - 81.60 ± 3.02
4.3.4 滤波器组参数适配技术对 SSVEP 解码性能的影响
从表 4-4 可以看出无论哪种方法,在优化滤波器组参数后正确率和信息传输速率都
有所提升。此外优化组合滤波器对不同方法结果提升的幅度不同,例如在 CCA 上相对
于预设参数的滤波器,使用优化组合的滤波器正确只提升了大约 0.1%,然而在 TRCA
上正确率却提升了 1.44%。
从表 4-5 可以看出,优化三类参数中的任何一种,都对结果有提升,但是不同的参


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
34
数对同一数据集的影响不同,例如,在 Benchmark 数据集数据长度为 1s 时,优化频带
个数对结果的提升最大,优化上截止频率对结果的提升最小。此外对于不同的数据集,
优化同一参数对结果的提升也不同,例如,数据长度为 0.6s 时,在 Benchmark 数据集
上优化子频带权重对结果的提升最小,而在 CA 数据集上对结果的提升却最大。但无
论在那个数据集上,同时优化三个参数的结果都是最优的。
表 4-4 滤波器组参数组合优化结果
不同方法 正确率(%) 信息传输速率(比特/分钟)
预设滤波器+CCA
(a=1.25,b=0.25,Nm=5,V=90Hz)
66.04±3.73 110.45±8.85
SSA+CCA 66.12±3.71 110.60±8.79
预设滤波器+TRCA
(a=1.25,b=0.25,Nm=5,V=90Hz)
89.79±2.92 178.59±7.86
SSA+TRCA(本文方法) 91.23±2.50 183.1±2.96
表 4-5 滤波器组不同类型参数优化对 SSVEP 解码性能的影响
参数选择 数据长度
子频带
权重
ab
频带个
数
上截止
频率
0.6s 0.7s 0.8s 0.9s 1s
Bench
mark
× × × × 72.36±4.30 79.52±3.92 84.68±3.45 87.81±3.12 89.79±2.92
√ √ × × 72.75±4.26 80.17±3.80 85.36±3.38 88.37±2.99 90.49±2.71
× × √ × 73.10±4.13 80.40±3.75 85.51±3.29 88.54±2.91 90.60±2.62
× × × √ 73.25±4.08 80.18±3.78 85.46±3.32 88.63±2.89 90.31±2.79
√ √ √ √ 74.67±3.82 81.27±3.59 86.79±3.13 89.33±2.64 91.23±2.50
CA
× × × × 69.30±3.84 72.59±3.61 75.13±3.48 78.00±3.31 80.19±3.13
√ √ × × 70.90±3.78 73.84±3.58 76.66±3.37 78.81±3.32 81.20±3.04
× × √ × 69.73±3.77 72.93±3.54 75.94±3.41 78.36±3.32 80.86± 3.06
× × × √ 69.63±3.79 72.91±3.60 75.14±3.49 77.86±3.34 80.31± 3.13
√ √ √ √ 71.14±3.77 74.11±3.54 76.71±3.41 79.17±3.20 81.60± 3.02
注:平均结果来组所有被试。粗体表示最佳结果。
4.4 本章小结
本章围绕 SSVEP 解码中的个体差异性问题,探讨了滤波器组方法在 SSVEP 分析
中的重要性,并指出传统滤波器组参数的固定设置可能无法充分适应个体间的差异。
针对这一问题,本章提出了基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法。该
方法利用麻雀优化算法为不同个体优化滤波器组参数,并结合 TRCA 进行分类,以提
高 SSVEP 解码的准确性和鲁棒性。实验结果表明,本章方法在较大的训练数据集上


第四章 基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法
35
(如 Benchmark 和 CA 数据集)相较于 TRCA 方法表现出显著的解码性能提升。然而,
在 BETA 数据集上,TRCA 方法的分类正确率高于本章方法,这可能是由于 BETA 数
据集的训练样本相对较少,导致参数优化的效果受限。分析表明,本章方法的性能对
训练数据规模存在较强的依赖性,在充足训练数据条件下,其特征表征能力较强,能
够显著提高 SSVEP 解码的准确性。然而,在小样本数据集上,预设参数的 TRCA 方法
可能表现出更强的鲁棒性,而本章方法由于参数优化可能会在小样本场景下出现一定
程度的性能下降。
综上所述,本章方法通过自适应参数优化有效提升了 SSVEP 解码的性能,尤其在
训练数据丰富的情况下具有显著优势。然而,其泛化能力在小样本数据集上可能受到
一定限制,这提示未来研究需进一步探索如何在有限训练数据的情况下提高算法的鲁
棒性,以增强其实用性和适应性。


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
36
第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
5.1 引言
在第三章与第四章中,分别针对被试内部的时域响应差异和频域特征差异,提出
了数据长度适配方法与个性化滤波器组参数优化策略。这些方法从不同维度提升了
SSVEP 解码系统在单一受试者内部的适应性与性能。然而,实际脑机接口应用往往面
临跨受试者使用的场景。在这种情况下,个体间的生理差异、认知状态、注意力水平
等因素会导致 SSVEP 信号在频率成分、相位、幅值以及波形形态等方面存在显著差异,
从而极大影响解码模型的泛化能力。
近年来,迁移学习作为提升跨被试识别性能的有效手段,被广泛应用于 SSVEP 相
关研究中[70]。其核心思想是利用源域数据的知识来提升目标域的学习效果,从而减少
个体间差异对模型性能的影响。然而,现有迁移学习方法在实际应用中仍面临多重挑
战:一方面,不同受试者之间 EEG 数据的细微差异往往被忽略,导致迁移后模型对目
标域的适应能力不足;另一方面,模型在复杂信号结构下难以有效提取并利用源域中
具有判别力的特征,进而影响最终的分类准确率与鲁棒性。
针对上述问题,本章提出一种基于多参考最小二乘变换的特征迁移框架,结合
SAME 和 PLTS 的数据增强策略,以提升模型在目标域的测试性能。在不依赖大量目标
域标注样本的前提下,该方法能够更好地适应个体间的特征分布差异,并通过多模型
决策融合机制增强识别的稳定性和鲁棒性。
5.2 方法
图 5-1 为本章方法详细流程。具体过程如下:
步骤一:数据划分。在进行数据划分时,我们对所使用的数据集采用留一验证法
进行划分。以 Benchmark 数据集为例,该数据集包含 35 名受试者。每次划分时,选取
其中 34 名受试者的数据作为源域数据,剩余 1 名受试者的数据作为目标域数据,总共
进行 35 次迭代,以确保 35 名受试者中的每一位都有且仅有一次作为目标域受试者参
与实验。
步骤二:使用源域受试者的数据训练双域网络。该网络将输入的数据分为两条路
径。1):滤波器路径,滤波器路径由 3 层卷积构成,首先对数据进行带通滤波处理
(滤


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
37
图 5-1 本章方法详细流程
波范围分别为 5-90HZ,14-90HZ,22-90HZ),然后对不同频带的数据进行 120 个卷积
核大小为 Nc×1(Nc 为通道数)的卷积层提取通道信息,随后经过 120 个卷积核大小为
1×2 和 1×10 的卷积层捕获时间尺度特征,最终将不同频带所提取的特征融合;2):
多参考最小二乘路径,多参考最小二乘路径由 4 层卷积构成。首先对数据进行多参考
最小二乘处理,具体过程如下:


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
38
最小二乘变换,一种常用的统计方法,在变量之间建立线性关系模型。其主要目
标是通过最小化残差平方和来估计回归模型的参数,从而量化预测值与实际观测值之
间的差异。当 X1 和 X 2 表示两个二维变量时,最小二乘变换的目标是通过求解公式(5
1)确定一个变换矩阵 P:
2 1 22
||  ||
P
P = argmin X PX (5-1)
公式(5-1)的解可由公式(5-2)给出:
T T1 12 22
( )
P = X X X X (5-2)
多参考最小二变换应用于每个刺激对应的每个试次信号,以生成新的多通道信号。
假设 ( ) c s
NN
i
t R
X  表示第 t 个刺激的第 i 次信号,其中 Nc 表示通道数 Ns 表示采样点数,
且Yt 表示正弦-余弦模板。多参考最小二变换的目标是使用公式(5-3)将不同受试者
的 SSVEP 信号映射到正弦-余弦模板:
_2
2
arg min || ||
t
t t tt

P
P Y P X (5-3)
AA是某类刺激所有试次的平均信号,第 t 类刺激对应的正弦-余弦模板信号Yt 可由
公式(5-4)获得。
sin(2 )
cos(2 ) 12
... , =[ , ,... ]
sin(2 )
cos(2 )
tt
tt
s t
ss s h t ht
h t ht
f
f N
Y t ff f
Nf N
Nf N










 





(5-4)
其中 Nh 表示谐波的数量, ft 表示刺激频率,t 表示刺激相位, Ns 表示采样点数,
fs 表示采样率。
当获得 Pt 后,对每个试次信号 (i)
X 进行变换,即 (i)
Pt  X ,从而生成新的多通道信
号。例如,在 Benchmark 数据集中,有 40 个刺激类别,则会有 40 个正弦-余弦模板,
每个模板的大小为 2 h s
N  N 。在每个试次上执行 MLST 后,将生成 40 个变换后的信号,
其大小均为 2 h s
N N 。
经过多参考最小二处理过后的数据经过卷积核大小为 1×1 的卷积层提取信息,随
后经过 120 个卷积核为 2Nh×1 的卷积层提取通道信息,最后通过 120 个卷积核大小为
1×2 和 1×10 的卷积层捕获时间尺度特征。
为了更好的利用滤波器路径和多参考最小二乘路径的信息,本研究将滤波器路径
的第一,二,三层的卷积输出和多参考最小二乘路径的第二,三,四层的卷积输出融
合,并对融合之后的数据进行卷积。最终不同路径的输出经全连接层分类后,将其分


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
39
类结果加权求和得到预测结果。
步骤三:目标域数据划分及训练 eTRCA-K、TDCA 模型。首先,将目标域受试者
的数据分为有标签数据和无标签数据。对于每个刺激类别,只有一个样本是有标签数
据,其余样本均为无标签数据(例如在 Benchmark 数据集中,1 个有标签数据,5 个无
标签数据)。该过程迭代进行 6 次,确保每个样本都有且仅有一次作为有标签数据。有
标签数据经过 SAME 增强和 PLTS 增强方法进行数据扩增。具体过程如下:
(1) SAME 数据增强
对于某类刺激的单个有标签数据 Xt 和正弦-余弦模板信号Yt (t 表示刺激类别),采
用均方误差最小化方法来估计别名矩阵  :
^2
F
arg min || ||
tt
 X Y

  (5-5)
其中 F
|| || 是弗罗贝尼乌斯范数。公式(5-5)的解可以通过最小二乘问题[71, 72]解
决。人工重构的模板信号AA被定义为:
tt


S Y (5-6)
为了获得多个生成信号,需要向AA 添加随机噪音。为了确保添加到不同通道的噪
声强度比例与AA的信号强度匹配,假设 1 Np
c R
s  表示AA的第 c 个通道的信号, D(s) 表
示 s 的方差,则噪声的协方差矩阵 c c
NN
R
  可计算如下:
12
(D( ), D( ), ..., D( Nc ))
  diag s s s (5-7)
其中,diag( )表示将元素沿对角线排列。
最终,人工生成的信号由以下公式生成 :
( ) ( ) , 1, 2,...
kk t
t noise a
Z  S W k  N
∧
(5-8)
Na 为生成信号的数量, (k )
noise
W 服从高斯分布[54],其均值向量为 0,协方差矩阵为  ,
即 ( ) ~ (0, )
k
Wnoise N  ,参数用于控制噪声的强度,在本章中设定为 0.05。
(2) PLTS 数据增强
为了充分利用实验数据,除了原始数据 0[ , w ]
x d d  T (表示从 d 时间开始,持续 Tw
秒)秒之外,我们假设在每个试次的时间区间[ , ]
wn
d  T T ( Tn 表示试次结束时间)秒内
的数据也可以用于 SSVEP 模型的训练。由于受试者在整个试次中始终注视闪烁刺激,
因此 SSVEP 会在整个试次内被持续诱发。具体而言,从时间区间[ , ]
tt w
a a T ( at 表示
用于提取新样本数据的起始时间, t w
a  T 表示其结束时间)秒提取的数据应当与 x0 具
有相似的 SSVEP 特性,并可作为训练模型的新样本。最优的新样本数据 xa 可以通过寻
找最大相似性的采样点位置 a 确定(其中 t s
a  a  f , fs 为采样率):
0a
a  argmax Similarity( x , x ) (5-9)


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
40
相似性通过 x0 和 xa 之间的相关性来衡量:
__
00
1
0 __
22 11
( [ ] )( [ ] )
1
(, )
( [] ) ( [] )
11
s
ss
N
aa
i
a
NN aa aa
ii
ss
ii
N
Similarity
ii
NN









x xx x
xx
xx xx
(5-10)
其中
_
x0 和
_
xa 分别是 x0 和 xa 的均值, Ns 为采样点数。并通过网格搜索方法,令时
间点 a 从 1, 2, ..., ( )
s s nw s
d  f  d  f  T T  f 依次取值,计算 x0 与所有可能的 xa 之间的
相似性,并选择相似性最大的采样点位置作为最优 a。
在 SSVEP-BCI 中,新样本数据 xa 随采样点位置 a 的变化呈现出周期性地与原始数
据 x0 具有较高的相似性,该周期等于试次刺激频率的倒数。因此,对于第 n 类试次数
据(刺激频率为 fn Hz),除了原始数据外,还可以采用时间偏移的增强方法扩充新样
本数据,其步长 sn 计算如下:
s n n
f
sf
  (5-11)
获得的新样本数据在[ , ]
tt w
a a T 秒中可作为额外的训练样本。采样点位置 a 计算如
下:
, 1, 2, ...,
ts n a
a  a  f  p  s p  N (5-12)
其中, Na 表示生成信号的数量。
在本章研究中 SAME 增强生成 3 个数据样本,PLTS 增强生成 6 个数据样本。不同
方法增强后的数据分别用于训练 eTRCA-K 和 TDCA 模型,从而得到相应的模板。其中
eTRCA-K 的模型训练与 TRCA 的模型训练相同(都为得到最佳权重向量 wˆ ),故不在
叙述。TDCA 的模型训练过程如下:
与 TRCA 的生成模型不同,TDCA 是一种判别模型,直接用于为所有类别寻找滤
波器[38]。TDCA 的目标是最大化类间差异,同时最小化类内差异。具体细节如下所述:
假设第 n 类刺激频率的个体校准数据为 ( )
() c p
N Nl
j
n R 
X  ,l 为延迟的数据点数。首
先,通过使用时间延迟数据 0 1
, ,..., c p
NN
l R
X X X  来增 加 ( j)
Xn 的空间维度。那么
()
~ ( 1)
cp
j
Nl N
n R 
X  由公式(5-13)得到:
()
~
01
[ , ,..., ]
j
T T TT
nl
X  X X X (5-13)
其次,数据
()
~j
n
X 通过与对应于第 A类频率 fn 的正交投影矩阵 Pn 相乘,被投影到子
空间中,关于 Pn 的构造方法在文献[73]中有详细描述,然后,通过将投影前后的信号进


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
41
行拼接,增加 EEG 数据的时间维度,从而得到数据 ( 1) 2
() c p
Nl N
j
n R 
A 。
() ()
~~
() [ , ]
jj
j nn
nn
A  X X P (5-14)
最后,采用二维线性判别分析来求解滤波矩阵 ( 1)
ck
Nl N
R 
w  ,其中 Nk 为子空间数
量。类间散布矩阵 ( 1) ( 1)
cc
Nl Nl
b R  
S  和类内散布矩阵 ( 1) ( 1)
cc
Nl Nl
w R  
S  定义如下:
1
1 ( )( )
Nf
T
nn
b
Nf n
  

 

S A A A A (5-15)
__
() ()
11
1 ( )( )
ft
NN
j jT
nn
w nn nj
ft
NN  
 

S A A A A (5-16)
其中,第 n 类的中心
_
An 和所有类别的中心 A 被定义为:
_ ()
11
11
,
f
tN
N j
n nn
n
jn
tf
NN




A A A A (5-17)
矩阵 w 的解可表示为:
ˆ
T b T w
tr( )
= argmax tr( )
w
w Sw
w w S w (5-18)
其中 wˆ 由矩阵 1
wb
S  S 的前 Nk 个特征向量组成,这些特征向量按照特征值的降序排
列。 wˆ 即为 TDCA 对应的训练模板。
步骤四:特征提取。将无标签数据送入训练好的双域融合网络进行特征提取。将
有标签数据分别送入基于 SAME 和 PLTS 训练的 eTRCA-K 和 TDCA 模型提取特征。其
中 eTRCA-K 特征提取过程如下:
考虑到 TRCA 训练的 N f ( N f 为刺激频率个数)个空间滤波器 wˆ 彼此相似,因此
可以将所有空间滤波器整合成一个矩阵 c f
NN
R
W  ,即 eTRCA。然后,第 n 次视觉刺
激的测试数据 Nc ×Ns
X  R 与训练数据的平均信号 × ( 1, ..., )
cs
NN nf
Y  R n  N 之间的相关系
数计算方式为:
= ( , ), 1, 2, ...,
TT nn f
  W X W Y n  N (5-19)
其中(. , .) 表示两个信号之间的二维相关分析计算,这里我们引入肯德尔系数
(Kendall rank - correlation coefficient),n 即为 eTRCA-K 获得的特征。
TDCA 特征提取过程如下:
在测试阶段单试次测试数据 ' c p
NN
R
X  需要用零填充为 ( )
' cp
N Nl
l R 
X  。然后,按
照训练阶段相同的方法,得到维度提升后的信号 ( 1) 2
'c p
Nl N
R 
A  ,接着计算均值中心AA


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
42
与单试次测试数据 A' 之间的相关系数,其计算公式如下:
'
( ,)
TT
n
rn corr

 w A w A (5-20)
rn 即为 TDCA 获得的特征。
步骤五:特征融合及分类。将基于 SAME/PLTS 增强的 eTRCA-K、TDCA 提取的
特征及双域网络提取的特征进行[0,1]归一化后相加。最终的分类结果由归一化后特征
值最高的类别决定。
5.3 结果与分析
5.3.1 基于 eTRCA-K 决策的 SSVEP 解码性能
图 5-2 在 Benchmark 数据集上基于不同数据增强方法的 eTRCA 和 eTRCA-K 性能对比。图中的星号
表示通过配对 t 检验确定的显著差异(*表示 p < 0.05,**表示 p < 0.01,*** 表示 p < 0.001)
如图 5-2 所示,在 Benchmark 数据集上,eTRCA-K 相较于 eTRCA 具有更高的分
类正确率和信息传输速率,且两者在不同数据增强方法(SAME 和 PLTS)下均随着数
据长度的增加而提升。其中,eTRCA-K 在 SAME 方式下的最高准确率为 89.04% ±
2.64%,在 PLTS 方式下为 88.15% ± 2.53%,均优于 eTRCA。此外,在 ITR 方面,


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
43
eTRCA-K 也整体优于 eTRCA,且 PLTS 方法在较短的数据长度(0.5s、0.6s)下性能
略优于 SAME,而在较长的数据长度下两者表现相近。这表明 eTRCA-K 结合 PLTS 方
法在较短的数据长度下能够提供更优的分类性能,为 SSVEP 相关脑机接口系统的优化
设计提供了重要参考。
如图 5-3 所示,在 BETA 数据集上,eTRCA-K 在两种数据增强方法(SAME 和
PLTS)下均表现优于 eTRCA,且整体准确率和信息传输速率(ITR)随着数据长度的
增加而提升。其中,在 SAME 方式下,eTRCA-K 的最高准确率达到 72.06% ± 2.38%,
相较于 eTRCA(69.96% ± 2.51%)提升明显;在 PLTS 方式下,eTRCA-K 的最高准确
率为 71.13% ± 2.27%,同样优于 eTRCA(69.14% ± 2.40%)。此外,在 ITR 方面,
eTRCA-K 也整体高于 eTRCA,这一结果进一步验证了 eTRCA-K 的有效性。
图 5-3 在 BETA 数据集上基于不同数据增强方法的 eTRCA 和 eTRCA-K 性能对比。图中的星号表示
通过配对 t 检验确定的显著差异(*表示 p < 0.05,**表示 p < 0.01,*** 表示 p < 0.001)
5.3.2 多决策模型与主流模型的 SSVEP 解码性能对比
本研究在 Benchmark 和 BETA 两个 SSVEP 数据集上,针对不同数据长度进行了性
能验证。表 5-1、5-2、5-3、5-4 分别展示了各方法在不同数据集上(表 5-1、5-3 为


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
44
Benchmark 数据集,表 5-2、5-4 为 BETA 数据集)的分类准确率和信息传输速率(均
值±标准差)。
表 5-1 在 Benchmark 上 13 种不同方法在不同数据长度下所有受试者的平均准确率(%)
方法 数据长度(s)
0.5 0.6 0.7 0.8 0.9 1.0
FBCCA 20.92±1.94 30.60±2.72 41.13±3.37 49.50±3.58 58.39±3.68 65.67±3.72
Compact CNN 33.65±2.94 40.70±3.35 48.69±3.50 56.15±3.56 59.99±3.61 64.63±3.55
Ensemble Dnn 53.92±3.87 61.78±3.82 69.01±3.81 74..40±3.72 78.62±3.61 80.88±3.53
eTRCA with
SAME
59.82±3.81 68.81±3.82 76.31±3.55 81.78±3.26 85.44±3.00 87.50±2.84
eTRCA-K
with SAME
62.30±3.74 70.74±3.67 78.18±3.42 83.57±3.13 86.95±2.83 89.04±2.64
TDCA with
SAME
64.82±3.73 73.42±3.71 80.32±3.42 85.41±3.02 88.82±2.61 91.11±2.32
eTRCA with
PLTS
63.34±3.67 70.37±3.57 77.04±3.33 81.70±3.09 84.71±2.89 86.81±2.68
eTRCA-K
with PLTS
64.80±3.54 71.85±3.48 78.37±3.24 83.07±2.97 86.10±2.72 88.15±2.53
TDCA with
PLTS
66.30±3.39 73.44±3.28 80.31±3.01 84.89±2.73 87.90±2.48 89.89±2.26
LST 43.22±3.68 53.25±3.92 64.93±3.99 74.04±3.92 76.69±3.65 83.18±3.42
msCCA 50.13±3.74 56.60±3.89 63.95±3.95 70.19±3.75 74.58±3.64 77.89±3.49
OS-SSVEP 76.53±3.05 82.65±2.78 87.45±2.55 90.55±2.19 92.79±1.84 94.05±1.59
我们的方法 78.91±2.89 84.22±2.57 88.60±2.32 91.50±2.03 93.29±1.73 94.39±1.53
注:粗体表示最佳结果。
(1)分类准确率表现
在 Benchmark 数据集上(表 5-1),本文方法在 0.5 秒较短的数据长度下即取得
78.91%的识别准确率,较当前最优方法 OS-SSVEP 提升 2.38%。随着数据长度增加至
1.0 秒,本文方法准确率达到 94.39%,优于所有对比方法。
BETA 数据集(表 5-2)验证了本文方法的泛化能力,本文方法在 0.5 秒条件下准
确率达 66.13%,相比当前最优方法 OS-SSVEP 提升 2.19%。并且在所有数据长度下均
优于 OS-SSVEP,展现出对复杂场景的强适应能力。
(2)信息传输速率对比
在反映系统综合性能的信息传输速率指标上,本文方法在 Benchmark 数据集(表
5-3)0.5 秒的数据长度条件下的信息传输速率为 215.15 比特/分钟,较次优方法 OS
SSVEP 提升 4.63%。随着数据长度增加,信息传输速率呈现典型收敛特性,但在 1.0 秒


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
45
时仍保持 191.59 比特/分钟的优异表现。在 BETA 数据集上(表 5-4),本文方法在数据
长度为 0.5 秒时达到 162.99 比特/分钟,较 OS-SSVEP 提升 4.76%,且在所有数据长度
下保持领先优势。
表 5-2 在 BETA 上 13 种不同方法在不同数据长度下所有受试者的平均准确率(%)
方法 数据长度(s)
0.5 0.6 0.7 0.8 0.9 1.0
FBCCA 23.37±1.41 31.96±1.82 39.14±2.08 46.15±2.30 52.55±2.50 57.88±2.51
Compact CNN 28.98±1.96 33.13±2.22 40.89±2.42 45.71±2.52 46.60±2.77 49.25±2.60
Ensemble Dnn 47.61±2.55 53.26±2.70 57.95±2.80 61.07±2.73 64.35±2.68 66.83±2.75
eTRCA with
SAME
50.89±2.52 56.55±2.58 61.53±2.61 65.17±2.55 67.88±2.54 69.96±2.51
eTRCA-K
with SAME
53.22±2.49 59.01±2.53 63.89±2.52 67.49±2.44 70.04±2.40 72.06±2.38
TDCA with
SAME
54.33±2.45 60.16±2.45 65.43±2.38 68.92±2.29 71.67±2.23 74.13±2.09
eTRCA with
PLTS
52.03±2.36 56.46±2.44 61.02±2.44 64.30±2.42 66.82±2.42 69.14±2.40
eTRCA-K
with PLTS
53.73±2.32 58.48±2.37 62.92±2.38 66.28±2.34 68.77±2.33 71.13±2.27
TDCA with
PLTS
54.32±2.24 59.36±2.26 64.20±2.25 67.37±2.20 70.10±2.12 72.37±2.06
LST 31.69±2.23 36.88±2.45 43.20±2.70 49.11±2.87 53.76±2.91 58.05±2.96
msCCA 41.96±2.42 46.51±2.54 51.12±2.68 54.57±2.73 57.65±2.76 60.09±2.76
OS-SSVEP 63.94±2.27 68.72±2.24 73.38±2.12 75.88±2.00 78.49±1.87 80.26±1.77
我们的方法 66.13±2.13 70.55±2.10 74.46±2.04 77.00±1.91 79.32±1.81 81.11±1.72
注:粗体表示最佳结果。
表 5-3 在 Benchmark 上 13 种不同方法在不同数据长度下所有被试的 ITR(比特/分钟)
方法 数据长度(s)
0.5 0.6 0.7 0.8 0.9 1.0
FBCCA 27.48±4.28 48.78±6.70 67.83±8.15 82.58±8.70 98.04±8.83 109.49±8.84
Compact
CNN
59.79±8.01 73.04±9.08 87.33±9.26 99.59±9.13 102.27±8.72 106.5±8.23
Ensemble
Dnn
123.28±12.82 136.84±12.11 148.35±11.47 153.28±10.65 155.51±10.01 151.68±9.27
eTRCA with
SAME
142.77±12.84 161.11±12.45 173.56±10.99 177.97±9.63 176.51±8.51 171.25±7.62
eTRCA-K
with SAME
152.70±12.92 168.10±12.10 179.17±10.72 183.23±9.34 180.83±8.13 175.28±7.23
TDCA with
SAME
161.28±12.96 177.21±12.15 186.24±10.81 189.13±9.26 186.51±7.79 181.2±6.59
eTRCA with 156.42±12.58 166.43±11.71 174.94±10.45 176.67±9.22 173.62±8.23 168.29±7.32


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
46
方法 数据长度(s)
0.5 0.6 0.7 0.8 0.9 1.0
PLTS
eTRCA-K
with PLTS
160.97±12.27 171.01±11.51 178.90±10.28 180.65±9.00 177.41±7.92 171.90±7.06
TDCA with
PLTS
165.55±11.82 175.91±10.88 185.06±9.68 186.29±8.42 182.88±7.36 176.92±6.43
LST 89.65±11.07 111.01±11.55 136.65±11.47 153.94±10.85 159.52±9.85 159.0±8.96
msCCA 110.79±11.96 120.86±11.78 133.09±11.47 140.60±10.39 143.13±9.65 142.64±8.80
OS-SSVEP 205.63±11.64 210.82±10.13 211.83±8.83 206.77±7.35 199.65±5.99 190.50±5.03
我们的方法 215.15±11.18 216.65±9.59 215.80±8.24 210.11±6.94 201.30±5.73 191.59±4.86
注:粗体表示最佳结果。
综上所述,无论是在 Benchmark 数据集还是 BETA 数据集上,所提方法在正确率
和信息传输速率方面,相较于多种对比方法均展现出良好的性能,体现了该方法的有
效性和鲁棒性。
表 5-4 在 BETA 上 13 种不同方法在不同数据长度下所有被试的 ITR(比特/分钟)
方法 数据长度(s)
0.5 0.6 0.7 0.8 0.9 1.0
FBCCA 32.57±3.27 49.16±4.34 61.77±4.97 73.57±5.42 83.60±5.80 90.14±5.71
Compact CNN 47.85±4.90 53.92±5.39 67.69±5.83 73.75±5.87 71.62±6.15 71.54±5.59
Ensemble Dnn 101.76±8.06 109.89±8.02 114.65±7.89 114.10±7.36 114.37±6.89 113.51±6.71
eTRCA with
SAME
112.71±7.76 119.87±7.55 124.79±7.32 125.19±6.77 123.66±6.39 120.79±6.00
eTRCA-K
with SAME
119.51±7.80 126.85±7.56 131.07±7.24 131.00±6.63 128.68±6.20 125.50±5.84
TDCA with
SAME
123.01±7.75 130.04±7.42 135.03±6.96 134.59±6.37 132.49±5.89 129.93±5.30
eTRCA with
PLTS
115.42±7.24 118.71±7.04 122.20±6.80 122.03±6.39 120.21±6.07 118.06±5.69
eTRCA-K
with PLST
120.13±7.22 124.20±7.01 127.21±6.76 126.90±6.30 124.74±5.99 122.43±5.55
TDCA with
PLTS
121.63±7.04 126.40±6.80 130.46±6.50 129.48±6.03 127.60±5.57 125.00±5.18
LST 56.55±5.94 64.74±6.21 75.49±6.71 84.28±6.90 89.43±6.75 93.48±6.57
msCCA 84.60±6.83 89.79±6.78 95.04±6.92 96.74±6.70 97.49±6.52 96.72±6.17
OS-SSVEP 155.59±7.96 157.98±7.34 159.89±6.66 155.14±5.97 151.62±5.33 146.40±4.80
我们的方法 162.99±7.59 163.68±7.02 163.22±6.50 158.40±5.77 153.99±5.24 148.77±4.72
注:粗体表示最佳结果。
5.3.3 多决策跨被试适配模型的消融实验


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
47
表 5-5 消融实验的准确率(%)
参数选择 数据长度
双域网络 eTRCA-K
with SAME
eTRCA-K
with PLTS
TDCA with
SAME
TDCA with
PLTS
0.6s 0.7s 0.8s 0.9s 1s
Bench
mark
× √ √ √ √ 77.41±3.22 83.33±2.94 87.45±2.58 90.24±2.28 91.82±2.01
√ × √ √ √ 83.84±2.62 88.34±2.37 91.30±2.08 93.06±1.77 94.21±1.56
√ √ × √ √ 83.92±2.57 88.39±2.32 91.35±2.02 93.15±1.75 94.18±1.55
√ √ √ × √ 84.07±2.61 88.36±2.37 91.43±2.06 93.29±1.75 94.30±1.53
√ √ √ √ × 83.91±2.63 88.26±2.37 91.31±2.08 93.13±1.75 94.27±1.57
√ √ × √ × 83.15±2.75 87.58±2.50 90.92±2.17 92.84±1.84 94.10±1.61
√ × √ × √ 82.93±2.66 87.64±2.38 90.74±2.11 92.54±1.83 93.71±1.64
√ √ √ √ √ 84.22±2.57 88.60±2.32 91.50±2.03 93.28±1.73 94.39±1.53
BETA
× √ √ √ √ 63.40±2.33 67.71±2.29 70.77±2.21 73.24±2.11 75.20±2.05
√ × √ √ √ 69.99±2.08 74.00±2.04 76.60±1.92 78.87±1.82 80.80±1.72
√ √ × √ √ 70.20±2.10 73.95±2.08 76.72±1.93 79.00±1.84 80.93±1.74
√ √ √ × √ 70.69±2.08 74.37±2.06 76.93±1.91 79.30±1.80 81.00±1.71
√ √ √ √ × 70.35±2.13 74.18±2.07 76.79±1.95 79.18±1.86 81.02±1.75
√ √ × √ × 69.76±2.16 73.71±2.11 76.32±1.99 78.69±1.89 80.58±1.77
√ × √ × √ 68.93±2.09 72.69±2.07 75.62±1.95 78.05±1.86 79.77±1.77
√ √ √ √ √ 70.55±2.10 74.47±2.04 77.00±1.91 79.32±1.82 81.11±1.72
注:粗体表示最佳结果。
从表 5-5 中可以看出,在 Benchmark 数据集中,当数据长度为 1s 时,移除双域网
络模块导致分类正确率从 94.39%显著下降至 91.82%(降幅 2.57%),而在较短数据长
度下(如 0.6s)正确率从 84.22%下降至 77.41%(降幅 6.81%),表明双域网络模块所
提 取 特 征 的 作用 随 数 据长 度 缩 短而 愈 发 显著 。 移 除 eTRCA-K 或 TDCA 模 块 ( 如
eTRCA-K with SAME 或 TDCA with PLTS)后,数据长度为 1s 时的正确率降幅较小
( 约 0.1-0.2% ), 但 数 据 长 度 为 0.6s 时 正 确 率 下 降 更 明 显 ( 如 移 除 eTRCA-K with
SAME 后从 84.22%降至 83.84%,降幅 0.38%),这表明在单独模块中双域网络的贡献
更大。通过分析数据增强方法发现,移除 PLTS 相关模块(eTRCA-K with PLTS 和
TDCA with PLTS)后,数据长度为 1s 时正确率从 94.39%降至 94.10%(降幅 0.29%),
而 0.6s 时从 84.22%降至 83.15%(降幅 1.07%);移除 SAME 相关模块(eTRCA-K with
SAME 和 TDCA with SAME)后,数据长度为 1s 时性能从 94.39%降至 93.71%(降幅
0.68%),0.6s 数据从 84.22%降至 82.93%(降幅 1.29%),表明 SAME 比 PLTS 的增强
效果更优。在 BETA 数据集中,趋势与 Benchmark 一致:数据长度为 1s 时移除 PLTS
后正确 率从 81.11%降至 80.58%(降幅 0.53%),移除 SAME 后降至 79.77%(降幅


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
48
1.34%);0.6s 时移除 PLTS 后正确率从 70.55%降至 69.76%(降幅 0.79%),移除 SAME
后降至 68.93%(降幅 1.62%),进一步验证 SAME 的鲁棒性优势。两类数据集的分类
性能均随数据长度增加而提升(Benchmark 从 0.6s 的 84.22%升至 1s 的 94.39%,BETA
从 70.55%升至 81.11%),证实数据长度对 SSVEP 稳态特性捕捉的重要性。此外,在表
5-6 中的信息传输速率表现也呈现出类似趋势。综上,双域网络为该方法的核心模块,
此外,在该方法中,SAME 比 PLTS 更具有贡献值。
表 5-6 消融实验的 ITR(比特/分钟)
参数选择 数据长度
双域
网络
eTRCA-K
with SAME
eTRCA-K
with PLTS
TDCA
with
SAME
TDCA
with
PLTS
0.6s 0.7s 0.8s 0.9s 1s
Bench
mark
× √ √ √ √ 191.12±9.05 196.44±9.61 195.54±8.16 190.99±6.97 183.15±5.95
√ × √ √ √ 215.21±9.74 214.87±8.38 209.43±7.06 200.53±5.82 190.98±4.93
√ √ × √ √ 215.37±9.59 214.89±8.23 209.46±6.91 200.81±5.76 190.88±4.92
√ √ √ × √ 216.17±9.70 214.95±8.37 209.89±7.00 201.37±5.76 191.33±4.85
√ √ √ √ × 215.56±9.74 214.51±8.37 209.48±7.05 200.75±5.77 191.28±4.96
√ √ × √ × 212.75±9.37 212.12±8.67 208.20±7.30 199.83±5.99 190.77±5.07
√ × √ × √ 211.45±9.81 211.97±8.41 207.25±7.16 198.60±5.97 189.30±5.13
√ √ √ √ √ 216.65±9.60 215.80±8.24 210.11±6.93 201.30±5.73 191.59±4.86
BETA
× √ √ √ √ 139.98±7.25 141.79±6.79 139.80±6.21 136.64±5.68 132.76±5.24
√ × √ √ √ 161.53±6.93 161.57±6.47 157.14±5.77 152.63±5.24 147.84±4.72
√ √ × √ √ 162.48±7.02 161.60±6.57 157.55±5.81 153.13±5.30 148.27±4.75
√ √ √ × √ 164.13±7.00 163.00±6.55 158.17±5.77 153.92±5.20 148.63±4.69
√ √ √ √ × 163.19±7.12 162.38±6.58 157.89±5.87 153.72±5.32 148.60±4.77
√ √ × √ × 161.18±7.19 160.97±6.66 156.51±5.95 152.30±5.37 147.34±4.82
√ × √ × √ 157.80±6.88 157.22±6.48 154.04±5.81 150.25±5.33 144.92±4.81
√ √ √ √ √ 163.68±7.02 163.22±6.50 158.39±5.77 153.99±5.23 148.77±4.72
注:粗体表示最佳结果。
5.4 本章小结
针对 SSVEP-BCI 中个体差异显著导致的迁移学习瓶颈问题,本章提出了一种多决
策融合框架,该框架通过双域网络将源域和目标域数据映射至正弦-余弦模板,进行特
征迁移,以减少跨主体域间的差异并提升迁移效果,并结合基于 SAME 和 PLTS 的数
据增强方法,扩展目标域训练样本,并将其融入 eTRCA-K 与 TDCA 的训练过程。实验
在 Benchmark 数据集和 BETA 数据集上进行。结果表明,在数据长度为 0.5s 的条件下,
该方法在两个数据集上的识别准确率分别达到 78.94% 和 65.69%。相比于 OS-SSVEP


第五章 基于多决策融合模型的跨被试适配 SSVEP 解码方法
49
方法,准确率分别提升了 2.41% 和 1.73%。本研究通过迁移学习框架与混合增强策略
的协同优化,在一定程度上解决了迁移学习对个体差异的敏感性限制,为短时 SSVEP
BCI 系统的实用化提供了理论支持与技术路径。


第六章 总结与展望
50
第六章 总结与展望
6.1 论文工作总结
本研究围绕稳态视觉诱发电位中个体差异性较强的问题,从数据长度适配、滤波
器组参数适配以及特征迁移跨被试适配三个维度展开 SSVEP 解码研究,主要贡献如下:
(1)基于改进 TRCA 数据长度适配的 SSVEP 解码方法:该方法首先通过协方差
分析量化不同数据长度下的分类性能,构建长度-性能映射模型,并在 TRCA 特征提取
阶段引入 CCA,实现特征提取与数据长度的协同优化。该方法在 Benchmark 数据集和
BETA 数据集上的解码正确率分别为 97.04%和 77.21%,与传统的 TRCA 方法相比分别
提升了 2.77%和 4.68%。该方法显著提升了系统在保持高准确率下的信息传输效率,有
效解决了传统预设数据长度方法在面对个体响应差异时难以兼顾准确率与 ITR 的问题。
(2)基于 SSA-TRCA 滤波器组参数适配的 SSVEP 解码方法:该方法通过群体智
能优化算法对滤波器组的关键参数(子频带数量、权重系数、上截止频率)进行全局
搜索,确定最适合不同被试的参数组合,并结合 TRCA 完成多子频带特征提取与分类。
结果表明,优化后的滤波器组使 TRCA 在 Benchmark 数据集上的识别准确率提升至
91.27%,较原始 TRCA 提高了 1.44%;在 CA 数据集上达到 81.67%,提升幅度为
1.40%。实验验证表明,该协同优化策略能够有效克服预设滤波器参数所带来的个体特
征失配问题,显著增强模型对不同受试者频域特征的适应能力,提高了解码准确率与
鲁棒性。
(3)基于多决策融合模型的跨被试适配 SSVEP 解码方法:该方法通过构建双域
网络,将源域与目标域数据统一映射到正弦-余弦模板空间,以减少受试者间特征分布
差异。同时,结合 SAME 与 PLTS 策略,对目标域进行数据增强,扩展训练样本。增
强 后 的 数 据 被 引 入 eTRCA-K 和 TDCA 模 型 中 , 进 一 步 提 升 分 类 性 能 。 实 验 在
Benchmark 和 BETA 数据集上进行,在 0.5s 数据长度条件下,识别准确率分别达到
78.94% 和 65.69%,相较于对比方法 OS-SSVEP 提升了 2.41% 和 1.73%。结果表明,该
方法有效缓解了跨受试者特征迁移过程中的域间差异问题,提升了跨主体 SSVEP 解码
的准确性与泛化能力。
综上所述,本研究围绕 SSVEP 解码中个体差异性显著的问题,分别从数据长度适
配、滤波器组参数适配以及特征迁移跨被试适配三个维度提出了针对性的优化策略。
在被试内方面,提出了基于改进 TRCA 的数据长度适配方法与基于 SSA-TRCA 的滤波


第六章 总结与展望
51
器组适配方法,显著提升了个体的解码性能;在跨被试适应方面,构建了基于特征迁
移的多决策融合模型,增强了模型的泛化能力与稳定性。三项方法均在多个公开数据
集上进行了系统验证,取得了优于现有方法的识别准确率与信息传输速率,充分展示
了所提方法在提升 SSVEP-BCI 系统实用性和鲁棒性方面的应用潜力。
6.2 未来工作展望
尽管本研究在 SSVEP 解码技术上取得了进展,但是仍存在下列问题需要改进:
(1)当前基于改进 TRCA 的数据长度适配方法虽能动态调整数据长度以平衡正确
率与信息传输速率之间的关系,但其计算复杂度较高,尤其在多目标 SSVEP 场景中,
实时性可能受限于协方差分析的迭代更新与改进 TRCA 特征提取的联合优化过程。此
外,数据长度的动态调整依赖于离线训练阶段的参数标定,对在线实验中受试者注意
力波动或环境噪声干扰的即时适应性仍显不足。未来的研究可尝试引入轻量级特征评
估机制,以降低计算开销、提升在线适应性与响应速度。
(2)基于 SSA-TRCA 的双阶段优化模型虽能有效提升个体解码性能。但该方法的
性能对训练数据规模存在较强的依赖性,在充足训练数据条件下,其特征表征能力较
强,能够显著提高 SSVEP 解码的准确性。然而,在小样本数据集上该方法会出现一定
程度的性能下降。未来可引入数据增强策略,以缓解小样本条件下的参数估计困难,
提升模型的鲁棒性与泛化能力。
(3)尽管基于特征迁移的多决策融合模型有效缓解了跨受试迁移中的特征偏移问
题,但在源域数据的利用效率上仍存在改进空间。本文方法使用所有的源域数据进行
模型训练,未考虑源域数据与目标域数据之间可能存在显著的分布差异,甚至部分源
域数据可能对迁移过程产生负迁移效应。未来研究可进一步引入源域数据选择机制,
从全局或局部特征层面筛选最具迁移价值的源域数据,从而提高迁移学习的稳定性和
适应性,避免由冗余或不匹配数据引发的性能下降。


参考文献
52
参考文献
[1] NORCIA A M, APPELBAUM L G, ALES J M, et al. The steady-state visual evoked potential in vision research: A review [J]. Journal of Vision, 2015, 15(6): 4. [2] WAYTOWICH N R, KRUSIENSKI D J. Multiclass Steady-State Visual Evoked Potential Frequency Evaluation Using Chirp-Modulated Stimuli [J]. IEEE Transactions on Human-Machine Systems, 2016, 46(4): 593-600. [3] WAYTOWICH N, LAWHERN V J, GARCIA J O, et al. Compact convolutional neural networks for classification of asynchronous steady-state visual evoked potentials [J]. Journal of neural engineering, 2018, 15(6): 066031. [4] ZHANG R, XU Z, ZHANG L, et al. The effect of stimulus number on the recognition accuracy and information transfer rate of SSVEP-BCI in augmented reality [J]. Journal of Neural Engineering, 2022, 19(3): 036010. [5] WANG Y, GAO X, HONG B, et al. Brain-computer interfaces based on visual evoked potentials - Feasibility of practical system designs [J]. IEEE Engineering in Medicine and Biology Magazine, 2008, 27(5): 64-71. [6] BIN G, GAO X, WANG Y, et al. VEP-Based Brain-Computer Interfaces: Time, Frequency, and Code Modulations [J]. IEEE Computational Intelligence Magazine, 2009, 4(4): 22-6. [7] BIN G, GAO X, YAN Z, et al. An online multi-channel SSVEP-based brain-computer interface using a canonical correlation analysis method [J]. Journal of Neural Engineering, 2009, 6(4): 046002. [8] REZEIKA A, BENDA M, STAWICKI P, et al. Brain-Computer Interface Spellers: A Review [J]. Brain Sciences, 2018, 8(4): 57. [9] CHENG M, GAO X, GAO S, et al. Design and implementation of a brain-computer interface with high transfer rates [J]. IEEE transactions on bio-medical engineering, 2002, 49(10): 1181-6. [10] CHEN X, WANG Y, NAKANISHI M, et al. High-speed spelling with a noninvasive brain-computer interface [J]. Proceedings of the National Academy of Sciences of the United States of America, 2015, 112(44): E6058-E67. [11] MARTISIUS I, DAMASEVICIUS R. A Prototype SSVEP Based Real Time BCI Gaming System [J]. Computational Intelligence and Neuroscience, 2016, 2016(1): 3861425. [12] CHEN S-C, CHEN Y-J, ZAENI I A E, et al. A Single-Channel SSVEP-Based BCI with a Fuzzy Feature Threshold Algorithm in a Maze Game [J]. International Journal of Fuzzy Systems, 2017, 19(2): 553-65. [13] DIEZ P F, TORRES MULLER S M, MUT V A, et al. Commanding a robotic wheelchair with a high-frequency steady-state visual evoked potential based brain-computer interface [J]. Medical Engineering & Physics, 2013, 35(8): 1155-64. [14] GUNEYSU A, AKIN H L. An SSVEP based BCI to control a humanoid robot by using portable EEG device [J]. Annual International Conference of the IEEE Engineering in Medicine and Biology Society IEEE Engineering in Medicine and Biology Society Annual International Conference, 2013, 2013: 6905-8. [15] KAYA M, BINLI M K, OZBAY E, et al. A large electroencephalographic motor imagery dataset for electroencephalographic brain computer interfaces [J]. Scientific Data, 2018, 5(1): 1-16. [16] JIN J, MIAO Y, DALY I, et al. Correlation-based channel selection and regularized feature optimization for MI-based BCI [J]. Neural Networks, 2019, 118: 262-70. [17] JIN J, LIU C, DALY I, et al. Bispectrum-based channel selection for motor imagery based brain-computer interfacing [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2020, 28(10): 2153-63. [18] JIN J, XIAO R, DALY I, et al. Internal feature selection method of CSP based on L1norm and Dempster–Shafer theory [J]. IEEE transactions on neural networks and


参考文献
53
learning systems, 2020, 32(11): 4814-25. [19] JIN J, LI S, DALY I, et al. The study of generic model set for reducing calibration time in P300-based brain–computer interface [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2019, 28(1): 3-12. [20] XIAO X, XU M, JIN J, et al. Discriminative canonical pattern matching for single-trial classification of ERP components [J]. IEEE Transactions on Biomedical Engineering, 2019, 67(8): 2266-75. [21] YU Y, LIU Y, YIN E, et al. An asynchronous hybrid spelling approach based on EEGEOG signals for Chinese character input [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2019, 27(6): 1292-302. [22] MüLLER-PUTZ G R, SCHERER R, BRAUNEIS C, et al. Steady-state visual evoked potential (SSVEP)-based communication: impact of harmonic frequency components [J]. Journal of neural engineering, 2005, 2(4): 123. [23] SHI N, WANG L, CHEN Y, et al. Steady-state visual evoked potential (SSVEP)-based brain–computer interface (BCI) of Chinese speller for a patient with amyotrophic lateral sclerosis: A case report [J]. Journal of Neurorestoratology, 2020, 8(1): 40-52. [24] CHEN Y-J, CHEN P-C, CHEN S-C, et al. Denoising Autoencoder-Based Feature Extraction to Robust SSVEP-Based BCIs [J]. Sensors, 2021, 21(15): 5019. [25] GUO N, WANG X, DUANMU D, et al. SSVEP-based brain computer interface controlled soft robotic glove for post-stroke hand function rehabilitation [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2022, 30: 1737-44. [26] LI L, ZHANG Y, HUANG L, et al. Robot Assisted Treatment of Hand Functional Rehabilitation Based on Visual Motor Imagination [J]. Frontiers in Aging Neuroscience, 2022, 14: 870871. [27] LI Y, PAN J, WANG F, et al. A hybrid BCI system combining P300 and SSVEP and its application to wheelchair control [J]. IEEE Transactions on Biomedical Engineering, 2013, 60(11): 3156-66. [28] MAI X, AI J, JI M, et al. A hybrid BCI combining SSVEP and EOG and its application for continuous wheelchair control [J]. Biomedical Signal Processing and Control, 2024, 88: 105530. [29] LIN Z, ZHANG C, WU W, et al. Frequency recognition based on canonical correlation analysis for SSVEP-based BCIs [J]. IEEE Transactions on Biomedical Engineering, 2007, 54(6): 1172-6. [30] CHEN X, WANG Y, GAO S, et al. Filter bank canonical correlation analysis for implementing a high-speed SSVEP-based brain-computer interface [J]. Journal of Neural Engineering, 2015, 12(4): 046008. [31] NAKANISHI M, WANG Y, CHEN X, et al. Enhancing Detection of SSVEPs for a HighSpeed Brain Speller Using Task-Related Component Analysis [J]. IEEE Transactions on Biomedical Engineering, 2018, 65(1): 104-12. [32] SHELTON D, LONGBOTHAM H. Instantaneous VEP signal frequency analysis [J]. Biomedical sciences instrumentation, 1993, 29: 177-82. [33] CHEN Y, YANG C, CHEN X, et al. A novel training-free recognition method for SSVEP-based BCIs using dynamic window strategy [J]. Journal of Neural Engineering, 2021, 18(3): 036007. [34] ZHANG Y, XU P, CHENG K, et al. Multivariate synchronization index for frequency recognition of SSVEP-based brain-computer interface [J]. Journal of Neuroscience Methods, 2014, 221: 32-40.
[35] 张杨松, 夏敏, 陈科, et al. 稳态视觉诱发电位频率识别算法研究进展 [J]. 生物医学工 程学杂志, 2022, 39(01): 192-7. [36] WONG C M, WAN F, WANG B, et al. Learning across multi-stimulus enhances target recognition methods in SSVEP-based BCIs [J]. Journal of Neural Engineering, 2020, 17(1): 016026. [37] WEI Q, ZHU S, WANG Y, et al. Maximum Signal Fraction Analysis for Enhancing Signal-to-Noise Ratio of EEG Signals in SSVEP-Based BCIs [J]. IEEE Access, 2019, 7: 85452-61. [38] LIU B, CHEN X, SHI N, et al. Improving the Performance of Individually Calibrated SSVEP-BCI by Task- Discriminant Component Analysis [J]. IEEE Transactions on


参考文献
54
Neural Systems and Rehabilitation Engineering, 2021, 29: 1998-2007. [39] ZHANG Y, YIN E, LI F, et al. Two-Stage Frequency Recognition Method Based on Correlated Component Analysis for SSVEP-Based BCI [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2018, 26(7): 1314-23. [40] ZHANG X, YAO L, WANG X, et al. A survey on deep learning-based non-invasive brain signals: recent advances and new frontiers [J]. Journal of Neural Engineering, 2021, 18(3): 031002. [41] KWAK N-S, MUELLER K-R, LEE S-W. A convolutional neural network for steady state visual evoked potential classification under ambulatory environment [J]. Plos One, 2017, 12(2): e0172578. [42] LI Y, XIANG J, KESAVADAS T. Convolutional Correlation Analysis for Enhancing the Performance of SSVEP-Based Brain-Computer Interface [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2020, 28(12): 2681-90. [43] RAVI A, BENI N H, MANUEL J, et al. Comparing user-dependent and user-independent training of CNN for SSVEP BCI [J]. Journal of Neural Engineering, 2020, 17(2): 026028. [44] LAWHERN V J, SOLON A J, WAYTOWICH N R, et al. EEGNet: a compact convolutional neural network for EEG-based brain–computer interfaces [J]. Journal of neural engineering, 2018, 15(5): 056013. [45] GUNEY O B, OBLOKULOV M, OZKAN H. A deep neural network for ssvep-based brain-computer interfaces [J]. IEEE transactions on biomedical engineering, 2021, 69(2): 932-44. [46] PAN Y, CHEN J, ZHANG Y, et al. An efficient CNN-LSTM network with spectral normalization and label smoothing technologies for SSVEP frequency recognition [J]. Journal of neural engineering, 2022, 19(5): 056014. [47] CHEN J, ZHANG Y, PAN Y, et al. A transformer-based deep neural network model for SSVEP classification [J]. Neural Networks, 2023, 164: 521-34. [48] BAGCHI S, BATHULA D R. EEG-ConvTransformer for single-trial EEG-based visual stimulus classification [J]. Pattern Recognition, 2022, 129: 108757. [49] DANG W, LI M, LV D, et al. MHLCNN: Multi-harmonic linkage CNN model for SSVEP and SSMVEP signal classification [J]. IEEE Transactions on Circuits and Systems II: Express Briefs, 2021, 69(1): 244-8. [50] YAO H, LIU K, DENG X, et al. FB-EEGNet: A fusion neural network across multistimulus for SSVEP target detection [J]. Journal of Neuroscience Methods, 2022, 379: 109674. [51] DENG Y, SUN Q, WANG C, et al. TRCA-Net: using TRCA filters to boost the SSVEP classification with convolutional neural network [J]. Journal of Neural Engineering, 2023, 20(4): 046005. [52] LI D, HUANG Y, LUO R, et al. Enhancing detection of SSVEPs using discriminant compacted network [J]. Journal of Neural Engineering, 2025, 22: 016043. [53] DENG Y, JI Z, WANG Y, et al. OS-SSVEP: One-shot SSVEP classification [J]. Neural Networks, 2024, 180: 106734. [54] YANG C, HAN X, WANG Y, et al. A Dynamic Window Recognition Algorithm for SSVEP-Based Brain-Computer Interfaces Using a Spatio-Temporal Equalizer [J]. International Journal of Neural Systems, 2018, 28(10): 1850028. [55] LEE T, NAM S, HYUN D J. Adaptive Window Method Based on FBCCA for Optimal SSVEP Recognition [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2023, 31: 78-86. [56] JIANG J, YIN E, WANG C, et al. Incorporation of dynamic stopping strategy into the high-speed SSVEP-based BCIs [J]. Journal of Neural Engineering, 2018, 15(4): 046025. [57] DA CRUZ J N, WAN F, WONG C M, et al. Adaptive time-window length based on online performance measurement in SSVEP-based BCIs [J]. Neurocomputing, 2015, 149: 93-9. [58] NAKANISHI M, WANG Y, CHEN X, et al. Enhancing detection of SSVEPs for a highspeed brain speller using task-related component analysis [J]. IEEE Transactions on Biomedical Engineering, 2017, 65(1): 104-12. [59] ZHANG Y, GUO D, LI F, et al. Correlated component analysis for enhancing the performance of SSVEP-based brain-computer interface [J]. IEEE Transactions on Neural


参考文献
55
Systems and Rehabilitation Engineering, 2018, 26(5): 948-56. [60] ZHANG Y, YIN E, LI F, et al. Hierarchical feature fusion framework for frequency recognition in SSVEP-based BCIs [J]. Neural Networks, 2019, 119: 1-9. [61] LUO R, XU M, ZHOU X, et al. Data Augmentation of SSVEPs Using Source Aliasing Matrix Estimation for Brain-Computer Interfaces [J]. IEEE Transactions on Biomedical Engineering, 2023, 70(6): 1775-85. [62] MAI X, AI J, WEI Y, et al. Phase-Locked Time-Shift Data Augmentation Method for SSVEP Brain-Computer Interfaces [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2023, 31: 4096-105. [63] WANG Y, CHEN X, GAO X, et al. A Benchmark Dataset for SSVEP-Based BrainComputer Interfaces [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2017, 25(10): 1746-52. [64] LIU B, HUANG X, WANG Y, et al. BETA: A Large Benchmark Database Toward SSVEP-BCI Application [J]. Frontiers in Neuroscience, 2020, 14: 627. [65] SUN Y, LIANG L, LI Y, et al. Dual-Alpha: a large EEG study for dual-frequency SSVEP brain-computer interface [J]. Gigascience, 2024, 13: giae041. [66] LI D, WANG X, DOU M, et al. Multi-Stimulus Least-Squares Transformation With Online Adaptation Scheme to Reduce Calibration Effort for SSVEP-Based BCIs [J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 2024, 32: 160615. [67] WOLPAW J R, BIRBAUMER N, MCFARLAND D J, et al. Brain-computer interfaces for communication and control [J]. Clin Neurophysiol, 2002, 113(6): 767-91. [68] NAN J, ZHANG S, LI D, et al. Innovative combination of covariance analysis-based sliding time window and task-related component analysis for steady-state visual evoked potential recognition [J]. Cluster Computing, 2024, 27(7): 10125-39. [69] YUAN P, CHEN X, WANG Y, et al. Enhancing performances of SSVEP-based braincomputer interfaces via exploiting inter-subject information [J]. Journal of neural engineering, 2015, 12(4): 046006. [70] PAN S J, YANG Q. A Survey on Transfer Learning [J]. IEEE Transactions on Knowledge and Data Engineering, 2010, 22(10): 1345-59. [71] CHIANG K-J, WEI C-S, NAKANISHI M, et al. Boosting template-based SSVEP decoding by cross-domain transfer learning [J]. Journal of Neural Engineering, 2021, 18(1): 016002. [72] DE LA TORRE F. A Least-Squares Framework for Component Analysis [J]. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2012, 34(6): 1041-55. [73] WONG C M, WANG B, WANG Z, et al. Spatial Filtering in SSVEP-Based BCIs: Unified Framework and New Improvements [J]. IEEE Transactions on Biomedical Engineering, 2020, 67(11): 3057-72.