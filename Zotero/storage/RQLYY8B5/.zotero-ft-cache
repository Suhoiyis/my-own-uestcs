博士学位论文
(学术学位)
基于深度学习的嗅觉、味觉与联觉脑电数据识别
方法研究
RESEARCH ON DEEP LEARNING-BASED DATA
RECOGNITION METHODS FOR OLFACTORY, TASTE,
AND SYNESTHESIA EEG SIGNALS
夏秀鑫
2025 年 5 月


中图分类号:TH89 学校代码:10188
UDC:004.8 密级:公开
基于深度学习的嗅觉、味觉与联觉脑电数据识别
方法研究
博 士 研 究 生:夏秀鑫
导 师:门洪教授
学 位 类 别:工学博士
学 科 专 业:控制科学与工程
所 在 单 位:自动化工程学院
答 辩 日 期:2025 年 5 月
授 予 学 位 单 位:东北电力大学


Classified Index: TH89
U.D.C: 004.8
RESEARCH ON DEEP LEARNING-BASED DATA
RECOGNITION METHODS FOR OLFACTORY, TASTE,
AND SYNESTHESIA EEG SIGNALS
Candidate: Xiuxin Xia
Supervisor: Prof. Hong Men
Academic Degree Applied for: Doctor of Engineering
Speciality: Control Science and Engineering
Affiliation: School of Automation Engineering
Date of Defence: May, 2025
Degree-ConferringInstitution: Northeast Electric Power University


摘要
I
摘要
嗅觉、味觉以及嗅-味联觉脑电研究对于工程应用和学术研究而言有着不可忽视的意义。
在工程应用范畴内,脑电技术可在感官评价方面给予食品、化妆品等行业精准的技术支持,
推动个性化产品的开发以及质量控制工作,以此契合消费者对于多感官体验的需求。在学
术研究领域,揭示嗅觉、味觉以及嗅-味联觉感知的神经机制有利于更深入地理解大脑对多
感官信息的整合方式,推动神经科学与认知科学不断向前发展。然而当前的研究面临着不
少挑战,例如特征挖掘不够充分、跨被试者识别存在障碍、数据比较稀缺、电极存在冗余、
多感官解码面临困难等情况,这些问题极大限制了脑电技术的发展。为了克服这些挑战,
本研究依靠深度学习技术,提出了一系列创新的方法,切实提高了脑电信号解码的精准度
与稳定性,并且指出多感官感知的神经机制,为食品感官评价与神经科学研究提供了技术
方面的支持以及理论上的指导。具体的工作内容如下:
(1)嗅觉脑电信号特征挖掘存在不足,为此提出一种频段注意力网络模型,此模型引
入频段特征挖掘模块以及自注意力机制,可高效捕捉整合多频段嗅觉脑电信号的深层次特
征,有效提升气味分类的准确性与稳定性。实验结果显示,该模型在嗅觉脑电数据集上的
分类性能比现有先进方法更优,准确率达 98.92%,F1 分数为 98.75%,呈现出良好的性能
优势。消融实验验证了模型中关键模块的有效性,多头注意力机制在提高模型表现以及挖
掘频段间特征关系方面发挥了关键作用,该模型为嗅觉脑电分析提供了新的技术路径,也
为未来多频段脑电特征研究的发展奠定了基础。
(2)为突破跨被试者嗅觉偏好识别方面的限制,本研究构思出一种基于嗅觉脑电和电
子鼻信号的多模态脑-机协同感知方法,该方法将电子鼻在气味物理化学特性呈现方面的长
处与脑电信号对情感偏好表达的优势相结合,有效克服了单一信号在跨被试识别任务中的
不足,实验所得结果显示,所提出来的多模态协同感知方法在跨被试者嗅觉偏好识别任务
中的分类准确率以及 F1 分数分别是 92.79%和 92.64%,优于当下主流的多模态数据识别方
法,有助于推动嗅觉偏好评估领域的技术发展,还为未来多模态感官分析研究开拓了新的
思考方向。
(3)本研究针对味觉脑电数据量匮乏的难题,提出了时空重构数据增强方法,此方法
通过提高原始数据在时空维度的特征,丰富了味觉脑电特征的多样性,同时结合多视角通
道注意力机制,对味觉脑电中的冗余信息进行精细化处理,有效提升了数据质量与模型的
泛化能力。实验结果显示,采用该数据增强方法后,模型的分类准确性从 98.10%提升至


东北电力大学工学博士学位论文
II
99.56%,F1 分数从 98.09%提升至 99.48%,比其他先进方法更优。该方法能有效提升模型
对味觉脑电的解码性能,成功达成对酸、甜、苦、咸四种基本味道的精确解码,在解决味
觉脑电数据不足问题之际,也为复杂味觉感知研究与分析给予了坚实的技术支撑。
(4)在关于味觉脑电信号的电极选择研究工作中,本研究提出了一种基于注意力的类
激活映射方法,此方法将梯度加权类激活映射技术与通道-空间注意力卷积神经网络相结合,
凭借精确定位与味觉有关的关键电极区域,可自动选择影响味觉信号识别的关键电极,切
实降低了非关键电极的计算权重,使得整体计算的复杂度有所减少。实验得出的结果显示,
当运用所提出的电极选择策略将电极数量精简到 12 个时,计算量降低了 41.18%,模型的
准确率以及 F1 分数分别是 97.55%和 97.52%,和使用全部电极时相比,准确率和 F1 分数
仅分别降低了 0.44%和 0.43%。该方法能有效选择关键电极,又能在极大降低计算复杂度
的情况下维持模型出色的分类性能,为味觉脑电信号分析给予了一种兼具精准性与高效性
的解决方法。
(5)一种基于局部-全局融合的网络模型被提出,该模型着重于嗅-味联觉脑电解码,
以实现对气味增强甜味感知的定量分析。此模型通过整合局部特征的细粒度表征能力和全
局特征的整体感知能力,精确捕获风味所引发的复杂脑电信号变化,在甜味感知量化任务
中呈现出良好性能。实验结果显示,该模型的 R2 分数达到 0.911,其预测的感官甜度和实
际感官甜度之间存在很高的相关性,证实了模型在精准预测方面的优势。该模型在误差控
制方面也表现出色,均方误差是 0.027,平均绝对误差为 0.063,都低于其他先进模型,突
出了其在减少预测误差方面的良好能力,与现有方法相比,该模型在多感官解码任务中的
表现更优,有效提升了甜味感知的量化精度,还为嗅觉与味觉协同作用的机制研究提供了
新的视角和理论支撑。
本研究运用深度学习技术,成功解决了嗅觉、味觉以及嗅-味联觉脑电信号分析过程中
的关键问题,使得信号解码的精度与稳定性得以提升,所提出的创新方法包含多频段特征
挖掘、脑-机协同感知、时空数据增强、精细化电极选择以及多感官解码等方面,拓展了嗅
觉、味觉与嗅-味联觉脑电信号分析的技术范围,为多感官感知研究提供了新的方法支持,
也为食品感官评价和神经科学应用奠定了关键基础。
关键词:嗅觉脑电;味觉脑电;联觉脑电;多频段特征;数据增强;跨被试者识别


Abstract
III
Abstract
The electroencephalogram (EEG) research on olfactory, taste and olfactory-taste synesthesia
has an important significance for engineering applications and academic research. In the scope of
engineering applications, EEG technology can provide accurate sensory evaluation support for
industries such as food and cosmetics, promote the development of personalized products and
quality control, so as to meet consumers' demand for multi-sensory experience. In the field of
academic research, revealing the neural mechanisms of olfactory, taste and synesthesia perception
is conducive to a deeper understanding of how the brain integrates multi-sensory information and
promotes the continuous development of neuroscience and cognitive science. However, current
research faces many challenges, such as insufficient feature mining, obstacles to cross-subject
recognition, scarce data, redundancy of electrodes, and difficulties in multi-sensory decoding.
These problems greatly limit the development of EEG technology. In order to overcome these
challenges, this study relies on deep learning technology and proposes a series of innovative
methods to effectively improve the accuracy and stability of EEG signal decoding, and points out
the neural mechanism of multi-sensory perception, providing technical support and theoretical
guidance for food sensory evaluation and neuroscience research. The specific work contents are
as follows:
(1)There are deficiencies in the feature mining of olfactory EEG signals. For this reason,
a frequency band attention network model is proposed. This model introduces a frequency band
feature mining module and a self-attention mechanism, which can efficiently capture and integrate
the deep-level features of multi-band olfactory EEG signals and effectively improve the accuracy
and stability of odor classification. The experimental results show that the classification
performance of this model on the olfactory EEG dataset is better than that of the existing advanced
methods, with an accuracy of 98.92% and an F1 score of 98.75%, showing a good performance
advantage. The ablation experiment verifies the effectiveness of the key modules in the model.
The multi-head attention mechanism plays a key role in improving the performance of the model
and mining the feature relationship between frequency bands. The model provides a new technical
path for olfactory EEG analysis and lays the foundation for the development of multi-band EEG
feature research in the future.
( 2 ) In order to break through the limitations of cross-subject olfactory preference


东北电力大学工学博士学位论文
IV
recognition, this study conceived a multimodal brain-computer collaborative perception method
that combines olfactory EEG and electronic nose signals. By integrating the advantages of
electronic noses in presenting the physical and chemical characteristics of odors and the ability of
EEG signals to express emotional preferences, this method effectively overcomes the
shortcomings of a single signal method in cross-subject scenarios. The experimental results show
that the classification accuracy and F1 score of the proposed multimodal collaborative method in
the cross-subject olfactory preference recognition task are 92.79% and 92.64%, respectively,
which are better than the current mainstream multimodal data recognition methods. It helps to
promote the technological development in the field of olfactory preference assessment and also
opens up new thinking directions for future multimodal sensory analysis research.
(3)In response to the problem of insufficient taste EEG data, this study proposed a
spatiotemporal reconstruction data augmentation method. This method enriches the diversity of
taste EEG features by improving the characteristics of the original data in the spatiotemporal
dimension. At the same time, combined with the multi-view channel attention mechanism, it
refines the redundant information in the data and effectively improves the data quality and the
generalization ability of the model. The experimental results show that after adopting this data
augmentation method, the classification accuracy of the model increased from 98.10% to 99.56%,
and the F1 score increased from 98.09% to 99.48%, which is better than other advanced methods.
This method can effectively improve the model's decoding performance of taste EEG, and
successfully achieve accurate decoding of the four basic tastes of sour, sweet, bitter and salty.
While solving the problem of insufficient taste EEG data, it also provides solid technical support
for the research and analysis of complex taste.
(4)In the research work on electrode selection of taste EEG signals, this study introduced
an attention-based class activation mapping method. This method combines the gradient-weighted
class activation mapping technology with the channel-space attention convolutional neural
network. By accurately locating the key electrode areas related to taste, it selects the electrodes
that are critical to taste signal recognition, effectively reducing the calculation weight of non
critical electrodes, and reducing the complexity of the overall calculation. The experimental results
show that when the number of electrodes is reduced to 12 using the proposed electrode selection
strategy, floating point operations is reduced by 41.18%, and the model's accuracy and F1 score
are 97.55% and 97.52% respectively. Compared with the case of using all electrodes, the accuracy
and F1 score are only reduced by 0.44% and 0.43% respectively. This method can effectively select
key electrodes and maintain excellent classification performance while greatly reducing


Abstract
V
computational complexity, providing a solution that combines accuracy and efficiency for taste
EEG signal analysis.
(5)A network model based on local-global fusion is proposed. The model focuses on
olfactory-taste synesthesia decoding and quantitative analysis of odor enhancement sweetness
perception. This model accurately captures the complex EEG signal changes caused by odor by
integrating the fine-grained representation ability of local features and the overall perception
ability of global features. It shows good performance in the sweetness perception quantification
task. The experimental results show that the R2 score of the model reaches 0.911, and there is a
high correlation between the predicted sensory sweetness and the actual sensory sweetness, which
confirms the model's advantage in accurate prediction. The model also performed well in error
control, with a mean square error of 0.027 and a mean absolute error of 0.063, both lower than
other advanced models, highlighting its good ability to reduce prediction errors. Compared with
existing methods, the model performs better in multisensory decoding tasks, effectively improving
the quantification accuracy of sweetness perception, and also providing a new perspective and
theoretical support for the study of the mechanism of synergy between olfactory and taste.
This study used deep learning technology to successfully solve the key problems in the
analysis of olfactory, taste and olfactory-taste synesthesia EEG signals, so that the accuracy and
stability of signal decoding can be improved. The proposed innovative methods include multi
band feature mining, brain-machine collaborative perception, spatiotemporal data augmentation,
refined electrode selection and multisensory decoding, which expands the technical scope of
olfactory, taste and olfactory-taste synesthesia EEG signal analysis, provides new method support
for multisensory perception research, and lays a key foundation for food sensory evaluation and
neuroscience applications.
Keywords: Olfactory EEG; Taste EEG; Synesthesia EEG; Multi-Frequency Features;
Data Augmentation; Cross-Subject Recognition


缩略词表
VI
缩略词表
英文缩写 英文全称 中文全称
AFBD Average Frequency Band Division 平均频段划分 ApEn Approximate Entropy 近似熵 BCI Brain-Computer Interface 脑-机接口 BMFNet Brain-Machine Fusion Network 脑-机融合网络 BMFNet-S Brain-Machine Fusion Student Network 脑-机融合学生网络 BMFNet-T Brain-Machine Fusion Teacher Network 脑-机融合教师网络 BN BatchNorm 批量归一化 CAM Channel Attention Module 通道注意模块 CNN Convolutional Neural Network 卷积神经网络 CSP Common Spatial Pattern 公共空间模式 DBW Daubechies Wavelet 多贝西小波 Dropout Dropout Regularization 随机失活正则化 DWT Discrete Wavelet Transform 离散小波变换 ECA Efficient Channel Attention 高效通道注意力 ECG Electrocardiogram 心电图 EEG Electroencephalogram 脑电图 EEG-LGFNet Local and Global Fusion Network 局部-全局融合网络 EFM EEG Feature Mining 脑电特征挖掘 Emb Embedding 嵌入 EMG Electromyogram 肌电图 ERP Event Related Potential 事件相关电位 FBANet Frequency Band Attention Network 频段注意力网络 FBFM Frequency Band Feature Mining 频段特征挖掘 FBFSelfA Frequency Band Feature Self-Attention 频段特征自注意力 FC Fully Connected 全连接 FFT Fast Fourier Transform 快速傅里叶变换 FIR Finite Impulse Response 有限脉冲响应 FLOPs Floating Point Operations 计算量 FMA Feature Mining and Alignment 特征挖掘与对齐 fMRI Functional Magnetic Resonance Imaging 功能性磁共振成像 fNIRS Functional Near-Infrared Spectroscopy 功能近红外光谱 GeLU Gaussian Error Linear Unit 高斯误差线性单元 Grad-CAM Gradient-weighted Class Activation Mapping 梯度加权类激活映射 Lasso Least Absolute Shrinkage and Selection Operator 最小绝对收缩和选择算子 LDA Linear Discriminant Analysis 线性判别分析 LGFTB Local Global Fusion Transformer Block 局部-全局融合自注意力模块 LN LayerNorm 层归一化 LSTM Long Short Term Memory 长短时记忆网络 MAE Mean Absolute Error 平均绝对误差


东北电力大学工学博士学位论文
VII
接上表
MFI Multimodal Feature Interaction 多模态特征交互 MFF Multimodal Feature Fusion 多模态特征融合 MHA Multi-Head Attention 多头注意力 MI Mutual Information 互信息 MLP Multilayer Perceptron 多层感知器 MSAC Multiscale attention convolution 多尺度注意力卷积 MSE Mean Squared Error 均方误差 M2NN Multimodal Multitask Neural Network 多模态多任务神经网络 MVCA Multi-view Channel Attention 多视角通道注意力 Params Parameters 参数量 PCA Principal Components Analysis 主成分分析 PSD Power Spectrum Density 功率谱密度 RNN Recursive Neural Network 递归神经网络 SAM Spatial Attention Module 空间注意模块 SelfAM Self-Attention Mechanism 自注意力机制 SENet Squeeze-and-Excitation Network 压缩和激励网络 SVM Support Vector Machine 支持向量机 t-SNE T-distributed Stochastic Neighbor Embedding T-分布随机邻域嵌入 TSRDA Temporal-Spatial Reconstruction Data Augment 时空重构数据增强


目录
第 1 章 绪论...............................................................................................1
1.1 研究背景与意义...............................................................................1
1.2 国内外研究现状...............................................................................3
1.2.1 嗅觉脑电研究现状.....................................................................3
1.2.2 味觉脑电研究现状.....................................................................7
1.2.3 嗅-味联觉脑电研究现状 .........................................................10
1.2.4 国内外文献简析.......................................................................11
1.3 研究内容及技术路线.....................................................................14
1.3.1 研究内容...................................................................................14
1.3.2 技术路线...................................................................................15 第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法 ................17
2.1 引言.................................................................................................17
2.2 嗅觉脑电数据集构建.....................................................................18
2.2.1 实验平台...................................................................................18
2.2.2 被试者与实验材料...................................................................19
2.2.3 数据采集与预处理...................................................................20
2.3 基于注意力机制的多频段特征挖掘方法 ....................................21
2.3.1 方法框架...................................................................................21
2.3.2 FBFM 模块 ................................................................................22
2.3.3 FBFSelfA 模块 .........................................................................24
2.4 实验结果与分析.............................................................................27
2.4.1 模型设置与评价指标...............................................................27
2.4.2 单频段分析...............................................................................27
2.4.3 多频段分析...............................................................................28
2.4.4 消融实验...................................................................................31
2.5 本章小结.........................................................................................32 第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
.................................................................................................................33
3.1 引言.................................................................................................33
3.2 多模态数据集构建.........................................................................34
3.2.1 实验平台...................................................................................34
3.2.2 被试者与实验材料...................................................................36
3.2.3 数据采集与预处理...................................................................37
3.3 多模态协同学习方法.....................................................................38


3.3.1 方法框架...................................................................................38
3.3.2 特征挖掘和对齐.......................................................................39
3.3.3 共性和个性特征挖掘...............................................................39
3.3.4 多模态特征融合.......................................................................41
3.3.5 多模态知识蒸馏.......................................................................42
3.4 实验结果与分析.............................................................................46
3.4.1 模型设置与评价指标...............................................................46
3.4.2 多模态知识蒸馏.......................................................................46
3.4.3 单模态分析...............................................................................46
3.4.4 多模态分析...............................................................................48
3.4.5 消融实验...................................................................................49
3.4.6 特征通道可视化.......................................................................51
3.5 本章小结.........................................................................................52 第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络
的味道识别方法 .....................................................................................53
4.1 引言.................................................................................................53
4.2 味觉脑电数据集构建.....................................................................54
4.2.1 被试者与实验材料...................................................................54
4.2.2 数据采集与预处理...................................................................55
4.3 基于时空重构的味觉脑电数据增强方法 ....................................57
4.4 基于多尺度通道注意力的味觉脑电识别框架 ............................59
4.4.1 模型框架...................................................................................59
4.4.2 多尺度通道注意力...................................................................61
4.5 实验结果与分析.............................................................................62
4.5.1 味觉脑电地形图.......................................................................62
4.5.2 模型设置与评价指标...............................................................63
4.5.3 数据增强方法有效性分析.......................................................63
4.5.4 与先进模型的比较...................................................................63
4.5.5 消融实验...................................................................................65
4.5.6 可视化分析...............................................................................68
4.6 本章小结.........................................................................................69 第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网
络的味道识别方法 .................................................................................71
5.1 引言.................................................................................................71
5.2 味觉脑电数据集.............................................................................72
5.3 基于 Grad-CAM 的味觉脑电电极选择与识别方法..................72
5.3.1 方法框架...................................................................................72
5.3.2 Grad-CAM 算法 .......................................................................73


5.3.3 通道和空间注意力机制...........................................................75
5.3.4 CNN-CSA 模型 ........................................................................76
5.4 实验结果与分析.............................................................................77
5.4.1 模型设置与评价.......................................................................77
5.4.2 味觉脑电电极选择...................................................................77
5.4.3 味觉脑电识别...........................................................................78
5.4.4 不同味觉刺激下脑区分布.......................................................81
5.5 本章小结.........................................................................................82 第 6 章 联觉脑电:基于局部-全局融合网络的风味甜度量化方法...83
6.1 引言.................................................................................................83
6.2 嗅-味联觉实验设计与数据采集 ...................................................84
6.2.1 被试者与实验材料...................................................................84
6.2.2 感官训练...................................................................................85
6.2.3 数据采集与预处理...................................................................86
6.3 气味增甜感官甜度量化模型 ........................................................87
6.3.1 模型框架...................................................................................87
6.3.2 EEG 嵌入 ...................................................................................87
6.3.3 局部和全局注意力机制...........................................................87
6.3.4 EEG 局部和全局特征融合模块...............................................89
6.4 实验结果与分析.............................................................................90
6.4.1 基于人工感官的气味增甜分析...............................................90
6.4.2 模型设置与评价.......................................................................91
6.4.3 气味增甜的 EEG 时空动态特性.............................................91
6.4.4 感官甜度量化结果...................................................................93
6.5 本章小结.........................................................................................95
第 7 章 总结与展望 ................................................................................97
7.1 总结.................................................................................................97
7.2 展望.................................................................................................98
参考文献.................................................................................................100


第 1 章 绪论
1
第 1 章 绪论
1.1 研究背景与意义
嗅觉和味觉属于人类生活中非常关键的感知系统,该系统通过复杂的生理以及神经机
制来协助个体辨别和感知外界环境[1, 2]。嗅觉系统依靠气味分子同鼻腔中的嗅觉感受器细
胞相互作用,这些感受器细胞将化学信息转变成神经信号,接着依次传至嗅球与嗅觉皮层
[3]。此过程不仅涉及大脑的初级感知区域,还跟情绪以及记忆相关脑区紧密相连,使得嗅
觉在调节行为、情绪以及记忆方面起到关键作用[4, 5]。比如某些气味可直接激活杏仁核,引
发情绪反应并强化记忆的形成,另外嗅觉和内分泌系统的关联也被广泛研究,这种关联解
释了气味在非言语交流以及社会行为中的作用[6]。味觉系统和嗅觉相互配合,依靠口腔中
的味蕾细胞检测五种主要味觉,味觉信号被味觉感受细胞捕获,再经由神经通路传至大脑
的味觉皮层,并在脑干、丘脑等多种结构中整合[7, 8]。在实际感知中,嗅觉和味觉大多时候
协同发挥作用,形成嗅-味联觉反应,比如在人类的饮食体验中,二者结合构成复合感知,
让个体可更全面地识别和评估食品风味。研究显示,嗅觉凭借嗅觉皮层与味觉皮层的交互
作用增强味觉感知,提升味觉体验的丰富程度[9]。该联觉机制不光在食品科学与感官评价
领域有关键应用价值,还为多感官整合的神经机制研究提供了理论依据。然而嗅觉和味觉
的具体神经机制尚未完全被揭示,其复杂的感知过程仍有待深入剖析[10]。深入剖析嗅觉和
味觉的神经机制能增进我们对单一感官及其交互机制的理解,还可以推动脑科学、神经工
程以及多感官感知系统的研究与应用,为脑-机接口(Brain-Computer Interface,BCI)等技
术的优化提供关键的理论支撑和技术基础。
脑电图(Electroencephalogram,EEG)属于一种有高时间分辨率的非侵入性技术,通
过该技术可实时捕捉大脑针对外部刺激所产生的神经反应[11–13]。在嗅觉以及味觉研究领域,
运用多电极通道来采集脑电信号可以全方位地揭示感知过程中的空间分布情况以及时间
动态特性[14,15]。传统的脑电分析方法主要是依靠时域和频域的信号处理技术,像事件相关
电位(Event Related Potential,ERP)这种分析方式用于提取特定事件的时间特性[16],快速
傅里叶变换(Fast Fourier Transform,FFT)和小波变换等频域方法用于识别主要频段的特
征[17]。尽管这些方法在处理静态或者周期性信号的时候表现不错,然而对于嗅觉和味觉脑
电这种复杂、微弱并且呈现动态变化的信号而言,它们的解析能力存在一定的局限性。传
统的脑电分类与识别方法主要依靠线性模型,比如线性判别分析(Linear Discriminant
Analysis,LDA)[18]、支持向量机(Support Vector Machine,SVM)[19]。虽然这些方法在处


东北电力大学工学博士学位论文
2
理低维数据时比较有效,但是在面对高维特性的脑电信号、高噪声环境以及跨被试者和跨
模态应用时,它们的泛化能力明显不足。为了应对这些问题,深度学习技术逐渐变成脑电
分析的关键工具,它的自动化特征提取能力可挖掘脑电中复杂的神经模式,为解析嗅觉与
味觉脑电给予了强有力的支持[20,21]。
深度学习技术包含基于卷积的空间特征提取、基于递归的时序建模,以及结合注意力
机制的拓展模型等[22,23]。在空间特征提取领域,卷积神经网络(Convolutional Neural Network,
CNN)通过层级卷积提取 EEG 局部特征,同时保持特征的时空依赖性[24,25],在捕捉多通道
空间模式上表现优异。在时序建模方面,递归神经网络(Recursive Neural Network,RNN),
长短时记忆网络(Long Short Term Memory,LSTM),依靠对序列数据的敏感性,可有效
刻画嗅觉和味觉脑电中的动态响应特征,在捕捉信号的时间模式方面表现出色[26]。随着研
究发展,深度学习渐渐与脑电信号的多频段和多模态特性相结合,提升了对信号的解码效
果。比如基于多频段特征整合的模型可以同时分析脑电信号的不同频率成分,提高跨频段
解码能力[27]。注意力机制因其动态加权特征的能力,成为近年来的一个研究热点,依靠强
化关键信号的识别并抑制噪声干扰,注意力机制有效提升了模型的可靠性和稳定性[28,29]。
另外深度学习技术在多模态融合分析中的应用逐渐受到重视,多模态融合网络可对嗅觉和
味觉脑电的多通道数据进行联合建模,从中提取跨模态的复杂特征,为解析嗅-味联觉机制
提供了有力工具[30,31]。相较于传统方法,深度学习技术在嗅觉和味觉脑电的复杂模式提取、
多模态融合与跨被试者泛化能力方面呈现出突出优势,为 BCI 应用以及多感官感知机制的
解析开辟了新途径。
近年来,虽然嗅觉、味觉以及嗅-味联觉脑电研究有了一些进展,可依然有着不少急需
解决的问题,首先,鉴于气味的复杂程度以及嗅觉脑电的多频段特性,当前针对嗅觉脑电
多频段信息的挖掘并不够充分,跨被试者之间存在的差异,也让构建有普遍适用性的识别
模型变成了重要难题。其次,因为味觉脑电实验操作繁杂、耗费时间较长,致使实验数据
获取成本较高,数据量不足,这限制了识别模型的泛化能力,还让冗余电极的干扰问题变
得更加突出,给味觉脑电的准确解码带来了巨大挑战。此外,现有研究在揭示嗅觉与味觉
信号的复杂交互规律上存在欠缺,严重限制了对嗅-味联觉神经机制的深入认识,极大地增
加了嗅-味联觉脑电的多感官解码难度。
针对上述关键问题,本研究依靠深度学习技术对嗅觉、味觉以及嗅-味联觉脑电信号展
开针对性探索与优化,因嗅觉脑电特征挖掘存在不足,故而设计多频段信息提取与分析方
法,更充分捕获嗅觉脑电多频段特性,同时提出针对跨被试者的特征对齐策略,有效减少
个体差异对模型泛化能力的影响。鉴于味觉脑电数据稀缺带来挑战,开发数据增强技术,
缓解实验数据获取不足的限制,并且依靠优化电极选择策略,降低冗余电极对信号解码的
干扰。针对嗅-味联觉脑电多感官解码的挑战,构建融合嗅觉与味觉脑电的特征表示与解码


第 1 章 绪论
3
框架,深入挖掘其复杂交互规律,研究成果有效提高了嗅-味联觉脑电的解码精度以及模型
的泛化能力,为嗅-味联觉神经机制的解析以及多感官智能感知技术的未来发展奠定理论与
技术基础。
1.2 国内外研究现状
1.2.1 嗅觉脑电研究现状
嗅觉脑电研究属于脑科学与嗅觉感知科学相互交叉的领域范畴,其主要研究对复杂嗅
觉脑电信号的识别与分类,传统方法和深度学习方法在这一领域都有着一定的影响,不过
也都分别面临着相应的挑战,为了全方位梳理嗅觉脑电处理方面的研究现状以及发展趋势,
接下来会从传统方法、深度学习方法、深度学习的拓展方法以及多模态方法这四个方面来
展开相关探讨,着重分析它们在嗅觉脑电研究中的具体应用特点、技术方面的优势以及目
前存在的局限之处,从而全面分析嗅觉脑电研究的发展现状,以此为未来的研究提供相应
的思路以及方向。
(1)传统方法
传统的嗅觉脑电研究通常运用特征提取联合机器学习分类器的方法,先提取脑电信号
在时域以及频域的特征,接着通过分类器来识别气味或者嗅觉偏好[32,33]。这类方法依靠人
工设计的特征提取流程,目的在于找出不同气味刺激所引发的脑电信号特征差异,研究一
般包括信号预处理、特征提取以及分类器构建这三个主要步骤。在时域特征方面,功率谱
密度(Power Spectrum Density,PSD)是较为常用的特征之一,比如 Hou 等人[34]依据 PSD
构建了嗅觉脑电的三角矩阵,通过对比测试样本和已知样本的三角矩阵相似性,达成气味
类别的识别,这种方法切实提升了嗅觉脑电的分类性能。另外 Hou 等人[35]针对不同气味浓
度所诱发的嗅觉偏好识别问题,采用 PSD 特征结合 SVM 分类器的方法,成功完成了嗅觉
脑电的分类。在频域特征方面,基于频段分析的方法在嗅觉脑电研究中同样应用广泛,不
同频段可体现脑电活动的特定特征,可揭示个体对气味刺激的反应,例如 Xia 等人[36]按照
生理节律将嗅觉脑电分成 δ(0.5–4 Hz)、θ(4–8 Hz)、α(8–13 Hz)、β(13–30 Hz)和
γ(30–50 Hz)五个频段,利用互信息(Mutual Information,MI)构建大脑功能网络,从中
提取网络属性并输入 SVM 分类器,最终实现气味和嗅觉偏好的识别。另外 Klemm 等人[37]
发现薰衣草、柠檬和薄荷等气味刺激会提高 θ 频段活动。Masago 等人[38]指出,嗅闻薰衣
草、丁香酚和洋甘菊等精油会改变 α 频段脑电活动,这和“舒适感”等主观评价因子关系紧
密,说明该频段在气味偏好中或许发挥关键作用。Aydemir 等人[39]的研究显示,γ 频段与嗅
觉相关活动关联度高。


东北电力大学工学博士学位论文
4
然而传统方法往往只是运用单一频段或者原始信号,很难全面整合多频段的信息,存
在较大的局限性。为解决该问题,有些研究者着手探索多频段分析方法,尝试依靠多频段
特征融合来深入挖掘嗅觉脑电,比如 Hou 等人[40]提出一种基于 SVM 以及平均频段划分
(Average Frequency Band Division,AFBD)的嗅觉情绪识别方法,AFBD 通过等频宽计算
脑电信号的 PSD 特征,然后通过 SVM 将情绪分成愉快和厌恶两种,上述方法为嗅觉脑电
数据分析给予了新视角。脑电信号的非线性和混沌属性也受到广泛关注,Ezzatdoost 等人
[41]提取了嗅觉脑电的非线性和混沌特征,通过 LDA 分类器实现了四种气味的分类,同样
Aydemir 等人[42]运用 k 近邻算法对脑电信号的自回归模型参数特征进行分类,顺利完成了
气味识别。传统嗅觉脑电研究凭借其简单高效以及对特征生理意义较好的解释性,为气味
偏好识别奠定了关键基础。不过这些方法过度依赖手工特征设计,难以全面整合多频段信
息,而且在跨被试者识别方面存在局限,这些问题在一定程度上限制了嗅觉脑电的推广和
应用。
(2)深度学习方法
近年来,深度学习技术取得了快速发展,CNN 凭借端到端学习的优势以及强大的特征
提取能力,在嗅觉脑电分析中渐渐取代了传统方法,成为主流技术之一。RNN 及其改进模
型比如 LSTM,在嗅觉脑电处理方面也呈现出很大潜力,在捕捉时序信息和动态特征方面
表现优异。和传统方法相比,这些深度学习模型能融合时域和频域特征,达成更精准的气
味识别和嗅觉偏好分析,推动了嗅觉脑电研究的发展。在 CNN 的相关研究中,De 等人[43]
提出的 AromaNet 模型,通过在 CNN 架构中引入注意力机制,实现了对玫瑰水和肉桂等五
种不同气味的高精度分类。Sun 等人[44]设计了一种基于频段特征提取的 CNN 模型,运用
滑窗技术优化了对特定频段的选择,有效提升了嗅觉脑电分类稳定性。在 RNN 及其变种
的相关研究中,Tong 等人[14]提出的 TASA 模型采用 LSTM 结合多头注意力(Multi-Head
Attention,MHA),学习脑电信号在时段间的相互关系,捕捉嗅觉脑电的时序特性,有效
实现了嗅觉情绪识别。Xing 等人[45]设计了一种结合 CNN 和双向 LSTM 的模型,有效提取
了脑电的空间、频率和时间特征,将脑电信号转化为四维表示,有效提高了情绪识别的准
确率。
CNN 等深度学习技术在多频段嗅觉脑电数据识别方面展现出巨大潜力,不同频段信号
承载各自独特信息,像低频信号往往反映大脑基本活动模式,高频信号可能与特定感官反
应紧密相关,多频段数据识别能揭示气味刺激对大脑的影响,整合不同频段信息可提升分
类性能,特别在复杂脑电信号分析中。比如 Prasanth 等人[46]等人提出一维水平卷积滤波器
以提取多频段特征,提高模型对频域特征捕捉能力。Yu 等人[47]构建包含空间和时间卷积
核的组合网络结构,将不同频段提取的特征串联输入全连接(Fully Connected,FC)层,
提升模型对嗅觉脑电多频特征解码能力。上述研究表明,多频段卷积网络在提高频域信息


第 1 章 绪论
5
的利用上具有显著优势,为嗅觉脑电频域特征挖掘提供新思路,可揭示嗅觉脑电数据的潜
在信息。
(3)深度学习的拓展方法
虽然 CNN 以及 LSTM 在嗅觉脑电分析中有了不小进步,然而它们还是存在过拟合问
题,同时跨被试者识别效果不佳。为处理这些难题,研究者引入注意力机制等技术来提高
模型性能,持续优化网络架构[48,49]。例如 Xia 等人[50]设计了基于多尺度通道注意力机制的
模型,通过引入多尺度卷积和通道注意力,可有效捕获每个频段中不一样尺度的特征,使
得频段特征分析的精度得以提高。De 等人[43]设计的 AromaNet 采用了基于注意力机制的一
维 CNN,通过强化网络对不同时间以及空间特征的关注,自动聚焦在关键的嗅觉刺激信号
上,有效提高分类精度。Tong 等人[14]提出的时间注意力与空间自编码器网络模型结合了时
间注意力,依靠注意力机制帮助网络关注脑电信号中的时间动态特征,该模型提高了嗅觉
情绪识别的准确率,证明了注意力机制的有效性,并且该方法可在解释性分析中呈现与嗅
觉相关的空间-光谱特征。
现有的基于深度学习的多频段嗅觉脑电分析方法存在一些不足,一方面,像 CNN 这
类模型在整合多频段特征时,主要依靠固定的感受野以及局部特征提取,很难充分捕捉跨
频段的全局关联性。另一方面,这些模型在面对频段间潜在的协同关系时,缺少灵活性与
适应性,致使频域信息融合能力受限,影响了嗅觉脑电分类的整体性能。怎样在深度学习
框架下达成对多频段信号的有效整合,成为当前研究急需解决的关键问题,这关乎现有模
型性能的提高,也可为更复杂的感官信号分析提供了理论和技术方面的支持。在该背景下,
自注意力机制(Self-Attention Mechanism,SelfAM)的引入为解决该问题提供了新的方向
[51]。SelfAM 可捕捉特征内部以及特征之间的全局关联性,动态整合多频段信息,提高特征
提取的精度。在嗅觉脑电等研究中,该机制已被证实可以有效应对数据噪声和特征冗余问
题,为更精准地解码嗅觉信息提供了技术保障,比如 Xia 等人[50]设计的频段注意力网络
(Frequency Band Attention Network,FBANet)在特征挖掘部分引入了 SelfAM,有效地建
立并整合了多频段特征之间的关系,成功区分了 8 种食物气味,为多频段嗅觉脑电分析在
食物感官评价中的应用提供了新的思路。Sun 等人[44]提出了一种基于频段注意机制的嗅觉
脑电分类网络,自适应地优化特定对象的频段特征,有效提升了嗅觉脑电的分类性能。
Eldele 等人[52]应用 MHA 模块,成功捕捉了睡眠脑电特征之间的时间依赖关系,取得了良
好的分类效果,该方法对于分析嗅觉脑电等时间敏感性信号有广泛的参考意义。Shi 等人
[53]采用时间和空间自注意力模块提取脑电的时空特征,全面建模脑电信号的时间依赖性和
空间关系,实现了多帧动态脑状态的表征与分类,有效提升了模型在多任务下的分类性能,
SelfAM 的引入有效提升了模型对嗅觉脑电数据的解码能力,可识别单一频段中的脑电信


东北电力大学工学博士学位论文
6
息,还为多频段数据的整合提供了技术支持,让模型在处理复杂 EEG 数据时有更强的泛化
能力。
(4)多模态方法
传统单模态脑电解码的精度通常会受到数据质量以及个体差异的制约,多模态学习通
过融合不同模态的数据信息,有效提高了模型的稳定性以及跨被试者识别能力。诸多脑电
任务将 EEG 与功能性磁共振成像(Functional Magnetic Resonance Imaging,fMRI)、面部
表情图像或者心电图(Electrocardiogram,ECG)相结合,以获取更为全面的特征信息,提
高对复杂感觉体验的识别精度。He 等人[54]提出的多模态多任务神经网络(Multimodal
Multitask Neural Network,M2NN)模型融合了 EEG 和功能近红外光谱(Functional Near
Infrared Spectroscopy,fNIRS)信号,通过时空特征提取、多模态特征融合以及多任务学习
模块,达成了运动想象的高效分类。Liu 等人[55]提出了脑机耦合学习方法,融合并挖掘视
觉图像和脑电信号,实现了情感识别。Lyu 等人[56]利用 EEG 和 ECG 的多模态特征结合,
通过多尺度熵与样本熵提取非线性特征,并结合主成分分析(Principal Components Analysis,
PCA)进行降维,成功实现了睡眠阶段分类。尽管多模态学习在运动想象、情感识别以及
睡眠阶段分类等脑电任务中收获了成果,然而在嗅觉脑电研究中的应用仍处于起步阶段,
和上述领域相比,相关研究仍不够深入。现有嗅觉脑电解码研究主要集中于单模态脑电信
号的特征提取与模型优化,在面对跨被试者差异、低信噪比以及复杂嗅觉体验解码等问题
时,单模态方法往往面临巨大挑战。例如嗅觉刺激引发的脑电信号幅度比较弱且响应区域
分布比较广,传统方法难以获取足够的有效特征,不同被试者在嗅觉刺激下的感知偏好和
情感反应差异也限制了单模态模型的泛化能力。
多模态学习为嗅觉脑电解码开辟了道路,通过融合 fMRI、面部表情图像以及 ECG 等
多种模态,可获取与嗅觉感知相关的全面且细腻的特征信息,弥补了 EEG 单模态数据的信
息缺失状况,通过模态间的互补特性提高了模型的解码性能。例如 fMRI 的高空间分辨率
可确定嗅觉刺激的脑区激活区域,而 ECG 检测出的自主神经反应为 EEG 补充了情感或者
生理特征方面的信息。多模态学习可探寻模态间的内在联系,以提升对复杂嗅觉脑电的解
码能力。多模态学习是推动嗅觉脑电研究的关键方向,为嗅觉脑电的广泛应用创造了可能,
也为深入理解嗅觉与其他感官的相互作用奠定了基础,推动其在复杂认知任务中的广泛应
用。
嗅觉脑电研究发生了从传统方法到深度学习的转变,传统方法依靠特征提取与分类器
设计,着重于时频域特征的人工设计,虽然有较好的可解释性,但特征选择耗时、费力,
且全局建模能力有限。深度学习凭借自动特征提取和时序建模能力提高了嗅觉脑电的解码
精度,SelfAM 的引入,提高了多频段信息整合和全局关联建模的能力,为复杂嗅觉信号分
析提供了新方向。多模态学习将脑电信号与其他模态相结合,实现了信号间的优势互补,


第 1 章 绪论
7
为复杂嗅觉体验的精准识别提供了新思路,具有广阔的应用前景。尽管技术手段持续进步,
嗅觉脑电研究在多频段整合与跨被试者识别等方面仍面临不少挑战,需要探索和优化。
1.2.2 味觉脑电研究现状
味觉脑电研究作为脑科学中专注于味觉感知的一个分支领域,通过对脑电信号的分析
来揭示味觉感知机制,同时还对情感、认知等进行了探索。近年来,研究方法历经了从时
频特性分析到传统机器学习方法,再到深度学习及其拓展方法的发展进程。这一发展进程
体现出了技术所取得的进步,也表明对于复杂味觉感知的理解在逐步地深入。
(1)传统方法
传统方法重点围绕脑电信号的特征提取以及统计分析展开,通过频域和时域方面的研
究来揭示味觉刺激给脑电活动造成的影响[57,58]。例如,Wallroth 等人[59]发现在 δ 频段的 130
毫秒时长内,可对咸、甜、酸、苦这四种味觉刺激加以区分,并且这种区分独立于运动相
关激活,所编码的是味觉信息,并非强度或者效价,该研究首次将味觉神经响应与感知决
策相关联,说明了 δ 频段在味觉信息编码中所起到的作用。基于此,Andersen 等人[60]剖析
了 EEG 在区分相似味觉感知中的作用,脑电分析显示 80 至 180 毫秒内的大脑响应有十分
突出的区分能力,使得对味觉神经表征的理解得到了拓展。Yang 等人[61,62]从刺激强度的角
度开展研究,依靠频谱分析发现高强度味觉刺激会诱发 α 和 θ 频段的较大激活,不同味觉
类型的神经表征在刺激之后的 250-1500 毫秒之间呈现出动态差异。另外其研究还说明脂肪
味觉感知主要涉及初级和次级味觉皮层的激活,饱和脂肪酸对与情感和奖励处理相关的皮
层区域激活更为强烈,这为健康饮食策略给予了关键启示。除了对神经响应机制进行探索
之外,Hashida 等人[63]运用自适应 Gabor 变换提取脑电特征来区分甜味和咸味,结果说明
Gabor 变换系数可有效揭示不同味觉刺激之间的较大差异,验证了其在单通道 EEG 味觉分
类中的应用潜力。传统方法有直观性和可解释性等优点,不过其处理高维和多样性信号的
能力有限,迫切需要引入更先进的技术来拓展研究的广度和深度。
随着数据分析技术的不断发展,机器学习方法在味觉脑电的特征提取以及分类领域被
广泛运用,Li 等人[64]提出了小波包变换和 SVM 相结合的分类模型来分辨酸、甜、苦、咸、
鲜这五种基本味觉,此研究通过小波包分解提取脑电的时频特征,并且运用公共空间模式
(Common Spatial Pattern,CSP)进行降维处理,最终达成了 76.13%的分类精度。Abidi 等
人[65]提出了一种区分甜味和酸味的脑电方法,该研究提取峰度、偏度、能量以及小波熵等
特征并使用线性判别分类器进行分类,在 20 到 30 秒响应时间段内的分类准确率超过 98%,
为味觉信号分类提供了新的方法。Cui 等人[66]开发了基于 EEG 和机器学习的鲜味评价集成
模型,通过结合多种机器学习的二分类算法以及特征筛选技术,成功区分了鲜味与非鲜味
物质,该模型在测试集的分类准确率为 77.8%。上述机器学习方法在样本量较少的情况下


东北电力大学工学博士学位论文
8
表现出了较好的特征提取和分类能力,不过传统机器学习模型的分类性能通常依靠人工特
征提取,很难充分挖掘味觉脑电的深层信息。
(2)深度学习方法
近年来,深度学习凭借其有的强大非线性建模以及特征学习能力,在味觉脑电研究领
域里得到了广泛运用。Gao 等人[67]提出了用于味觉感知分类的多尺度 CNN,该模型通过残
差学习以及多尺度卷积来提取味觉脑电的时频特征,并且采用全局平均池化层取代 FC 层,
以此提升了模型的稳定性与泛化能力。Maram 等人[68]针对深度学习在消费者喜好预测方面
的应用展开了研究,他们将 BCI 与 CNN 相结合,开发出一种可预测消费者对咖啡品牌偏
好的模型,分类精度达到 85.9%,该研究证明,深度学习在味觉脑电建模中的潜力不只是
局限于味觉分类,还可扩展到消费者行为研究领域。Vo 等人[69]提出了一种将离散小波变
换(Discrete Wavelet Transform,DWT)和基础神经网络相结合的味觉脑电分类方法,DWT
用于提取味觉脑电的时频特征,神经网络模型则学习这些特征的深层模式,实验结果显示
该方法可有效区分酸和咸这两种味觉,证明了 DWT 与深度学习结合的可行性。深度学习
方法在味觉脑电分析中展现了出色的性能,不过其局限性也不能被忽视,比如对任务相关
特征缺乏有效的选择能力、模型有黑箱特性以及无法契合泛化性能的高要求等。这些问题
促使研究者对深度学习方法进行改进,优化特征提取过程,提高模型对特定信号的关注度,
并且提高其在味觉脑电研究中的适用性。
(3)深度学习的拓展方法
为了提高深度学习模型在味觉脑电识别任务中的性能表现,研究者们探寻了注意力机
制以及多模态融合等拓展方法,这些方法在味觉脑电解码中有着十分突出的优势。Xia 等
人[15]提出了一种基于多视角通道注意力(Multi-view Channel Attention,MVCA)机制的深
度学习方法,通过 MVCA 突出关键特征的权重,达成了 99.56%的分类准确率,验证了注
意力机制在味觉分类中的有效性。De 等人[70]设计了基于 PCA 提高注意力机制的 LSTM 网
络,结合 PCA 降维提升特征有效性、提高注意力模块捕捉关键时序信息的能力,最终达到
了 97.16%的分类准确率,证实了注意力机制对复杂信号解码的提升作用。在多模态融合方
面,Gao 等人[71]开发了双模态融合网络,该网络将 EEG 与肌电图(Electromyogram,EMG)
信号相结合,利用二者的互补性提高了分类稳定性并且开辟了味觉脑电研究的新方向。Gao
等人[72]还提出了基于 Swin Transformer 的味觉脑电识别模型,该模型通过自注意力模块优
化特征提取,并结合多任务学习提高模型的泛化能力,在多被试数据集测试中呈现出良好
性能,证明改进的深度学习方法可有效解决低信噪比与个体差异性问题。另外 Zhao 等人
[73]将 EMG 与脑电信号结合,提取多模态信号的时频特征并应用机器学习算法研究五种基
本味觉强度的识别,发现酸、苦和咸的强度比较容易区分,而甜和鲜相对较难区分,该研
究为味觉强度识别提供了新的视角。在味觉脑电解码领域,注意力机制和多模态融合等方


第 1 章 绪论
9
法已经呈现出一定优势,然而要想提升模型性能,仍然需要应对数据量有限以及信号复杂
性高的双重挑战,针对这些问题,数据增强技术通过模拟真实场景生成多样化样本,有效
缓解了小样本规模对深度学习模型训练的限制。电极选择技术通过筛选与味觉感知高度相
关的信号通道,提升了数据处理效率,还减少了冗余信息对分类性能的干扰。尽管目前在
味觉脑电领域,关于数据增强和电极选择的研究相对较少,但是这些方法已经被广泛应用
于其他脑电研究领域,在提升模型性能方面具有巨大潜力。
数据增强技术在 EEG 研究中有广泛应用,在提升模型性能方面发挥着重要作用,多项
研究针对不同任务场景,给出了多样化增强策略,在改进深度学习模型方面有明显效果。
Wang 等人[74]通过给情绪脑电信号加高斯噪声来增加样本数量,以提高模型对情绪状态的
解码能力,在小样本场景下优势明显。Zhang 等人[75]用多片段剪切和拼接重组方法解决了
癫痫预发作与非发作状态样本不平衡难题,优化了模型在时域和频域的特征提取能力。Pei
等人[76]提出脑区重组方法,将左右脑通道信号分开再重新组成新的样本,比传统增强策略
具有更显著的增强效果。Schirrmeister 等人[77]通过裁剪脑电信号片段实现数据增强,扩展
了样本多样性,提升了模型的解码能力。Al-Saegh 等人[78]提出 CutCat 方法,通过裁剪和拼
接不同被试者的脑电信号片段来生成新样本,增强了样本在时序和空间上的多样性,在运
动想象分类中提升了深浅层网络性能。总之这些研究从添加噪声、信号拼接至片段裁剪等
多角度验证了数据增强技术的有效性,为味觉脑电研究的数据增强方法提供了很多思路。
通过生成多样的人工样本,这些策略有望解决味觉脑电数据不足问题,提高模型对味觉特
征的提取能力。不过这些方法仍存在许多局限性,比如添加高斯噪声可能引入过多干扰,
淹没有效的味觉脑电特征。信号剪切与拼接可能破坏味觉脑电特征在时空上的完整性。滑
动时间窗分割易造成样本重复性高,信息冗余严重。未来要针对味觉脑电数据特点优化增
强策略,更有效平衡数据扩展和特征信息之间的关系。
脑电电极的选择对于减少冗余信息、优化模型分类性能以及提升模型效率而言有着关
键意义,尤其在硬件资源受限的场景中显得更为关键。近年来,针对不同任务场景,研究
者们提出了诸多有效的电极选择方法,这些方法虽然主要应用于运动想象和情绪识别等领
域,但是对味觉脑电研究也有着重要启发。Wang 等人[79]提出了一种基于最小绝对收缩和
选择算子(Least Absolute Shrinkage and Selection Operator,Lasso)的电极选择方法,该方
法通过提取功率谱、时域统计量等多种特征,并且结合逻辑回归模型与 Lasso 惩罚函数,
达成了通道与特征的同步选择,在高维特征融合任务中呈现出了更高的稳定性与识别效率。
Arvaneh 等人[80]开发了稀疏 CSP 算法,在分类精度约束下实现了最少电极数的选择,该方
法通过去除无关或噪声电极,有效减少了硬件部署的复杂性,在运动想象任务中提升了模
型的分类性能。Wang 等人[81]针对嵌入式 BCI 提出了一种高效的 CNN 模型,该模型结合空
间滤波器进行电极自动选择,实现了较高的分类精度,降低了资源消耗和功耗,为低功耗


东北电力大学工学博士学位论文
10
设备的实时信号处理奠定了基础。另一项由 Wang 等人[82]完成的研究提出了一种基于归一
化 MI 的电极选择方法,通过计算电极间的连接矩阵并结合阈值筛选,实现了电极数的压
缩,同时保持较高的分类精度,实验表明,所选电极的分布与皮层功能区高度一致,为优
化脑电信号的生物学解释能力提供了有力支持,相较于费舍尔判别准则,MI 等现有方法的
优势明显。总之这些方法分别从特征融合、稀疏优化与空间滤波等多个角度呈现了其在电
极选择中的优势,为味觉脑电研究提供了宝贵的参考,然而现有方法仍然存在任务适配性
不足、电极选择对特定任务的优化能力有限以及模型复杂度较高等问题,未来需要结合味
觉脑电的特性,设计更加具针对性的电极选择策略,以提升信号处理的精度与效率。
传统方法主要通过对味觉脑电的频域与时域特征分析来阐释味觉刺激对脑电活动产
生的影响,然后进一步通过机器学习领域的分类器和特征筛选技术实现对味觉脑电的准确
分类,不过在深层特征挖掘上存在一定局限性。近年来,深度学习的运用促使味觉脑电分
析进展迅猛,多尺度 CNN 和注意力机制优化了深度学习模型的特征提取能力,还实现了
多模态融合的突破,然而味觉脑电识别仍受味觉脑电数据量不足等问题的制约。未来数据
增强和电极选择技术有望克服数据不足与信号复杂性等挑战,推动味觉脑电研究在神经科
学领域的探索以及多感官交互任务中的应用。
1.2.3 嗅-味联觉脑电研究现状
嗅觉与味觉之间的相互作用在感官神经科学领域的嗅-味联觉脑电研究中引起了广泛
的关注,为了揭示这种复杂的感官整合机制,Sinding 等人[83]通过 EEG 研究发现香气的加
入会延迟 P3(ERP 中的正向波成分,通常出现在刺激后约 300 毫秒)认知峰值,该研究还
证明了嗅觉和味觉的整合主要在高级脑区开展,并且可能通过自上而下的效应影响初级感
官区域,从神经层面指出气味所引发的咸味增强效应。Lim 等人[84]通过事件相关的去同步
化分析发现,嗅味整合在肥胖个体中呈现出更十分突出的延迟处理效应,指出这种效应可
能依靠反馈回路激活味觉皮层,剖析了气味增强味觉效应在不同体重群体中的神经机制。
在研究味觉和嗅觉的匹配性时,Maeda 等人[85]发现不匹配气味较大提高了 EEG 在 θ 频段
的活跃度,并且与主观甜味感知呈负相关,不匹配气味扰乱了味觉感知过程,增加了大脑
的跨感官信息整合负荷,阐明了不匹配气味对味觉感知的影响。Aveline 等人[86]利用脑电技
术记录了肥胖和正常体重群体在嗅-味刺激下的脑电活动,发现肥胖个体的甜味和咸味感知
增强效应更突出,这可能与高阶脑区的整合机制以及初级感官区的反馈回路有关。在更具
情境性的研究中,Cartocci 等人[87]基于 EEG 并结合动机和情绪指数来分析品酒过程中的神
经活动,发现嗅-味联觉提升了情绪参与度和接近动机,嗅-味联觉相较于单一味觉体验对
情感和认知有更强的调节作用。


第 1 章 绪论
11
虽然上述研究给嗅-味联觉脑电带来了不少实验证据,但相关研究仍存在一些问题,一
方面,现有文献数量不多,大多研究只是对脑电特征值的变化做了定性描述,没有对嗅-味
联觉神经网络组织以及动态整合机制进行量化建模和深入分析。另一方面,嗅觉和味觉的
感官量化方法还不够完善,在复杂感官情境中很难精准预测嗅-味联觉效应。未来研究可结
合多模态神经影像技术,通过深度学习和注意力机制,全方位解码嗅-味联觉的动态特性和
时空模式,构建多层次神经网络模型,探索其在食品风味设计以及感官优化领域的实际应
用潜力。
1.2.4 国内外文献简析
近年来,脑电信号分析技术取得了较大进展,这使得嗅觉、味觉以及嗅-味联觉脑电信
号研究得以快速发展[14,15]。这些研究加深了我们对于多感官反应机制的认识,同时在神经
科学和 BCI 领域开创了新的应用前景,为智能感知系统以及多模态交互技术的优化奠定了
基础。不过当前阶段的嗅觉、味觉和嗅-味联觉脑电技术在信号处理、特征提取以及多模态
融合等方面依旧存在不少技术难题,迫切需要开展研究探索并改进相关方法,以此提高其
在实际应用中的实用性与准确性[41,64,86]。下面将分别对嗅觉、味觉与嗅-味联觉脑电技术所
面临的主要问题做系统总结。
嗅觉脑电技术如今面临特征提取以及信号处理方面的瓶颈,当下嗅觉脑电的特征提取
方法还不够成熟完善,嗅觉脑电在时域、频域以及时频域等方面特征的提取主要依靠人工
经验,缺少统一的标准,并且多种方法在提取结果上存在不一致的情况,致使所提取的特
征不够稳定。现有的特征降维以及特征选择方法存在一定的局限性,在降维过程中会丢失
部分非线性信息,这对模型的特征识别效果产生了影响。嗅觉脑电在个体之间差异较大,
跨被试者的泛化能力不足是当前模型的一个明显短板,很难广泛地适用于不同个体嗅觉反
应信号的分析,另外嗅觉刺激引发的信号本身比较微弱,受到噪声干扰的影响较大,虽然
已经有了噪声处理技术,但是当前技术在复杂环境中的降噪效果还不太理想。怎样在特征
提取、降维以及跨被试者泛化等方面提高嗅觉脑电分析技术的实用性和有效性,是迫切需
要解决的技术难题。
味觉脑电技术研究虽有一定成果,不过仍存在不少问题,数据稀缺以及关键电极选择
是两大主要难题,味觉脑电数据稀缺情况较为明显,多样化样本数据严重匮乏,限制了复
杂深度学习模型的有效训练,数据不足影响模型性能,还妨碍了味觉脑电技术在更广泛场
景的应用。虽然研究者引入了部分数据增强技术以解决此问题,但在提高味觉脑电分类与
识别稳定性方面,仍有很大提升空间。此外,关键电极的选择对味觉脑电获取质量有直接
影响,然而当前电极选择方法未能精准定位味觉脑区,这种不足严重影响所提取特征的有


东北电力大学工学博士学位论文
12
效性与精准性,使信号质量差异加大,此问题影响味觉脑电分析精度,也限制了相关技术
发展。有效解决上述瓶颈问题,是推动味觉脑电技术发展的关键。
嗅-味联觉脑电技术的关键问题在于跨感官信号整合的难度大以及多感官解码的复杂
度高,嗅-味联觉作为一种多感官相互交织的现象,涉及嗅觉和味觉信号之间复杂的交互作
用,不过当下还缺少统一的理论框架来支撑多感官的融合分析,由于理论上的缺失,在时
间特性和信号特点存在较大差异的状况下,不同感官信号间的有效融合便成为一项极具挑
战性的任务。虽然深度学习技术在单一感官信号分析方面有了一定进展,但在嗅-味联觉脑
电领域还没有形成成熟完善的模型架构,现有方法在处理复杂信号交互时仍存在欠缺,不
能充分契合嗅-味联觉脑电研究的要求,这些问题突显了当前研究所面临的严峻形势,也显
示出该领域在方法论上的不足。未来的发展需要在多模态数据融合、深度学习模型设计等
方面进行更多探索,突破现有局限,实现对嗅-味联觉信号更精准的解码与分析。
总之,本文的研究目标在于解决现阶段嗅觉、味觉与嗅-味联觉脑电技术所存在的几个
关键问题,推动相关领域的发展以及实际应用,这些问题对于该技术的拓展有关键影响,
这些问题的解决有望为相关领域带来新的机遇和突破,使其在实际应用中发挥更大的作用,
促进整个领域朝着更加完善和成熟的方向发展:
(1)嗅觉脑电特征挖掘的局限
嗅觉脑电在不同频段呈现出丰富多样的反应特性,然而现有的特征提取方法却难以将
这些频域信息全面捕捉,这限制了对嗅觉反应的深入剖析。对时域、频域或时频域进行特
征提取的传统方法通过固定的特征选择策略,在捕捉多频域信息方面缺乏灵活性,不能充
分挖掘各频段的细微特征。深度学习尽管已经成为主流技术,但当前大多数模型更侧重于
原始信号特征的学习,难以有效整合多频段信息,对各频段特征间复杂的交互关系揭示存
在不足,这限制了对嗅觉脑电的深层理解,怎样通过更具自适应能力的特征挖掘机制全面
捕捉嗅觉脑电中丰富的多频段信息,并且提高所提取特征的稳定性与一致性,是当前该领
域迫切需要解决的关键问题。
(2)嗅觉脑电的跨被试者识别瓶颈
个体之间的嗅觉脑电存在明显差异,传统模型在跨被试者任务中的泛化能力欠佳,这
对其在实际应用中的推广造成了限制,个体差异体现在不同人群脑电信号的反应模式上,
还与生理、心理以及环境因素的作用有关,这加大了跨被试者识别的难度。传统的嗅觉脑
电识别模型在应对个体差异时局限性明显,其泛化性能受到较大限制,致使模型在应用于
未知个体时的识别效果不佳。现有的特征挖掘和泛化技术没有充分考虑个体间的多样化特
征,导致模型在跨个体识别中难以实现有效的特征迁移,怎样有效整合并适配个体间的脑
电特征以提升模型在多样化人群中的适应性与泛化性,是当前嗅觉脑电识别模型的一项技
术挑战。


第 1 章 绪论
13
(3)味觉脑电数据的稀缺性
在味觉脑电识别任务中,数据稀缺问题极大限制了基于数据驱动方法的识别效果。味
觉脑电的采集过程较为复杂,同时存在环境干扰,再加上被试者稀缺等多种因素,共同致
使味觉脑电数据量的严重不足。当前的数据规模无法支撑复杂模型的训练,这对模型的稳
定性以及泛化能力产生了影响。虽然研究人员尝试将一些数据增强技术用于改善数据不足
的状况,然而味觉脑电本身具有微弱性以及个体差异性,这加大了数据增强的难度,现有
数据增强方法主要基于简单的时域或者频域变换,无法充分解析味觉脑电的复杂特性,这
严重限制了数据增强的效果,难以契合实际应用需求。针对味觉脑电的数据稀缺问题,迫
切需要开发更为有效的数据增强策略,充分挖掘味觉信号特性,提高味觉信号识别的准确
性与稳定性,这是解决数据稀缺问题的关键所在,也是推动味觉脑电技术发展的关键策略。
(4)味觉脑电电极冗余
味觉脑电的精准获取离不开脑电电极的科学优化,然而现有方法往往无法有效识别关
键电极,更无法对关键电极进行聚焦,这使得信号质量以及分析效果受到限制。传统电极
布置方式大多是基于标准化脑区定位,缺少对味觉脑电特征的针对性考量,结果导致部分
和味觉相关的关键脑区信号被忽略,降低了分类精度。冗余电极的存在增加了信号处理的
复杂程度,还可能引入无关或者噪声信号,让模型的性能变弱,不同个体的脑部解剖结构
有差异,这使得固定的电极布置在实际应用里缺乏广泛适用性。针对上述问题,急需设计
灵活的电极选择方案,通过选择和味觉脑区高度相关的关键电极,去除冗余信号来源,提
升脑电信号的空间分辨率及数据质量,该策略有望提升模型对味觉脑电的识别能力,还可
为高精度味觉脑电分析提供可靠的基础。
(5)嗅-味联觉脑电的多感官解码复杂性
嗅-味联觉脑电信号的分析涉及多感官信号的解码,当前技术在这方面存在困难。嗅
味联觉脑电信号一般包含嗅觉和味觉等多种感官的复杂交互信息,其时间特性以及频域特
征各不相同,这使传统方法在分析多感官信号时遭遇挑战,当前多数方法只是针对单一感
官展开分析,缺少针对多感官交互特征的分析研究,无法准确捕捉嗅-味联觉信号中的跨感
官信息。另外,现有的深度学习方法尽管在单模态信号解码方面有一定进展,但在多模态
嗅-味联觉信号解码上还没有形成成熟的网络架构,致使处理多感官交互信息时效果不佳,
因此提高模型在嗅-味联觉解码中的性能是推动嗅-味联觉脑电研究向实际应用发展的关键。
在嗅觉、味觉与嗅-味联觉脑电信号分析中存在关键瓶颈,本文给出了基于深度学习的
创新方法,具体包括嗅觉脑电特征挖掘、跨被试者识别、味觉脑电数据增强、电极选择以
及嗅-味联觉脑电信号解码等,研究成果能减少工程应用中后端数据处理的人工成本,简化
特征提取与模式识别流程,提升整体识别精度和系统稳定性。所提出的方法在复杂环境中
能保持优良的可靠性和适应性,充分验证了方法的实用性和稳定性,所取得的研究成果优


东北电力大学工学博士学位论文
14
化了嗅觉、味觉与嗅-味联觉脑电信号的分析手段,也为该领域持续发展提供了坚实理论支
撑和技术保障,这些进展可推动相关技术在神经科学、BCI 以及智能感知系统中的广泛应
用,加速实现多模态脑电信号研究的突破性进展。
1.3 研究内容及技术路线
1.3.1 研究内容
经过对上述研究背景的剖析可以看出,嗅觉、味觉以及嗅-味联觉脑电信号的分析受到
多方面的制约,具体有特征挖掘、跨被试者识别、数据稀缺、电极冗余、多感官解码等限
制,这些难题对嗅觉、味觉以及嗅-味联觉脑电技术的应用形成了限制。为解决上述问题,
本研究基于深度学习技术提出了一系列创新性方法,以此提高嗅觉、味觉与嗅-味联觉脑电
信号的识别精度、稳定性以及适应性,推动相关领域技术的发展。具体的研究内容如下:
(1)嗅觉脑电特征挖掘方法的优化
本研究聚焦于嗅觉脑电特征挖掘的关键问题,创新性地提出一种基于频段注意力机制
的方法,此方法通过对不同频段的脑电信号做加权处理,能有效提取和嗅觉反应相关的关
键特征,实现多频段信息的整合。研究结果显示,该方法提升了气味分类的准确性,提高
了模型稳定性,为嗅觉脑电精确解码提供了新的技术支持。
(2)跨被试者识别与模型泛化能力提升
面对嗅觉脑电在跨被试者识别时出现的个体差异性以及非平稳性这些问题,本研究提
出了一种基于脑-机融合网络(Brain-Machine Fusion Network,BMFNet)的解决方法,此方
法创新性地将嗅觉脑电的神经感知信息和电子鼻信号的物质理化信息相结合,通过特征对
齐策略有效减少了个体间的数据分布差异。BMFNet 模型依靠自适应学习机制可提取出跨
个体的个性特征与共性特征,在跨被试者的气味偏好识别任务中具有较高的准确性以及泛
化性,为跨被试者识别挑战给出了有效的解决方案。
(3)味觉脑电数据稀缺问题的解决方案
在味觉脑电分析这项研究领域中,数据稀缺的问题始终是限制其向前发展的关键痛点,
本研究构思了一种时空重构数据增强(Temporal-Spatial Reconstruction Data Augment,
TSRDA)方法,该方法针对脑电信号的时域和空域开展了数据增强,以实现有效扩充训练
样本的目标。该方法在增加数据数量的同时保证了信号的真实性以及有效性,使得分类模
型在小样本情形下的识别精准度有了一定程度的提升。
(4)味觉脑电电极选择策略的研究与应用
关键电极的选择对于确保味觉脑电信号的质量至关重要,本研究提出了一种基于多尺
度通道注意力机制的电极选择方法,该方法可通过脑电信号的关键特征区域自动识别并选


第 1 章 绪论
15
择关键电极,提升信号的信噪比以及识别效果,通过对关键电极的选择,可提高味觉脑电
的信息质量,为高效的脑电识别奠定基础。
(5)嗅-味联觉脑电信号解码及其应用
针对嗅-味联觉效应,本文提出了一种基于局部-全局融合网络(Local and Global Fusion
Network,EEG-LGFNet)的嗅-味联觉解码方法,以气味增甜效应为着眼点,通过 EEG
LGFNet 将局部脑电信号特征和全局脑电活动捕捉相结合,对气味增甜的脑电特征进行量
化,从神经层面表征了气味对甜味感知的增强作用,揭示出嗅觉与味觉的交互关系。本研
究为嗅-味联觉信号解码提供了新的技术途径,也为理解嗅觉与味觉交互机制、开发低糖食
品以及个性化风味推荐系统提供了理论支撑和技术基础。
1.3.2 技术路线
本文基于深度学习技术,针对嗅觉、味觉以及嗅-味联觉脑电信号的分析展开研究工作,
提出了一系列有创新性的深度学习模型以及数据分析方法,以提升脑电信号处理以及模式
识别的精度与稳定性,解决当前领域所面临的关键痛点,本文的技术路线如图 1-1 所示,
对应的具体章节安排如下:
图 1-1 技术路线图
Figure 1-1 The technology roadmap
第 2 章:阐述一种基于 FBANet 的气味识别方法,提取并融合嗅觉脑电的不同频段特
征,通过注意力机制对不同频段赋予不同权重,以提升模型对气味识别的精度与稳定性,


东北电力大学工学博士学位论文
16
该方法突破了现有研究中仅依靠原始数据或单一频段特征开展分类的限制,全面挖掘不同
频段间的复杂特征关系,有效提高了气味分类效果。
第 3 章:在第 2 章中,我们对多频段特征在嗅觉脑电分析中的作用展开了探讨,并且
实现了精准的气味分类,然而嗅觉体验并非仅仅关乎气味识别,还涉及情感以及偏好反应,
这致使嗅觉脑电在跨被试者识别方面遭遇了极大的挑战。鉴于此,本章提出了一种基于嗅
觉脑电与电子鼻信号的跨被试者气味偏好识别方法。该方法通过多模态学习将电子鼻的物
理化学信息与嗅觉脑电的情感感知信息相结合,实现了对气味偏好的全面建模。该方法运
用了电子鼻的跨样本识别能力,还结合了嗅觉脑电在情感识别上的优势,突破了单一技术
的限制。实验结果显示,该方法在跨被试者识别任务中的性能优于现有先进方法,为嗅觉
偏好识别的实际应用提供了技术支撑。
第 4 章:相较于嗅觉,味觉脑电信号的特征提取面临更大挑战,这是由于其神经加工
过程更为繁杂,信号也较为微弱,此外数据采集还会受到实验环境的作用以及刺激恢复时
间的约束,致使味觉脑电数据相对匮乏,因此本章提出了 TSRDA 方法,以优化味觉脑电
信号的时间与空间特征,提升数据特征的多样性和有效性。此外,本章在 CNN 模型中引
入 MVCA 模块,从味觉脑电的多个维度提取关键的特征信息,提升了模型的分类精度和稳
定性。实验结果显示,该方法有效缓解了数据不足的问题,在味觉信号解码任务中表现出
色,为味觉脑电分析提供了数据支持。
第 5 章:基于第 4 章所阐述的数据增强方法,本章着重探讨味觉脑电的冗余信息问题。
在电极选择方面,不同电极在任务中发挥的作用并不均衡,若采用全电极数据,将会使计
算复杂度增加,并且可能由于冗余信息的存在而降低模型的识别效果。鉴于此,本章提出
了一种将 Grad-CAM 与 CNN-CSA 模型相结合的电极选择方法。其中 Grad-CAM 用于筛选
出关键电极,以减少冗余信息,而 CNN-CSA 模型则能够优化特征提取过程,提升识别精
度。实验结果显示,该方法可有效去除冗余电极,提升模型性能,为味觉脑电识别以及食
品感官评价提供技术上的支撑。
第 6 章:本章节着重探究气味对甜味感知所产生的增强作用,提出了基于 EEG-LGFNet
的嗅-味联觉脑电方法,以实现对该现象的客观量化。虽然在前几章里所提及的方法并未被
直接运用于本章实验中,然而前几章在脑电建模以及深度学习优化等方面对本章给予了相
当关键的启发,EEG-LGFNet 将深度学习在风味感知领域的应用范围进行了拓展,可有效
地对嗅觉与味觉之间的交互关系进行解码,对气味增强甜味感知时的脑电特征给予量化。
该方法为食品科学和神经科学的交叉研究开辟了全新的视角,并将助力个性化营养以及食
品健康管理,在未来有望成为风味研究的关键分析工具。


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
17
第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
理解的艺术,是通过将无序化为有序,给予混沌一种结构。
——德国物理学家、哲学家赫尔曼·冯·亥姆霍兹
科学的关键之处在于从无序之中提炼出秩序,把混沌转化为结构化的知识,就如亥姆
霍兹所言,理解的艺术是给混沌赋予一种结构。嗅觉脑电中那些看似杂乱无章的频段特征,
是否也隐藏着某种尚未解开的秩序呢?我们能否找到一种方法,把这些无序的频段特征进
行结构化的整合呢?也许,这些复杂性正是我们取得新发现的关键要点。为了探索这些问
题,我们设计了 FBANet 模型,该模型通过 SelfAM 有效地建立并整合了嗅觉脑电多频段
特征间的关系,尝试在混沌的数据中找到稳定的识别模式,在看似无序的 EEG 数据中发现
潜在的规律,实现嗅觉脑电的精确识别与分析。
2.1 引言
当下大多数关于嗅觉的脑电研究主要运用传统的机器学习方法,先是对脑电信号开展
特征提取工作,接着再联合分类器达成气味识别,这些方法一般会将 PSD、近似熵
(Approximate Entropy,ApEn)等时频域特征跟 SVM、LDA 等分类模型结合,在气味识
别任务中取得了一定的成果,可是这类方法对人工特征提取的依赖程度很高,很难全面发
掘脑电信号中复杂的深层信息,并且也难以适应多样的气味类别情况,这限制了模型在实
际应用中的泛化能力。
深度学习技术发展速度较快,为气味识别任务给出了端到端的解决方法,提升了脑电
数据识别的效率与准确性,以 CNN 为代表的深度学习模型,能自动提取脑电信号的时空
特征,在多种脑电分类任务里优势明显,不过原始脑电信号中有大量噪声和冗余信息,直
接输入深度学习模型会造成干扰,影响模型的分类性能。针对此问题,通道注意力机制给
出了新的解决方案,该方法可强化模型对关键通道的聚焦能力,比如压缩和激励网络
(Squeeze-and-Excitation Network,SENet)和高效通道注意力(Efficient Channel Attention,
ECA)等方法,在多频段脑电分析中效果良好,为深度学习技术的优化奠定了基础。
脑电信号有十分突出的多频段分布特点,不同频段的信息可反映大脑不同的功能活动
状况,举例来说,δ 频段以及 θ 频段和注意力以及气味诱发的记忆加工之间有着紧密联系,
α 频段和 β 频段则与情感状态以及感知体验紧密相关,而 γ 频段更多地参与到高级认知功
能中,全面挖掘并整合多频段特征是提高气味识别模型性能的关键所在。不过当前的研究
在多频段数据识别方面依旧存在欠缺,多数研究集中于单一频段的分析或者只是简单拼接


东北电力大学工学博士学位论文
18
多个频段特征,并未充分揭示不同频段之间的时空动态交互以及它们的协同作用,使得气
味识别模型在复杂场景下的泛化能力受限,这阻碍了气味识别技术在实际应用中的研究以
及推广。
面对上述挑战,本研究提出了基于 FBANet 模型的气味识别方法,该方法设计了 MSCA
模块,其中的通道注意力机制可有效提升模型提取关键频段特征的能力,精确捕捉从 δ 频
段到 γ 频段的深层特征,该方法通过 SelfAM 实现了多频段深层特征的有效整合,成功建
立频段间的复杂关系。实验结果显示,与传统方法以及现有先进的深度学习模型相比,
FBANet 模型在多种气味分类任务里表现更佳,拥有较好的识别精度与稳定性。
2.2 嗅觉脑电数据集构建
2.2.1 实验平台
本研究运用自主研发的嗅觉诱发仪开展嗅觉脑电实验,该仪器有低噪声、高稳定性的
优点,具体组成如图 2-1 所示。其主要由输气单元、控制单元、扩散单元和数据采集单元
构成,控制单元控制输气单元以恒定压力将洁净的空气输入至扩散单元,从而将实验气体
由样品瓶精准输送至被试者鼻腔前部,在实验进程中,控制单元可精确控制嗅觉刺激的持
续时间与间隔。为减少实验过程中仪器产生的噪音,采用隔音棉包裹嗅觉诱发仪的电磁阀,
以有效提升实验环境的安静程度以及稳定性。
图 2-1 嗅觉脑电诱发仪
Figure 2-1 Olfactory EEG evoked instrument
本研究采用上海诺诚电气股份有限公司生产的 NCERP-P 脑电采集系统(输入阻抗≥
100 MΩ,共模抑制比≥100 dB,噪声水平< 2.5 μV),以 256 Hz 的采样频率采集 21 通道的
嗅觉相关脑电数据。为确保实验数据采集的科学性和准确性,依据国际 10-20 电极定位系
统放置脑电电极,21 通道脑电电极的具体位置如图 2-2 所示,在实验中各个电极被精确放
置于武汉格林泰克科技有限公司生产的脑电帽的以下位置:Fz、Cz、Pz、T3、T4、C3、C4、
Fp1、Fp2、F7、F8、T5、T6、O1、O2、F3、F4、P3、P4、A1 和 A2。


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
19
2.2.2 被试者与实验材料
本研究方案经东北电力大学科学研究伦理与科技安全委员会批准,符合《赫尔辛基宣
言》(修订版)的相关要求。实验招募了 15 名右利手健康志愿者(10 男 5 女,年龄 21-25
岁),志愿者均签署了知情同意书,并详细了解实验过程。所有被试者在实验前均能准确辨
别实验中使用的 8 种气味,并无神经或精神疾病史。
图 2-2 脑电帽导联示意图
Figure 2-2 Schematic diagram of EEG cap leads
表 2-1 8 种实验样本信息
Table 2-1 Eight kinds of experimental sample information
标号 产品名称 配料 产地
1 小伙子鲜虾酱 鲜虾、食用盐 山东省青岛市
2 八渡酸笋 八渡鲜笋、生活饮用水、食用盐 广西百色
3 苏丹王榴莲泥 苏丹王榴莲果肉 马来西亚
4 大蒜泥 大蒜 山东省临沂市
5 盾皇高倍柳橙汁 果葡糖浆、柳橙浓缩汁、生活饮用水、白砂糖、食用香精 河南省商丘市
6 盾皇高倍草莓汁
果葡糖浆、草莓浓缩汁、生活饮用水、白砂糖、食品添加
剂、食品用香精
河南省商丘市
7 盾皇薄荷糖浆
白砂糖、生活饮用水、柠檬酸、羧甲基纤维素钠、柠檬黄、
亮蓝、食品用香精
河南省商丘市
8 盾皇玫瑰糖浆
白砂糖、生活饮用水、柠檬酸、羧甲基纤维素钠、柠檬黄、
胭脂红、食品用香精
河南省商丘市
此次实验选用了薄荷糖浆、玫瑰糖浆、橙汁、草莓汁、蒜泥、虾酱、酸笋以及榴莲泥
作为气味刺激物,以唤起被试者的嗅觉脑电,这些气味皆是平常能见到的食物或者食品加


东北电力大学工学博士学位论文
20
工材料,可较好地模拟日常生活中被试者的嗅觉感受,实验样本的详细信息可见表 2-1,为
了合理把控气味强度,在实验开始之前对样品质量、体积以及挥发时间做了精确的设定:
分别制作 50 mL 的薄荷糖浆、玫瑰糖浆、橙汁和草莓汁,以及 25 g 的蒜泥、虾酱、酸笋和
榴莲泥。所有样品都放置在 250 mL 的样品瓶中 10 分钟,保证食物气味得到了充分挥发。
2.2.3 数据采集与预处理
在实验正式开始之前,仔细确认被试者的身体状况是否良好,同时确保被试者在实验
开始前的 2 个小时内没有进行任何进食行为,在实验开始前的 8 个小时内没有饮酒,被试
者身上没有携带任何电子设备,确认实验环境未遭受强电磁干扰,保障数据可准确无误的
采集。接下来开启实验室的窗户以及排风扇,以实现实验室的通风,利用中央空调将实验
环境的温度调节并控制在 21±2 °C的范围。在实验进行过程中,被试者需要将下巴自然地
放置在高度可以调节的下巴托上,然后闭上眼睛并且保持均匀的呼吸状态,扩散单元的气
体扩散器放置在距离被试者鼻前 2-3 厘米的位置,实验具体的流程如图 2-3 所示,每位被
试者都需要完成 8 种按照随机顺序排列的气味刺激实验。每一种气味刺激都包含 20 次平
行实验,每次刺激持续的时间为 10 秒,每组平行实验之间的间隔为 5 秒,相邻的两种气味
实验之间的间隔为 5 分钟,以此让被试者得到充分的休息。在被试者休息的这段时间中,
实验人员会打开门窗和风扇进行通风,同时把样品瓶移除,启动空气发生器,以排出嗅觉
诱发仪中的残余气味。当休息结束之后,依照气味实验的顺序,重复上述流程,直到完成
8 种气味实验。
图 2-3 嗅觉脑电数据采集流程
Figure 2-3 Olfactory EEG data collection process
实验采集的脑电数据由 Matlab(R2017b)及其工具包 EEGLAB(2021 版)进行预处
理[88],具体步骤如下:
(1)样本提取与标签设置。采集每位被试者在 8 种气味刺激下的脑电数据,每种气味
包含 20 次平行实验。为减少气味刺激前后无关因素的干扰,将时间处于 2 秒至 9 秒范围
之内的脑电数据段进行裁剪,使其成为 4 个各自独立的、长度均为 2 秒的样本,然后按照


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
21
气味的不同类型将这些样本的标签依次设定为从 0 到 7 的数字,15 名参与实验的被试者总
共生成了 9600 个脑电样本,这个数量是通过 15 乘以 8 再乘以 20 然后乘以 4 计算得出的,
其中 15 代表被试者的人数,8 代表气味种类的数量,20 代表平行实验的数量,4 代表每个
平行实验中的独立样本数量。
(2)滤波与降噪。运用有限脉冲响应(Finite Impulse Response,FIR)滤波器针对脑
电信号开展 0.5 至 50 Hz 的带通滤波操作,通过陷波滤波器消除工频干扰,其频率通带下
沿设定为 49 Hz,上沿设定为 51 Hz,。
(3)降采样处理。将经过滤波处理的脑电数据从原本的 256 Hz 降采样到 128 Hz,以
减小单个样本的大小,提高计算效率。
(4)小波分解与重构。经过降采样操作之后,信号所有的奈奎斯特采样频率变为了 64
Hz,运用多贝西小波(Daubechies Wavelet,DBW)对信号开展了 6 层的小波包分解,这里
的分解层数被设定为 20,之后按照频段的划分情况,重新构建出包含 δ、θ、α、β 以及 γ 这
五个频段的脑电信号数据,其中每个频段的数据尺寸是 21×256。
图 2-4 FBANet 模型框架 Figure 2-4 FBANet model framework
2.3 基于注意力机制的多频段特征挖掘方法
2.3.1 方法框架
嗅觉脑电的频段特征挖掘对提升气味识别分类性能意义重大,一般气味刺激会引发多
频段脑电活动[37–39]。但仅依靠原始脑电信号或者单一频段数据很难充分挖掘嗅觉脑电的复


东北电力大学工学博士学位论文
22
杂特征,在相关分类任务中有明显的局限性,基于此,本研究提出了 FBANet 网络模型,
能有效挖掘并整合嗅觉脑电的多频段特征,为复杂的分类任务提供技术支持。
FBANet 模型的整体结构如图 2-4 所示,其主要由频段特征挖掘(Frequency Band Feature
Mining,FBFM)模块和频段特征自注意力(Frequency Band Feature Self-Attention,FBFSelfA)
模块两部分组成。其中 FBFM 模块通过多个并行的多尺度注意力卷积(Multiscale Attention
Convolution,MSAC)模块以及平均池化操作,实现了对嗅觉脑电中五个频段,也就是 δ、
θ、α、β、γ 的深度特征挖掘。该模块可以精确捕捉各频段的关键信息,为后续的特征整合
给予了高质量的输入,之后所提取的深层特征被输入 FBFSelfA 模块,该模块依靠全局自
注意力建模,构建各频段间的相互关系,动态整合不同频段特征间的交互信息,有效提升
对复杂嗅觉脑电的表达能力。总之 FBANet 模型充分挖掘并整合了嗅觉脑电的多频段特征,
有效实现了对嗅觉脑电的准确识别。
图 2-5 δ 和 γ 频段波形
Figure 2-5 δ and γ band waveforms
2.3.2 FBFM 模块
玫瑰糖浆诱导产生的嗅觉脑电如图 2-5 所示,可发现从低频段 δ 至高频段 γ,其振幅随


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
23
时间变化呈现出明显差异,不同频段的嗅觉脑电有完全不一样的时空特性,那么怎样全面
挖掘并整合这些有着不同时空特性的多频段信息便成为嗅觉脑电分类任务中的关键问题。
基于上述思考,我们提出了 MSAC 模块,它的设计灵感来源于灵长类动物视觉皮层的神经
科学模型。Serre 等人[89]提出了一系列多尺度 Gabor 滤波器,用来实现对不同感受野下的特
征识别,为复杂视觉特征提取打下了理论基础,之后 Szegedy 等人[90]在 Inception 模型中将
该思想融入深度学习架构,并且在 2014 年的 ImageNet 大规模视觉识别挑战赛中获得了最
佳表现,证实了多尺度特征融合方法的有效性。受到上述研究的启发,同时结合嗅觉脑电
中不同频段特征的特性,本研究在 FBFM 模块中引入了 MSAC 模块以及平均池化,充分
挖掘多频段信号的深层特征。
在 FBFM 模块部分,5 个频段的嗅觉脑电数据分别被输入至对应的 MSAC 模块中以提
取每个频段的深度特征,MSAC 模块融合了多尺度卷积以及通道注意力机制,可有效地捕
捉不同尺度频段信号的时空特征,每个频段都要依次经过 2 个 MSAC 模块,每个模块之后
紧接着一个尺寸为 2×4、步长为 2×4 的平均池化,可在压缩网络参数量(Parameters,Params)
的同时有效增大感受野,为后续的特征整合与分类奠定基础。上述设计深入剖析并充分考
量了嗅觉脑电的多频段特性,为多频段特征挖掘提供了有效的解决方法,为复杂的嗅觉脑
电分类任务奠定了坚实基础。
图 2-6 MSCA 模块计算流程
Figure 2-6 MSCA module calculation process
MSAC 模块的结构如图 2-6 所示,当尺寸为 C1×H×W 的单频段嗅觉脑电数据输入至该
模块时,此模块通过两个独立的卷积操作来提取多尺度的时间特征,卷积核的尺寸分别被
设定为 1×3 以及 1×7,步长为 1,填充方式为 same,以此保证卷积操作后的数据尺寸维持
不变。经过两次卷积后,分别获取两组尺寸为 C2×H×W 的特征。随后将两组特征逐点相加,
从而实现多尺度特征的聚合,为了充分考量关键特征,实现对嗅觉脑电中关键特征信息的
挖掘,将聚合后尺寸为 C2×H×W 的特征输入 ECA 模块,ECA 模块首先通过批量归一化
(BatchNorm,BN)层对数据实施标准化,以此改善数据分布,提升模型训练过程的稳定
性。随后采用 ReLU 激活函数对标准化的数据进行非线性变换,有效防止梯度爆炸或消失


东北电力大学工学博士学位论文
24
的问题,并且加速模型收敛。然后利用卷积操作提取嗅觉脑电的空间特征,其中的卷积核
尺寸为 3×1,步长为 1,填充方式依旧为 same。经过空间特征提取后,特征再依次经过 BN
层和 ReLU 激活,最终输出尺寸为 C2×H×W 的特征。为保证嗅觉脑电特征的丰富性并避免
信息冗余,该模块在不同阶段设置了不同的通道数参数,在第 1 个 MSCA 模块中,C1 和
C2 分别被设为 1 和 16,在第 2 个 MSCA 模块中,C1 和 C2 分别被设为 16 和 32,该设置可
在保证特征多样性的同时有效地控制模型的 Params,为后续的模型训练和分类给予支持。
在 CNN 中引入注意力机制,可有效提升模型提取关键特征的能力,提高模型对嗅觉
脑电数据的识别效果,ECA 是一种关键的注意力机制,它通过给特征中的不同通道赋予不
同的权重,可以有效聚焦关键通道并忽略冗余信息,ECA 模块的结构如图 2-7 所示,其主
要包含全局平均池化、一维卷积以及非线性激活等操作,当尺寸为 C×H×W 的嗅觉脑电特
征输入到该模块时,首先会沿着通道维度进行全局平均池化来提取各通道的全局特征,计
算公式如下:
11
1
×
HW
a ij ij
PF
HW= =
= ∑ ∑ (2-1)
其中,输入数据为 F∈RC×H×W,Pa 表示全局平均池化的结果。
在平均池化后,通过沿通道维度展开的一维卷积来实现各通道全局特征的跨通道交互,
其中卷积核尺寸为 1×3,步长为 1,填充方式为 same,这种一维卷积操作可捕捉通道之间
的关联信息,强化关键特征。接着运用 sigmoid 函数对卷积结果实施非线性激活,以生成
通道注意力权重。然后,将所得到的通道注意力权重与原始输入特征 F 相乘用以调整各通
道的关键程度,获取最终的输出 F’。
图 2-7 ECA 模块的计算流程
Figure 2-7 The calculation process of ECA module
2.3.3 FBFSelfA 模块
在完成频段特征挖掘后,受到 SelfAM 在特征关系建模方面的启发[51],本研究提出将


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
25
特征输入 FBFSelfA 模块,以建立并整合不同频段特征间的相互关系,最终将整合后的特
征用于分类任务,FBFSelfA 模块的整体结构如图 2-4 所示,主要包含拼接、分块嵌入、自
注意力模块以及 FC 层和 Softmax 层,具体过程如下。将五个频段的特征沿第二维度进行
拼接,得到尺寸为 1×800×16 的单通道特征,接着通过分块嵌入操作,利用二维卷积对拼
接后的三维特征进行重构,生成多个用于多频段全局自注意力计算的二维补丁,卷积核的
尺寸和拼接前每个通道的特征尺寸一样,都设置为 5×16,步长是 1,这样能保证每个特征
的信息都能被完整保留并重构。经过卷积操作后,生成多个包含 160 个标记的补丁,以有
效提取每个特征的信息,保证重构的合理性。将输出通道数设为 320,旨在保证特征含有
足够有效信息的前提下,优化补丁的尺寸和特征表达能力。另外在分块嵌入后的数据中加
入分类标记,用于最终的分类预测,因此嵌入特征的最终尺寸为 161×320。为了保留频段
特征的相对位置信息,降嵌入的可学习的位置信息与嵌入特征相加,生成输入到自注意力
模块的嵌入向量,上述设计保证了各频段特征的全局关联性,为分类任务提供了有力支持。
自注意力模块的结构如图 2-8 所示,它主要由层归一化(LayerNorm,LN)、MHA 以
及多层感知器(Multilayer Perceptron,MLP)构成,当嵌入向量 Z1 输入至自注意力模块时,
先通过 LN 对各个频段的特征开展标准化操作,这样在稳定特征分布之际还可加速模型的
收敛进程。之后将经过标准化的数据输入到 MHA 中,以此来构建多频段嗅觉脑电特征之
间的关联。为了保留底层的特征信息,将 MHA 的输出同输入 Z1 相加,得到中间特征 Z2,
随后把 Z2 经过 LN 之后再输入到 MLP,MLP 是由两个 FC 层组成的,并且在中间运用高
斯误差线性单元(Gaussian Error Linear Unit,GeLU)激活函数来引入非线性以及随机性,
提升模型训练的稳定性,MLP 的输出和 Z2 相加得到自注意力模块的输出 Z3。自注意力模
块的计算过程如下:
Z2=MHA(LN(Z1))+Z1 (2-2)
Z3=MLP(LN(Z2))+Z2 (2-3)
其中,Z1 和 Z3 分别为自注意力模块的输入和输出,LN 为 Layernorm 操作。
图 2-8 自注意力模块
Figure 2-8 Self-attention module
MHA 模块是自注意力模块中的关键部分,其多头自注意力比单头自注意力在捕捉不
同位置表征子空间信息方面更具优势,可有效提升模型表征多频段嗅觉脑电特征的能力。
具体过程如图 2-9 所示。


东北电力大学工学博士学位论文
26
(1)多频段脑电特征 X∈Rm×n(其中 m=161,n=320)经 LN 后输入 MHA。然后将 X
乘以尺寸为 n×n 的矩阵 LQ、LK 和 LV 以实现线性化(Linear),Q、K 和 V 为线性化后的特
征矩阵,尺寸为 m×n,其中 m 和 n 分别为 161 和 320。
图 2-9 MHA 模块的计算流程
Figure 2-9 The calculation process of MHA module
(2)为有效学习多频段嗅觉脑电特征间的关系,将尺寸为 m×n 的特征矩阵 Q、K 和
V 沿第 2 维度扩展为 m×h× n
h 。然后将扩展后特征的第 1 维度和第 2 维度互换,得到多头
特征 Qh、Kh 和 Vh,尺寸为 h×m× n
h ,其中 h=40。
(3)将 Kh 的第 2 维度和第 3 维度互换后乘以 Qh,再按比例因子 d 对其缩放,然后将
缩放结果输入 Softmax 层,得到数值介于 0 和 1 之间的自注意力权重。再将自注意力权重
乘以多头特征 Vh,得到尺寸为 h×m× n
h 的自注意力特征,其计算公式如下:


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
27
softmax( )
T hh hh
QK
WV
d
= (2-4)
其中,T 表示将 Kh 的第 2 维度和第 3 维度互换, n
dh
= ,Wh 表示自注意力特征。
(4)最后,将多频段自注意力特征 Wh 的第 1 维度和第 3 维度拼接,以实现多头子特
征的整合。然后,将尺寸为 m×n 的集成特征乘以尺寸为 n×n 的矩阵,得到 Linear 后的输出
X’。
(5)自注意力模块的最终输出 Z∈R161×320,将补丁开头的分类标记送入 FC 层,然后
经 Softmax 层激活,生成最终的气味类别预测结果。通过上述方法,FBFSelfA 模块实现了
多频段嗅觉脑电特征间的有效整合。
2.4 实验结果与分析
2.4.1 模型设置与评价指标
本研究中,9600 个脑电样本按照 3:1 的比例随机划分为训练集(7200 个样本)和测试
集(2400 个样本)。通过参数预调试,最终确定 FBANet 模型和其他对比模型的关键训练
参数如下:训练集和测试集的批量大小分别设置为 32 和 16,迭代次数为 100 次,采用 Adam
优化器优化模型,学习率为 0.0005,权重衰减系数为 0.001。为了确保结果的可靠性,所有
模型均独立运行 5 次,并将运行所得的最高准确率和最高 F1 分数的平均值作为评价指标,
以实现模型性能的全面评估。
2.4.2 单频段分析
在单频段特征分析中,我们选择了以下 4 种模型分别挖掘原始脑电及各频段脑电信号
的特征:主流模型 ResNet18[91]、经典模型 EEGNet[92],以及在脑电分析领域表现优异的注
意力模型 MSDAN[93]和 AttnSleep[52]。各模型在原始数据及单频段数据上的实验结果详见表
2-2。可以明显看出模型在 δ 和 θ 频段的识别效果普遍优于原始数据及其他频段。在 δ 频段
中,EEGNet 的准确率为 95.94%,F1 分数为 95.38%。而在 θ 频段中,ResNet18 和 MSDAN
分别取得了 96.61%和 97.68%的准确率,以及 96.31%和 97.43%的 F1 分数。此外,尽管模
型在 α、β 和 γ 频段的识别效果较差,但整体上模型的准确率和 F1 分数保持在 80%以上,
这表明嗅觉脑电的每个频段均对气味识别任务具有贡献。
图 2-10 呈现出各频段嗅觉脑电在气味识别任务中的贡献率,贡献率的计算方式是将各
模型在特定频段的准确率与 F1 分数相加,然后除以所有频段的准确率和 F1 分数的总和。
从结果可看出,δ 频段和 θ 频段的贡献率分别是 22.23%以及 22.27%,这两个频段的贡献率
都比其他频段要高。另外 γ 频段的贡献率也超过了 20%,即使是表现相对不突出的 α 频段


东北电力大学工学博士学位论文
28
和 β 频段的贡献率也依然高于 17%,这意味着嗅觉脑电中像 δ 和 θ 这样的低频段中包含关
键的气味识别特征,同时比如 γ 这样的高频段中同样有关键的特征信息,这体现出嗅觉脑
电的复杂性,也从侧面证明了气味刺激通常会引发跨频段的脑电响应。
表 2-2 原始和单频嗅觉脑电特征挖掘结果
Table 2-2 Results of feature mining for original and single-frequency olfactory EEG 方法 EEGNet(%) ResNet18(%) AttnSleep(%) MSDAN(%)
准确率 F1 分数 准确率 F1 分数 准确率 F1 分数 准确率 F1 分数
原始信号 90.55
± 0.67
88.89 ± 0.65
95.36 ± 0.26
94.55 ± 0.43
97.58 ± 0.64
97.18 ± 0.70
95.51 ± 0.37
94.85 ± 0.43 δ 95.94
± 0.26
95.38 ± 0.41
96.16 ± 0.24
95.87 ± 0.19
95.76 ± 0.44
94.91 ± 0.53
97.56 ± 0.14
97.28 ± 0.14 θ 95.38
± 0.28
94.51 ± 0.34
96.61 ± 0.26
96.31 ± 0.26
96.51 ± 0.65
95.74 ± 0.99
97.68 ± 0.17
97.43 ± 0.13 α 78.05
± 1.87
75.03 ± 1.99
85.63 ± 1.68
83.56 ± 1.86
73.40 ± 0.65
70.08 ± 0.96
74.00 ± 2.84
70.28 ± 3.34 β 70.73
± 3.07
66.10 ± 3.28
73.03 ± 2.33
69.49 ± 2.68
82.43 ± 1.83
79.71 ± 1.90
87.30 ± 1.25
85.32 ± 1.47 γ 85.59
± 1.35
83.23 ± 1.70
87.53 ± 1.12
85.85 ± 1.23
86.39 ± 0.82
83.91 ± 0.95
91.83 ± 0.47
90.51 ± 0.43
图 2-10 各频段嗅觉脑电的分类贡献率
Figure 2-10 The classification contribution rate of olfactory EEG in each frequency band
不同气味诱发的脑电信号特征呈现出频段依赖性,此现象与现有嗅觉脑电频段相关研
究结论相符[37–39]。不同频段脑电信号在气味感知中发挥着不同作用,例如低频段或许和情
感体验有关,高频段可能涉及认知处理与气味辨识,虽然多频段嗅觉脑电在反映气味特征
信息方面有很大潜力,但当前针对多频段特征挖掘的研究相对有限,在复杂气味识别任务
中仍面临很大挑战。开发一种先进且稳定的嗅觉脑电多频段数据识别方法可提高嗅觉信息
识别的准确性,能为气味感知神经机制研究提供新思路,在食品科学、环境监测、医疗健
康等领域有广泛应用价值。
2.4.3 多频段分析
本研究提出的 FBANet 模型不仅与先进的原始或单频段脑电特征挖掘模型(如


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
29
MSDAN、AttnSleep、ResNet18 和 EEGNet)进行了对比,还与现有的多频段数据识别模型
(如 AFBD-SVM[40]、1D-CNN[46]和 DFB-ConvNet[47])进行了比较。模型对比实验基于已建
立的嗅觉脑电数据集,从准确率、F1 分数、Params 和计算量(Floating Point Operations,
FLOPs)四个方面进行比较。各对比模型的简要信息如下:
(1)MSDAN 是基于通道注意力和空间注意力机制构建的,该模型通过多尺度卷积层
来提取脑电信号的特征,并且运用注意力机制让关键特征得以凸显,可有效提高模型的分
类精度。
(2)AttnSleep 运用基于 SelfAM 的深度学习架构,通过对特征间依赖关系的建模来提
高特征质量,同时利用 MHA 模块捕捉特征在时间方面的相关性。
(3)ResNet18 作为在脑电任务里被广泛运用的经典模型,通过残差连接切实缓解了
深度网络中出现的梯度消失问题。
(4)EEGNet 是一种专门针对 EEG 识别任务而设计的轻量化 CNN,该模型通过时间
滤波器和空间滤波器提取 EEG 的时空特征。
(5)AFBD-SVM 先计算嗅觉脑电中处于等频段状态下的 PSD 特征,然后通过 SVM
实现分类。
(6)1D-CNN 针对多频段数据开展训练工作,其过程是分别在各个频段数据上训练一
维卷积滤波器,之后将各频段经过卷积滤波操作所得到的特征进行拼接融合,通过 FC 层
来实现分类任务。
(7)DFB-ConvNet 通过结合时间卷积核与空间卷积核来提取多频段特征,之后利用
FC 层达成分类目标。
表 2-3 FBANet 和其他先进模型的分类结果
Table 2-3 Classification results of FBANet and other advanced models 方法 Params FLOPs 准确率(%) F1 分数(%) EEGNet(δ 频段) 0.19M 0.89G 95.94 ± 0.26 95.38 ± 0.41 ResNet18(θ 频段) 2.81M 13.51G 96.61 ± 0.26 96.31 ± 0.26 AttnSleep(原始数据) 16.74M 0.83G 97.58 ± 0.84 97.18 ± 0.90 MSDAN(θ 频段) 3.12M 10.92G 97.68 ± 0.18 97.43 ± 0.16 1D-CNN 0.74M 6.55G 94.09 ± 0.84 93.01 ± 1.03 AFBD-SVM — — 95.82 ± 1.26 95.94 ± 1.49 DFB-ConvNet 0.73M 3.55G 97.64 ± 0.24 97.11 ± 0.33 FBANet 0.59M 4.44G 98.92 ± 0.16 98.75 ± 0.18
表 2-3 展示了 FBANet 模型以及其他模型在嗅觉脑电数据集上的性能表现情况,从最
终的结果可以知晓,FBANet 模型获得了 98.92%的最高准确率,表现出有效的性能优势,
在对原始或者单频段数据进行识别的时候,相较于经典的 ResNet18 以及 EEGNet,有
SelfAM 的 AttnSleep 和有通道注意力机制的 MSDAN 在嗅觉脑电任务里表现更为出色。这
意味着注意力机制可有效地突出原始或单频段数据中的关键特征信息,不过这些模型仅仅


东北电力大学工学博士学位论文
30
局限于对原始或单频段数据的分析,无法充分挖掘出嗅觉脑电中的多频段特征信息,相比
较而言,FBANet 模型针对多频段数据挖掘所做的设计让其在气味识别任务中有了更好的
识别性能。
在多频段数据识别模型领域,DFB-ConvNet 这类深度学习方法的分类性能比 AFBD
SVM 等传统机器学习模型要高许多,传统机器学习模型在特征提取环节存在不足,很难充
分运用多频段脑电中的关键信息,致使分类效果受到限制,深度学习模型则可自动学习复
杂的特征关系,在多频段数据处理中呈现出更强的适应性以及泛化能力。1D-CNN 仅仅依
靠时间卷积滤波器来进行特征提取,而 DFB-ConvNet 结合了时间和空间卷积滤波器,有更
强的特征学习能力,可充分挖掘多频段脑电数据中的关键特征,不过虽然 DFB-ConvNet 在
分类任务里表现出色,其准确率达到 97.64%,但识别性能还是低于 FBANet 模型。DFB
ConvNet 在多频段嗅觉脑电特征提取方面有着较大的优化空间,FBANet 模型借助 MSAC
模块深入挖掘不同频段的多尺度特征,并且利用 ECA 模块强化模型对关键特征的表达能
力,FBANet 中还引入了 SelfAM,让模型可以整合多频段特征之间的复杂关系,提高分类
精度。实验结果显示,FBANet 的准确率比 DFB-ConvNet 提高了 1.28%,验证了其优异的
识别性能,FBANet 可有效挖掘并整合多频段嗅觉脑电数据中的关键特征信息,还可以精
准识别复杂气味条件下的嗅觉脑电,该模型所提出的多频段数据挖掘方法为嗅觉脑电识别
提供了一种有效的方法。
图 2-11 展示的误差柱状图针对不同方法从准确率以及 F1 分数这两个方面展开了可视
化的对比,通过观察该图可发现,FBANet 模型在分类准确率方面超越了其他模型,具有良
好的识别能力,而且呈现出优良的识别稳定性,这充分验证了其在嗅觉脑电识别任务中的
良好性能。
图 2-11 FBANet 模型与其他先进数据识别模型的对比
Figure 2-11 The comparison of the FBANet model with other advanced data recognition models


第 2 章 嗅觉脑电:基于频段注意力网络的气味识别方法
31
2.4.4 消融实验
在本节通过消融实验验证了 ECA 模块和自注意力模块对模型性能的贡献,同时探索
了 MHA 中的头数对模型识别的影响。
(1)ECA 与自注意力模块的有效性
在第一部分实验中,分别比较了以下四种模型的性能:FBANet-W(去除 ECA 和自注
意力模块)、FBANet-C(仅包含 ECA 模块)、FBANet-S(仅包含自注意力模块)和 FBANet
(同时包含 ECA 和自注意力模块)。实验结果呈现在图 2-12(a)中,对 FBANet-W 和
FBANet-C 加以对比后可发现,ECA 模块的引入可以更为有效地挖掘多频段嗅觉脑电中的
关键特征,ECA 在提高特征表示上起到了积极的作用,与之相比,FBANet-S 的分类性能
要优于 FBANet-W 和 FBANet-C,这表明 SelfAM 在整合多频段特征关系时发挥了关键作
用,可自适应地分配注意力权重,更全面地捕捉嗅觉脑电中的多频段特征。另外 FBANet
的分类性能要优于 FBANet-C 和 FBANet-S,这意味着 ECA 与自注意力模块的协同作用可
有效提升模型对多频段特征的识别能力。总之在多频段嗅觉脑电信号分析任务中将通道注
意力与 SelfAM 相结合可有效优化特征提取过程,提升模型的识别性能。
图 2-12 消融实验结果
Figure 2-12 The results of ablation experiments
(2)MHA 模块头数的影响
第二部分实验着重剖析了 MHA 模块中的头数对模型分类性能所产生的影响,我们将
MHA 模块中的头数分别设定为 1、5、10、20、40、80 以及 160,随后对模型的分类性能
展开了评估,实验结果如图 2-12(b)所示。可以发现,随着头数从 1 逐渐增长到 40,模
型性能呈现出逐步提高的态势,这是由于更多的头数可更全面地捕捉和构建多频段特征之
间的复杂关联,提升模型的特征表示能力以及分类精度。然而当头数持续增加至 80 或者


东北电力大学工学博士学位论文
32
160 时,性能反而出现了略微的降低,这或许是因为随着头数增多,每个头可分配到的特
征长度变小,使得单个注意力头的特征提取能力受到限制,影响模型对多频段特征间关系
的建模能力,另外过多的头数还会加大计算开销,引入冗余信息,对模型的泛化能力产生
影响。鉴于模型的分类性能与计算效率,我们最终决定将头数设定为 40,这样的设定能充
分建立多频段特征间的丰富联系,提高模型的识别能力,同时也能避免过多头数带来的计
算负担以及潜在的性能下降问题,为后续的参数优化研究提供了关键的参考依据。
2.5 本章小结
本章聚焦于嗅觉脑电的多频段特征来开展研究,对 δ、θ、α、β 以及 γ 频段嗅觉脑电在
气味识别中的作用进行了深入剖析,提出了有创新性的 FBANet 模型,该模型将 FBFM 和
SelfAM 相结合,可有效挖掘并整合嗅觉脑电中的多频段特征,在 8 种气味分类任务中取得
了 98.92%的识别准确率以及 98.75%的 F1 分数,优于现有的先进方法。消融实验证实了
ECA 模块和自注意力模块的有效性,同时探索了 MHA 模块中的头数对模型识别性能的影
响,最终确定最佳头数为 40。研究显示,单频段分析方法在表征复杂食品气味诱发的脑电
特征方面存在局限性,而多频段方法可更全面地捕捉气味刺激所引发的深层特征信息。
FBANet 模型呈现出了出色的分类能力与稳定性,能精准区分复杂气味,在食品感官评价
里也有着广泛的应用潜力,未来计划优化模型设计,探索其在更复杂嗅觉任务以及其他脑
电领域的应用前景,以此推动多频段脑电分析方法的研究和实际应用,为脑电技术的跨领
域发展提供新的理论支撑和技术手段。


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
33
第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好
识别方法
在看似分离的事物中,总存在一种深层次的联系,正是这种联系赋予了它们意义。
——德国哲学家、数学家戈特弗里德·威廉·莱布尼茨
莱布尼茨曾提醒众人,那些表面上看似相互分离的事物,往往潜藏着深层次的内在联
系,而正是这种联系可帮助我们更为深入地理解事物本身。在气味感官评估领域,电子鼻
与嗅觉脑电这两种看似全然不同的技术,它们各自所捕捉到的信息是否彼此孤立无关呢?
还是说,在它们之间存在着某种尚未被充分挖掘的协同关系呢?我们运用多模态学习方法
将电子鼻所获取的物质理化信息同嗅觉脑电所包含的神经电活动信息相结合,以此来揭示
这种深层次的内在联系。那么,此方法能否协助我们更加全面且准确地识别出跨被试者的
嗅觉偏好呢?又是否可为未来的感官评估方法带来全新的启示呢?
3.1 引言
我们在第 2 章中探讨了多频段特征在嗅觉脑电分析中的意义,并提出了 FBANet 模型
来整合不同频段信息以达成精准的气味分类,不过嗅觉体验不仅涉及气味识别,还囊括个
体的情感及偏好反应,这给气味感知识别提出了更高要求,怎样超越传统的物理化学检测
手段来解析人类对气味的主观感知是急需解决的问题。机器嗅觉技术的兴起为气味感知识
别提供了支持,电子鼻作为代表性应用,将有交叉敏感性的电化学传感器阵列和模式识别
技术相结合,可快速且客观地检测气味,被广泛应用于食品质量评估等领域。但电子鼻主
要衡量气味的物理化学属性,无法解析人类的情感和偏好体验。
近年来,脑电技术不断发展,这为嗅觉偏好的客观评估带来了新的可能。脑电信号可
直接反映出大脑的情绪以及感知方面的信息,通过对嗅觉脑电的解码,便可以比较客观地
评估人类对于气味的偏好情况。不过人类个体之间存在差异,这使得跨被试者的嗅觉脑电
识别遭遇诸多险阻,因此研究人员试着引入领域自适应等方法来提升模型的泛化能力。然
而现有的方法大多时候过度依赖目标域数据,而且计算复杂度也比较高,致使跨被试者的
嗅觉脑电识别依旧面临着巨大的挑战。嗅觉脑电与电子鼻技术的评估流程如图 3-1 所示,
主要涉及信号采样以及数据识别,电子鼻传感器有良好的稳定性,其实验有较高的可重复
性,这在很大程度上降低了跨样本识别的难度。但是电子鼻仅仅可检测气味,却无法表征
个体偏好。相比较而言,嗅觉脑电可揭示气味感知与情绪反应之间的联系,能更全面地表


东北电力大学工学博士学位论文
34
征个体嗅觉偏好,然而因为个体差异以及脑电的复杂性,跨被试者的嗅觉脑电识别受到了
严重限制。
多模态学习可整合不同信号中的互补信息,在 EEG 与 fNIRS 相结合以及面部表情与
脑电相结合的一系列研究中有了初步进展。受多模态学习的启发,我们试图通过多模态学
习技术将电子鼻的高重复性优势跟嗅觉脑电的神经信息长处相结合,达成两者间的信息互
补,以此更精确地呈现个体在气味识别过程中的共性与差异性特点。因此我们提出一种基
于嗅觉脑电与电子鼻信号的跨被试者气味偏好识别方法,通过多模态学习技术将电子鼻的
物理化学信息和嗅觉脑电的情感感知信息融合,实现对个体气味偏好的全面建模,该方法
充分运用了电子鼻的跨样本识别能力,又最大限度地发挥了嗅觉脑电的情感识别优势,突
破了单一技术的限制,在数据采集、预处理、多模态融合等方面进行了具有建设性的工作。
实验结果显示,所提出方法的跨被试者嗅觉偏好识别能力要优于现有先进方法,为嗅觉偏
好识别的实际应用提供了技术支撑。
图 3-1 嗅觉脑电和电子鼻技术的气味评估流程
Figure 3-1 The odor assessment process of olfactory EEG and electronic nose technology
3.2 多模态数据集构建
3.2.1 实验平台
电子鼻能够捕捉气味的物质理化信息,而嗅觉脑电则反映情感与认知反应,将二者融
合可实现优势互补,构建更全面的气味感知模型。电子鼻与嗅觉脑电的数据采集平台如下。
电子鼻采样系统的整体结构如图 3-2 所示,主要由 WS-30A 气敏元件测试系统(郑州
炜盛电子科技有限公司,中国)、PEN3 电子鼻(Airsense Analytics GmbH,Germany)和联


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
35
想 Thinkpad 笔记本电脑(联想集团有限公司,中国)组成。其中,WS-30A 系统由气体扩
散箱、活性炭过滤器和疏气风扇构成。PEN3 电子鼻集成了气体传感器阵列、信号处理装置
及模式识别系统,传感器阵列内包含 10 个金属氧化物传感器,其主要性能见表 3-1。不同
传感器对气体的敏感度各异,在气体接触过程中会发生氧化还原反应,导致传感器电阻随
着气体分压的变化而增大或减小。气体信息通过电导率值 G/G0 检测,其中 G 为传感器与
样品接触时的电导率值,G0 为传感器与活性炭所过滤的空气接触时的电导率值。在信号采
集过程中,外部气体经活性炭过滤器处理后进入气体扩散箱,并通过疏气风扇实现均匀分
布,随后气体流入电子鼻与气体传感器充分接触。最终,通过信号处理装置采集传感器电
导率信号,并传输至计算机进行模式识别分析。
图 3-2 电子鼻采样系统结构
Figure 3-2 The Electronic nose sampling system structure
表 3-1 电子鼻传感器的参数表
Table 3-1 Parameter table of electronic nose sensor
序号 名称 敏感性 检测限值 (ppm)
1 W1C 芳香族化合物 10 2 W5S 氮氧化物 1 3 W3C 氨,芳香族化合物 10 4 W6S 氢 100 5 W5C 烯烃,芳香成分 1
6 W1S 广泛检测甲烷 100 7 W1W 硫化合物和有机硫化合物 1
8 W2S 广泛检测醇类 100 9 W2W 芳香成分,含硫有机化合物 1 10 W3S 甲烷和脂肪族化合物 10


东北电力大学工学博士学位论文
36
嗅觉脑电数据的采集通过自主研发的低噪声、高稳定的嗅觉脑电诱发系统得以实现,
此系统是由空气发生器、WS-30A 系统、气体扩散模块以及控制模块共同构成的,当中 WS
30A 配气盒的进气口与空气发生器相连,出气口和气体扩散模块相接,最终经由气体扩散
模块将实验气味传送到被试者鼻腔前部。在这个过程中,WS-30A 内的疏气风扇一直以恒
定功率运转,以保证气体扩散箱内气体的均匀分布,控制模块承担着控制嗅觉刺激定时与
定量的工作,保障实验的精确性。
本章实验中所用的嗅觉脑电采集系统和第 2 章 2.2.1 中所描述的系统相同,其中涉及
了设备配置、采样频率以及电极布置等方面,详细信息可查看第 2 章的相关内容。
3.2.2 被试者与实验材料
研究方案严格遵循《赫尔辛基宣言》(修订版)的相关要求,获得了东北电力大学科学
研究伦理与科技安全委员会的批准。本实验共招募 24 名右利手被试者(14 名男性,10 名
女性,年龄 22 至 26 岁),所有被试者在实验前均已签署知情同意书,并无感冒、嗅觉或精
神疾病史。
实验材料包括栀子香水、苋菜卤水、鱼腥草泥和桃子果酱,气味经静置 3 分钟后用于
唤起嗅觉脑电和电子鼻信号,具体材料信息见表 3-2。
表 3-2 四种实验材料的信息
Table 3-2 Information about the four experimental materials 序号 气味 成分说明
1 花香味 0.1 mL 栀子花香水,30 mL 蒸馏水
2 臭味 20 mL 苋菜卤水,30 mL 蒸馏水
3 鱼腥味 10 g 鱼腥草泥,30 mL 蒸馏水
4 果香味 20 g 桃子果酱,30 mL 蒸馏水
图 3-3 嗅觉脑电和电子鼻信号采集流程
Figure 3-3 Olfactory EEG and electronic nose signal acquisition process


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
37
3.2.3 数据采集与预处理
实验数据采集过程如图 3-3 所示,在嗅觉脑电采集环节,每位被试者都要进行 6 次平
行实验,且相邻两次实验的间隔为 24 小时,每次实验囊括 4 种不同的气味刺激,每种气味
进行 30 秒的数据采集,采集完成之后安排 30 分钟的休息时间,以避免被试者出现疲劳状
况。脑电与电子鼻信号的采集是同步的,以保证样本的一致性,每种气味会采集 10 组数
据,每组数据的采集时长为 90 秒。在采集开始前,气体传感器阵列会进行 60 秒的清洗,
以便使其恢复到基线状态,保证所获取的数据准确且可靠。
图 3-4 电子鼻数据曲线
Figure 3-4 Electronic nose data curve


东北电力大学工学博士学位论文
38
图 3-4 展示了 PEN3 电子鼻系统中传感器阵列的响应曲线情况,该响应曲线先是快速
上升随后趋于稳定状态,不同传感器的响应存在差异,这种差异可反映出气味的物理化学
特性,对比图 3-4(a)至(d)可以看出花香气、臭味、鱼腥味以及果香味在理化性质方面
存在差异。而图 3-4(d)至(f)则显示出电子鼻在检测相同气味时,其信号有客观性与稳
定性,和脑电信号相比,电子鼻从相同气味样本中采集到的信号差异相对较小,这对嗅觉
脑电在跨被试者识别方面的不足起到了弥补作用。
最终,本实验共采集 24 名被试者在 4 种气味刺激下的嗅觉脑电数据。每种气味会刺
激每名被试者 6 次,每次持续 30 秒,取 30 秒数据中的第 1 至 21 秒并将其分割为长度为 2
秒的样本。然后,对样本进行 0.5-45 Hz 带通滤波,并将采样频率从 256 Hz 降至 128 Hz。
最终生成了 5760(24×4×6×10)个嗅觉脑电样本,并依据图 3-5 所示的被试者嗅觉偏好设
置对应标签。电子鼻信号以 1 Hz 采样,样本长度为 90 秒,共得到 5760 个电子鼻样本。最
终,将嗅觉脑电样本与实验期间平行采集的电子鼻样本一对一配对,共生成 5760 个多模态
样本,其样本标签与嗅觉脑电样本一致。
图 3-5 被试者嗅觉偏好统计结果
Figure 3-5 The statistical results of subjects' olfactory preferences
3.3 多模态协同学习方法
3.3.1 方法框架
人类嗅觉偏好的形成受到气味特性和个体差异的双重影响。本文提出的方法通过建立
嗅觉脑电与电子鼻信号之间的交互机制,能够有效挖掘用于表征嗅觉偏好的共性特征,并
提取嗅觉脑电中反映个体差异的个性特征。最终,将共性特征与个性特征结合,以全面表
征个体的气味偏好。所提出的脑-机融合教师网络(Brain-Machine Fusion Teacher Network,
BMFNet-T)模型如图 3-6 所示,模型主要包括以下四个模块:特征挖掘与对齐(Feature
Mining and Alignment,FMA)模块、多模态特征交互(Multimodal Feature Interaction,MFI)
模块、脑电特征挖掘(EEG Feature Mining,EFM)模块和多模态特征融合(Multimodal Feature
Fusion,MFF)模块,具体方法流程如下。
首先,通过 AlexNet[94]和 ResNet[91]提取电子鼻信号与嗅觉脑电的初始特征。紧接着,


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
39
通过对比损失函数对两种模态的初始特征进行对齐,以保证跨模态特征有相似的分布特
性。随后,把对齐后的嗅觉脑电特征和电子鼻特征输入至 MFI 模块,充分提取出可体现被
试者嗅觉偏好的共性特征。运用 EFM 模块挖掘对齐后的嗅觉脑电的个性特征,用来反映
被试者的嗅觉偏好差异,依靠 MFF 模块将共性特征与个性特征相结合,实现对不同被试者
嗅觉偏好的准确识别,此方法能充分利用嗅觉脑电与电子鼻信号的互补信息,在共性与个
性特征之间取得良好平衡,有效提高了嗅觉偏好识别的精度与稳定性。
图 3-6 BMFNet-T 模型框架 Figure 3-6 BMFNet-T model framework
3.3.2 特征挖掘和对齐
嗅觉脑电的复杂性明显高于电子鼻信号,因此,采用深度网络更适合挖掘嗅觉脑电的
特征。在 FMA 模块中,使用浅层网络 AlexNet 和深层网络 ResNet 分别提取电子鼻信号和
嗅觉脑电的初始特征。首先,电子鼻和嗅觉脑电的单模态样本数据分别被重塑为尺寸为(1,
10,90)和(1,21,256)的形式。随后,通过调整卷积核尺寸、步长、填充大小、输出
通道数、池化核尺寸以及池化步长等参数,确保从电子鼻和嗅觉脑电中所提取的单模态初
始特征具有相同的尺寸。最终,AlexNet 和 ResNet 输出的单模态特征尺寸分别为(64,1,
5)和(160,1,2),然后这些特征被进一步重塑为相同的尺寸,即(1,16,20)。此时,
已经获得了嗅觉脑电和电子鼻信号的初始特征,但该初始特征尚未对齐。为了实现更好的
多模态特征融合,采用均方误差(Mean Squared Error,MSE)损失对初始特征进行对齐[95],
通过优化初始特征的分布,使来自不同模态的特征在同一特征空间中具有更高的一致性,
从而为后续的多模态特征交互和融合提供支持。
3.3.3 共性和个性特征挖掘
对齐后的初始特征 m 和 b 被输入 MFI 模块,以建立嗅觉脑电和电子鼻信号之间的交
互,挖掘反映被试者嗅觉偏好的共性特征。MFI 模块主要由交替连接的跨模态注意力模块


东北电力大学工学博士学位论文
40
和自注意力模块组成。第 1 个跨模态注意力模块的输出 Z1 作为第 1 个自注意力模块的输
入。然后,第 1 个自注意力模块的输出 S1 与初始特征 m 一起作为第 2 个跨模态注意力模
块的输入。最后,第 2 个跨模态注意力模块的输出 Z2 输入第 2 个自注意力模块,得到最终
输出 S2。
图 3-7 跨模态注意力模块
Figure 3-7 Cross-modal attention module
跨模态注意力模块的结构如图 3-7(a)所示。该模块主要涉及嵌入(Embedding,Emb)、
LN、Linear、MHA 和 MLP。首先进行 Emb 操作,利用二维卷积将尺寸为 1×16×20 的 m 和
b 特征分别重新构建成二维补丁,二维卷积的核尺寸以及步长均为 1×2,因此可获得包含
160 个标记的补丁,以此保证每个特征信息都可被有效地重新构建。为了保留有效信息,
卷积的输出通道数被设定为 320,在 Emb 过程中,需要在补丁之前添加分类标记,从而得
到数据形式为 161×320 的单模态特征。接着运用 LN 对单模态特征进行标准化处理,以保
证特征分布的稳定性。然后将经过标准化后的特征与可优化矩阵相乘以实现线性化,得到
MHA 的三个输入:Qm、Kb 以及 Vb。其中 Qm 用于挖掘反映被试者嗅觉偏好的共性特征,
Kb 和 Vb 分别代表嗅觉脑电中的关键特征信息以及所有特征,然后将 Qm、Kb 和 Vb 输入 MHA,
以挖掘被试者间的共性特征,MHA 的输出与 m 相加,得到中间结果 Y,然后 Y 经过 LN 和


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
41
MLP 处理,其中 MLP 由两个 FC 层构成,在 FC 层中插入 GELU 激活函数,让模型训练过
程更加稳健。最后将 MLP 的输出与 Y 相加,得到跨模态注意力模块的输出 Z,计算公式如
下:
MHA( , , ) Emb( )
m bb
Y = Q K V + m (3-1)
Z = MLP(LN(Y )) + Y (3-2)
其中 Qm 代表在跨模态注意力模块中电子鼻数据经过 Emb、LN 和 Linear 处理后的查
询值。它的作用是找出反映被试者嗅觉偏好的共同特征。Kb 和 Vb 表示在跨模态注意力模
块中嗅觉脑电数据经过 Emb、LN 和 Linear 处理后所得到的关键特征信息(Kb)和所有特
征(Vb)。m 表示 AlexNet 输出的电子鼻特征。
MHA 是跨模态注意力模块的核心,能够充分利用多模态特征。与单头注意机制相比,
MHA 的多头结构能够更全面地建模不同模态复杂子空间之间的交互。MHA 的计算流程如
图 3-7(b)所示。首先,将输入的 Qm、Kb 和 Vb 从 161×320 沿第 2 维度扩展到 161×8×40。
然后将扩展后特征的第 1 维度和第 2 维度互换,得到多头特征 Qh、Kh,和 Vh,其中头的数
量为 8。其次,互换 Kh 的第 2 维度和第 3 维度,并随之将 Kh 与 Qh 相乘后除以缩放系数 d。
接着,将缩放结果输入 Softmax 层,再与 Vh 相乘,得到多头特征。最后,将多头特征的第
1 维度和第 3 维度连接,生成整合后的多头子特征,并将整合后的特征乘以可优化矩阵 Wh,
得到 Linear 的输出 X。计算公式如下:
Concat(softmax( ) )
×
= ××
T hh hh
QK
X VW
d (3-3)
其中,T 表示第 2 和第 3 维度的互换,d=√40,Concat 表示合并特征矩阵的第 1 和第
3 维度。Qm、Kb 和 Vb 分别沿第 2 维度从 161×320 扩展到 161×8×40,从而得到 Qh、Kh 和
Vh,然后交换扩展后特征的第 1 维度和第 2 维度的多头特征。Wh 是可优化的矩阵。
自注意力模块的结构与跨模态注意力模块类似。包含相同的 Emb、LN、Linear、MHA
和 MLP 组件。不同之处在于,自注意力模块的输入为单模态特征矩阵,只需依次经过 Emb、
LN 和 Linear 处理即可。EFM 模块则用于挖掘嗅觉脑电中反映人类气味偏好的个性特征,
该模块由四个串联的自注意力模块组成,其结构与 MFI 模块中的自注意力模块相同。输入
特征 b 的尺寸为 1×16×20,输出特征 B 的尺寸为 161×320。
3.3.4 多模态特征融合
对于多模态特征融合,特征序列 S2 和 B 的分类标记被拼接成尺寸为 1×640 的特征序
列,并被重塑为 1×16×40 尺寸的特征矩阵后输入到 MFF 模块中。MFF 模块由四个串联的
多模态融合自注意力模块组成,其自注意力模块的结构与 EFM 模块中的自注意力模块类
似,仅在 Emb 的设计上略有不同。MFF 模块中 Emb 部分的二维卷积核尺寸和步长均为


东北电力大学工学博士学位论文
42
2×4,输出通道为 320,重构的补丁中有 80 个标记。随后,在重构后的补丁前添加分类标
记,得到尺寸为 81×320 的特征序列。然后,多模态特征在经过四个串联的多模态融合自注
意力模块后,得到尺寸为 1×320 的分类标记。最终,该分类标记被输入 FC 层,并通过
Softmax 层生成对个体嗅觉偏好的预测结果。
在 BMFNet-T 模型中,MFI 和 MFF 模块的参数设置如表 3-3 所示。模型主要由 Emb
模块、MHA 模块和 MLP 模块组成。在 MFF 模块中,MLP 的 FC 层维度被设置为 MFI 模
块中对应部分的 4 倍,旨在更好地融合由 EFM 模块提取的个性化特征和 MFI 模块提取的
共性特征。在 MFF 和 MFI 模块的 MLP 中,随机失活正则化(Dropout Regularization,
Dropout)被设置为 0.3,以通过适度的正则化防止过拟合,同时在多模态特征融合过程中
增强模型对个性化特征和共性特征的整合能力,从而提高模型对嗅觉偏好预测的能力。此
外,EFM 模块的参数设置与 MFI 模块相同,因此在表中未单独列出。
表 3-3 BMFNet-T 模型参数设置 Table 3-3 BMFNet-T model parameter settings 模块 子模块 参数名 详细信息
MFI Emb 特征尺寸 16 × 20
Patch 尺寸 1 × 2 Emb 维度 320 MHA 注意力层数 4
注意力头数 8 Dropout 0.3
激活函数 GELU 激活函数 MLP FC 层维度 160 Dropout 0.3
激活函数 GELU 激活函数 MFF Emb 特征尺寸 16 × 40
Patch 尺寸 2 × 4 Emb 维度 320 MHA 注意力层数 4
注意力头数 8 Dropout 0.3
激活函数 GELU 激活函数 MLP FC 层维度 640 Dropout 0.3
激活函数 GELU 激活函数
3.3.5 多模态知识蒸馏
知识蒸馏是一种领域适应技术,用于将教师模型的知识转移到学生模型中,从而实现
Params 和 FLOPs 的减少,同时保持学生模型的识别能力与教师模型相当。在本研究中,知
识蒸馏技术被用于优化 BMFNet-T 模型的多模态知识,从而提升识别效率。脑-机融合学生


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
43
网络(Brain Machine Fusion Student Network,BMFNet-S)模型的主要组成模块包括 FMA、
MFI、EFM 和 MFF,其结构较 BMFNet-T 模型有所简化:FMA 模块中仅包含 1 个串联的
跨模态注意力模块和 1 个自注意力模块,EFM 模块仅包含 2 个串联的自注意力模块,MFF
模块则仅包含 2 个串联的多模态融合自注意力模块。
多模态知识蒸馏的框架如图 3-8 所示,通过优化损失函数 Loss1,Loss2,Loss3,Loss4,
和 Loss5,将 BMFNet-T 模型的知识提炼为 BMFNet-S 模型的核心能力。其中,对于 MFI 模
块,BMFNet-T 模型的第 2 个跨模态注意力模块和第 2 个自注意力模块分别被用于指导
BMFNet-S 模型中的跨模态注意力模块和自注意力模块。对于 EFM 模块,BMFNet-T 模型
的 2 个和 4 个自注意力模块分别被用于指导 BMFNet-S 模型的第 1 个和第 2 个自注意力模
块。对于 MFF 模块,BMFNet-T 模型的第 2 个和第 4 个多模态融合自注意力模块分别被用
于指导 BMFNet-S 模型的第 1 个和第 2 个多模态融合自注意力模块。此外,BMFNet-T 模
型的 FC 层和 Softmax 层也分别被用于指导 BMFNet-S 模型中的 FC 层和 Softmax 层。
图 3-8 多模态知识蒸馏
Figure 3-8 Multimodal knowledge distillation
(1)自注意力知识蒸馏被用于 MFI、EFM 和 MFF 模块中的自注意力部分,具体流程
如图 3-9 所示,主要包括注意力蒸馏和隐藏状态蒸馏两部分。其中,注意力蒸馏能够更有
效地捕捉和传递多模态特征间的关联知识,其定义如下:
attn 1
1 MSE( , )
=
= ∑h T S
ii
i
L AA
h (3-4)


东北电力大学工学博士学位论文
44
其中,h 为注意力头数, ×
∈

ll
Ai 表示 BMFNet-T 或 BMFNet-S 中自注意力部分中第 i
个头对应的注意力矩阵,l 为输入序列的长度。
隐藏状态蒸馏用于充分提炼多模态知识,其定义如下:
Lhidn=MSE(HT,HS) (3-5)
其中,矩阵 T l e
H×
∈
 和 S le
H×
∈
 分别表示 BMFNet-T 和 BMFNet-S 中自注意力部分的隐
藏状态,标量值 e 表示其中隐藏状态的大小。
Loss1,Loss2 和 Loss3 的表达如下:
11
Module ( )
==
=+
∑∑
nn j j attn hidn
ii
Loss L L (3-6)
其中 j=1、2、3。Module1、Module2 和 Module3 分别表示 MFI、EFM 和 MFF 模块中用
于蒸馏的自注意力模块,n 是其对应自注意力模块的数量。
图 3-9 自注意力知识蒸馏
Figure 3-9 Self-Attention knowledge distillation
(2)FC 层的知识蒸馏的表达如下:
4 = MSE( T , S )
Loss I I (3-7)
其中, ∈ 
e
IT 和 ∈ 
e
IS 分别表示 BMFNet-T 和 BMFNet-S 中的 FC 层特征。
(3)Softmax 层的知识蒸馏的表达如下:
2
5 = KL(log( ), log( )) ×
S
TP
P
Loss T
T T (3-8)
其中,KL(  )是 Kullback-Leibler 散度损失函数, ∈ 
c
PT 和 ∈ 
c
PS 分别表示 BMFNet
T 和 BMFNet-S 中的 Softmax 层特征。c 是样本标签数,T 是蒸馏温度。


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
45
最终,BMFNet-T 模型用以下蒸馏损失函数指导 BMFNet-S 模型的优化:
12345
=++++
soft
L Loss Loss Loss Loss Loss (3-9)
算法 3-1 描述了多模态知识蒸馏的过程。其步骤为 BMFNet-T 模型训练、BMFNet-S 模
型训练以及 BMFNet-T 模型指导 BMFNet-S 模型训练。BMFNet-T 模型使用以下损失函数
进行训练:
= MSE( , ) + CE( , )
T TT T
Loss m b P label (3-10)
其中 CE(  )表示两个概率分布之间的交叉熵,mT 和 bT 分别是 BMFNet-T 模型中对
齐的嗅觉脑电特征和电子鼻特征。 ∈ 
c
PT 表示教师模型中的 Softmax 层特征。
BMFNet-S 模型通过如下损失函数进行硬标签训练:
= MSE( , ) + CE( , )
hard S S S
Loss m b P label (3-11)
其中 mS 和 bS 分别是 BMFNet-S 模型中对齐的嗅觉脑电特征和电子鼻特征。
在使用硬标签和软标签损失联合训练 BMFNet-S 模型时,需要优化的 S
Loss 如下:
(1 )
S hard soft
Loss = α× L + −α × L (3-12)
其中α∈ (0,1) ,是用于优化 S
Loss 的超参数。
算法 3-1 多模态知识蒸馏流程
输入:训练集数据 X={x1, x2, ···,xn},分别初始化
BMFNet-T 和 BMFNet-S 的网络参数 θt 和 θs. 超参数:Batch,Epochs,N_batch j = n / Batch 1: for each batch sequence pair Xj∈X do
2: X = {X1,X2, ···,XN_batch}
3: end
4: /*训练 BMFNet-T 模型*/ 5: for i =1,2, ···,Epochs do 6: for j = 1,2, ···,N_batch do
7: loss(θt)←BMFNet-teacher(Xj,θt) 8: update θt 9: end 10: end
11: /*训练 BMFNet-S 模型*/
12: for i = 1,2, ···,Epochs do
13: for j = 1,2, ···,N_batch do
14: loss(θs)←BMFNet-S(Xj,θs) 15: update θs 16: end
17: for j = 1,2, ···,N_batch do 18: Wt ←BMFNet-T(Xj,θt) 19: loss(θs),Ws←BMFNet-S(Xj,θs) 20: loss(θs)=loss(θs)+loss(Wt,Ws) 21: update θs 22: end 23: end


东北电力大学工学博士学位论文
46
3.4 实验结果与分析
3.4.1 模型设置与评价指标
本研究对当前广泛应用的单模态数据识别方法 AlexNet[94]、ResNet18[91]、EEGNet[92]、
VGG11[96]、DenseNet[97]、ShuffleNetV2[98]、MobileNetV2[99]和 EfficientNetV2[100]进行了讨论。
另 外 将 先 进 的 多 模 态 数 据 识 别 方 法 M2NN[54] 、 MBERT[101] 、 MulT[102] 、 ViLT[103] 和
MMASleepNet[104]和本文所提的多模态学习方法也进行了对比分析。本研究针对每种方法
都开展了 24 次独立分类实验,把每位被试者的样本逐个当作测试集,其余被试者的样本逐
个当作训练集,训练集的批量大小是 240,迭代次数为 100。运用 Adam 优化器来优化模
型,学习率是 0.00005,权重衰减因子为 0.001,为了优化模型性能,超参数 α 设置成 0.3,
蒸馏温度 T 设置成 3,为了综合评估模型的分类表现,本研究采用准确率、F1 分数、召回
率以及精确度当作评价指标,从多个维度全面衡量模型性能。
3.4.2 多模态知识蒸馏
表 3-4 展示了 BMFNet-T 和 BMFNet-S 模型在跨被试者嗅觉偏好识别任务中的分类性
能和模型复杂度。与 BMFNet-T 模型相比,BMFNet-S 模型的 Params 和 FLOPs 减少了 40%
以上,但两者的识别性能并没有明显差异。因此,所提出的知识蒸馏方法在保证模型分类
性能的同时,可有效提高了模型的识别效率。
表 3-4 BMFNet-T 和 BMFNet-S 模型的比较 Table 3-4 Comparison of BMFNet-T and BMFNet-S models 评估指标 BMFNet-T BMFNet-S
Params(M) 9.06 5.35 (↓ 3.71) FLOPs(G) 257.74 148.39 (↓ 109.35) 准确率(%) 92.88 92.79 (↓ 0.09) F1 分数(%) 92.71 92.64 (↓ 0.07) 召回率(%) 92.93 93.11 (↑ 0.18) 精确度(%) 92.55 92.42 (↓ 0.13)
3.4.3 单模态分析
单模态模型的分类结果如表 3-5 所示,可以看出 RestNet18 和 AlexNet 在嗅觉脑电与
电子鼻信号的识别任务中各自取得了最优的识别结果,深层的网络架构在嗅觉脑电识别过
程中通常具有有较大优势,而相对浅层的网络架构或许更适合电子鼻信号的识别。这充分
说明不同类型的信号对于模型的网络深度有着不一样的要求,因个体间脑电存在差异,基
于嗅觉脑电的跨被试嗅觉偏好识别任务面临较大困难,其识别准确率及其他评估指标基本
都低于 70%。对于电子鼻而言,同类样本间微小的特征分布差异提高了它的跨样本识别能
力,不过电子鼻信号在表达个体嗅觉偏好方面依然存在一定的局限性。虽然其整体识别效


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
47
果要优于嗅觉脑电,但是在某些特定个体中,嗅觉偏好会被全部误识。
T-分布随机邻域嵌入(T-distributed Stochastic Neighbor Embedding,t-SNE)方法是一
种用于分析特征提取方法有效性的工具[105]。图 3-10 展示了 RestNet18 和 AlexNet 分别在
嗅觉脑电和电子鼻信号识别任务中 FC 层所提取特征的 t-SNE 可视化效果,其中浅蓝色、
紫色、绿色和粉红色分别表示来自训练集中的喜欢标签和厌恶标签、测试集中的喜欢标签
和厌恶标签所对应的样本。从图 3-10(a)与图 3-10(b)的对比可以看出,与嗅觉脑电的
特征相比,电子鼻信号的特征具有更好的可分性。
表 3-5 先进的单模态识别方法的识别结果
Table 3-5 Recognition results of advanced single-modal recognition methods
图 3-10 单模态识别模型的特征分析
Figure 3-10 Feature map analysis of unimodal recognition models
在跨被试者嗅觉偏好识别任务中,由于嗅觉脑电存在着十分突出的个体差异以及高度
复杂的信号特征,使得模型很难提取出可反映气味偏好的共性与个性特征,而针对相同气
味的电子鼻样本而言,其气味的特征空间差异相对较小,呈现出较高的客观性与稳定性,
这意味着电子鼻在表达气味的理化信息方面有一定优势。图 3-10(b)也说明,不管是在训
练集还是测试集中,都存在少数样本被错误分类的情况,这些样本的特征空间和另一类样
本十分接近,电子鼻可有效表达气味的理化信息,然而却无法全面反映个体对气味的偏好。
经过更深入的分析可明确,电子鼻仅能提取气味的理化特征,却无法捕捉体现嗅觉偏
Method EEG(%) 电子鼻(%)
准确率 F1 分数 召回率 精确度 准确率 F1 分数 召回率 精确度
AlexNet 54.24 68.74 96.94 54.26 90.28 90.90 89.11 92.95 EEGNet 54.05 64.62 89.83 52.15 78.30 72.28 69.93 84.40 VGG11 54.17 69.53 97.14 54.17 88.56 88.52 87.26 93.84 RestNet18 64.29 64.85 72.74 63.22 89.03 91.21 94.87 89.46 DenseNet 64.13 64.40 74.76 61.34 83.56 87.80 97.09 82.34 ShuffleNetV2 60.80 60.89 71.05 60.62 85.57 88.62 95.65 84.72 MobileNetV2 61.63 59.95 61.16 58.81 85.28 84.52 87.21 83.77 EfficientNetV2 56.39 56.79 79.10 44.86 84.58 87.60 94.85 83.04


东北电力大学工学博士学位论文
48
好的个性化信息,当个体的嗅觉偏好被当作电子鼻信号的标签时,相同气味的电子鼻信号
有可能对应不一样的标签,在该情况下,如果依旧依靠气味的理化特征来进行分类,就可
能出现对某些特定嗅觉偏好样本的误识。因此,多模态数据融合对弥补单一模态数据的局
限性十分关键,可帮助提高模型在嗅觉偏好识别任务中的准确性。
3.4.4 多模态分析
为了更全面地评估所提出方法的识别性能,该方法与当下主流的多模态数据识别方法
进行了比较,相应结果如表 3-6 所示,所提出的方法在准确率、F1 分数、召回率以及精确
度等各项指标上表现出较大优势,这验证了该方法的有效性。
表 3-6 本文提出的方法与先进的多模态识别方法的比较
Table 3-6 Comparison of the proposed method with advanced multimodal recognition methods
Method 准确率(%) F1 分数(%) 召回率(%) 精确度(%)
MMASleepNet 79.69 77.59 76.17 79.66 mBERT 90.16 90.79 91.82 90.19 M2NN 90.21 86.67 88.21 85.63 MulT 90.73 90.84 91.35 90.45 ViLT 90.85 90.24 90.77 89.98 BMFNet-S 92.79 92.64 93.26 92.42
在本节我们利用 t-SNE 方法对多模态模型在 FC 层的特征进行可视化分析,并选择
ViLT 和 MulT 模型与所提出的 BMFNet-S 模型进行对比,其中浅蓝色、紫色、绿色和粉红
色分别表示来自训练集中的喜欢标签和厌恶标签、测试集中的喜欢标签和厌恶标签所对应
的样本。ViLT 是一款紧凑型视觉语言自注意力模型,它主要通过自注意力模块实现模态间
的高效交互,其核心思想是优化模态间的协同表达,而非提高单模态的特征嵌入,在效率
和性能之间实现了较好平衡。MulT 是面向多模态序列的自注意力模型,在定向的跨模态注
意力方面表现突出,该模型可捕捉多模态数据间时序的动态交互信息,无需显式对齐模态
数据,在信息交互方面,MulT 可依据任务需求动态调整模态间的信息传递路径,以此建模
复杂的模态间关系。通过 ViLT、MulT 和 BMFNet-S 模型间的比较可揭示不同模型在特征
提取与模态交互上的差异,分析所提出方法在多模态融合与嗅觉偏好识别任务中的优势。
图 3-11 所示的 t-SNE 可视化结果展示了 ViLT、MulT 和 BMFNet-S 模型在多模态识别
任务中的表现,其中被试者 7 的多模态样本被用作测试集,而其他被试者的样本则被当作
训练集。观察图 3-11(a)可以看出,ViLT 模型利用自注意力模块实现了对嵌入的嗅觉脑
电以及电子鼻数据的良好处理,构建起初始的多模态特征空间。然而从测试集样本的特征
分布状况可看出,部分“喜欢”与“厌恶”类别的样本在特征空间中出现了混叠现象,这意味
着,ViLT 模型在多模态信息的整合环节存在欠缺之处,无法充分提取出可体现个人嗅觉偏
好的关键特征。3-11(b)展示了 MulT 模型的性能表现,其跨模态注意力机制有效地促进
了多模态间的信息交互,捕捉了多模态序列的交互特征,并且在一定程度上整合了与个体


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
49
嗅觉偏好相关的特征。然而观察测试集样本的特征空间可以发现,少量“喜欢”和“厌恶”样
本依旧难以区分,MulT 模型提取的特征在表达嗅觉偏好方面还不够全面。相较而言,所提
出的 BMFNet-S 模型有效地为多模态样本构建了特征空间,其特征空间如图 3-11(c)所
示,训练集和测试集中的各类别间表现出较大的可分性。从结果可看出,BMFNet-S 模型
在整合嗅觉脑电和电子鼻信息方面表现出色,可有效地挖掘出多模态数据中反映个体嗅觉
偏好的特征,其优势表明,BMFNet-S 在多模态特征提取与融合方面能力更为突出,有效
地实现了个体嗅觉偏好的识别。
图 3-11 多模态识别模型的特征分析
Figure 3-11 Feature map analysis of multimodal recognition models
3.4.5 消融实验
在该部分内容,我们通过消融实验验证 BMFNet-S 模型在结构设计上的合理性。
BMFNet-S 是由 EFM、MFI 以及 MFF 这三个核心模块组合而成的,其中 EFM 模块的作用
是从嗅觉脑电中提取个性特征,以此来表征被试者独特的嗅觉偏好,MFI 模块则是从嗅觉
脑电与电子鼻数据里提取共性特征,找出被试者嗅觉偏好的普遍规律。而 MFF 模块用于融
合个性与共性特征,形成更为全面的特征表示,该实验按照以下步骤验证了各模块以及相
关设计的有效性:
(1)初步探究各模块的有效性。观察 EFM、MFI 和 MFF 模块的输出特特征,分析各
模块在特征提取过程中的贡献。
(2)模块移除对比实验。分别移除 BMFNet-S 中的关键模块,构建对比模型。移除
MFI 和 AlexNet 子模型,构建 BNet-S 模型。移除 MFI 和 RestNet 子模型,构建 MNet-S 模
型。通过比较 BNet-S、MNet-S 和 BMFNet-S 的分类性能,验证 MFI 模块在挖掘嗅觉偏好
的共性特征方面的必要性。
(3)分析 EFM 模块和对比损失的作用,分析 EFM 模块和对比损失对模型性能的影
响,验证其在跨被试者嗅觉偏好识别中的作用。
图 3-12(a)、图 3-12(b)和图 3-12(c)分别显示了 BMFNet-S 中 EFM、MFI 和 MFF


东北电力大学工学博士学位论文
50
模块输出特征的可视化效果,其中浅蓝色、紫色、绿色和粉红色分别表示来自训练集中的
喜欢标签和厌恶标签、测试集中的喜欢标签和厌恶标签所对应的样本。被试者 7 的多模态
样本被指定为测试集,其他被试者被指定为训练集。从图 3-12(a)中测试集样本的特征空
间可以看出,EFM 模块很好地提取了代表被试者 7 嗅觉偏好的个性特征。然而,许多来自
不同类别的训练集样本在特征空间中难以分离。这表明该模块难以捕捉到不同被试者的嗅
觉偏好,在挖掘被试者嗅觉偏好的共同特征方面具有局限性。图 3-12(b)中样本的特征空
间显示,MFI 模块很好地挖掘了反映被试者嗅觉偏好的共同特征。这在一定程度上解决了
因个体差异而导致的个体嗅觉偏好识别问题。不过,在测试集样本的特征空间中有一小部
分来自不同类别的样本仍然没有被区分开来,这说明该模块在挖掘被试者个性特征方面存
在一定的局限性。从图 3-12(c)中的样本特征空间可以看出,MFF 模块有效地整合了 EFM
模块和 MFI 模块的输出特征,确保了对反映被试者嗅觉偏好的个性和共性特征的全面挖
掘,有效提升了模型的跨被试者嗅觉偏好识别能力。
图 3-12 BMFNet-S 模型的局部特征 Figure 3-12 Local feature maps of the BMFNet-S model
图 3-13 BNet-S、MNet-S 和 BMFNet-S 模型的分类结果 Figure 3-13 Classification results of BNet-S, MNet-S and BMFNet-S models


第 3 章 嗅觉脑电:基于脑-机融合网络的跨被试者气味偏好识别方法
51
图 3-13 对比了 BNet-S、MNet-S 和 BMFNet-S 模型的分类结果。可以看出,由于个体
间的差异,BNet-S 模型的识别效果比 MNet-S 差。MNet-S 模型仅根据训练集中大多数被试
的偏好完成训练,本质上不具备跨被试嗅觉偏好识别能力,因此在识别 7、8、9 号等具有
特殊嗅觉偏好的被试者时,会出现严重的识别错误。所提出的 BMFNet-S 模型通过挖掘反
映被试者嗅觉偏好的共性特征,有效克服了个体嗅觉脑电差异所带来的识别困难,该模型
将保证跨被试者识别能力的共性特征与保证嗅觉偏好识别能力的个性特征相融合,可全面
且准确地描述每位被试者的嗅觉偏好。
图 3-14 展示了 BMFNet-S、BMFNet-S(无 EFM)以及 BMFNet-S(无对比损失)模型
的分类结果,对比 BMFNet-S 与 BMFNet-S(无 EFM)的结果可以发现,EFM 模块的引入
切实提高了模型在跨被试者嗅觉偏好识别任务中的表现,让模型的泛化能力得到了提升。
这意味着,EFM 模块可有效提高模型对不同个体间嗅觉差异的适应能力。从另一方面来看,
对 BMFNet-S 与 BMFNet-S(无对比损失)的结果进行对比可以发现,引入对比损失有效
改善了嗅觉脑电样本的特征分布,帮助模型应对个体间的差异,对比损失的作用是尽量减
少因个体嗅觉脑电差异产生的识别困难,提高模型对不同被试者的识别能力。
图 3-14 EFM 模块和对比损失的消融实验结果
Figure 3-14 The ablation results of EFM module and contrast loss
3.4.6 特征通道可视化
为了可直观地展示 BMFNet-S 模型在嗅觉偏好识别任务中对嗅觉脑电以及电子鼻特征
通道的关注程度,该部分引入梯度加权类激活映射(Gradient-weighted Class Activation
Mapping,Grad-CAM)技术对脑电和电子鼻信号的特征区域进行可视化,Grad-CAM 可通
过所生成的热度图突显模型在分类决策中起到关键作用的特征区域,可直观看出对模型分
类性能有影响的脑电通道和电子鼻传感器,为优化传感器阵列以及电极布局提供参考。
图 3-15 展示了 BMFNet-S 模型在嗅觉偏好识别任务中对电子鼻传感器以及嗅觉脑电


东北电力大学工学博士学位论文
52
通道的关注情况。由图 3-15(a)可看出,传感器 W1C(检测芳烃)、W5S(检测氮化物氧
化物)和 W3C(检测氨气)在识别任务中发挥的作用最为突出,这为电子鼻传感器阵列的
优化给予了理论支撑,有望进一步提升跨被试者嗅觉偏好的识别效果。图 3-15(b)表明嗅
觉偏好与脑电不同区域的电极信号之间存在较强的关联,其中大脑前额叶、顶叶以及枕叶
区域的脑电信号在嗅觉偏好识别任务中起到了关键作用,此结果与现有情绪识别领域的研
究结论相符[106,107],进一步验证了 BMFNet-S 模型的跨被试者气味偏好识别能力。
图 3-15 多模态特征通道可视化
Figure 3-15 The visualization of multimodal feature channels
3.5 本章小结
本章提出了一种用于跨被试者气味偏好识别的脑机协同感知方法,该方法是通过搭建
人类嗅觉脑电信号与电子鼻信号之间的交互桥梁,以实现多模态信息的互补融合。所提出
的方法充分利用了电子鼻在气味理化特性表征方面的优势,以及嗅觉脑电在情感响应表达
方面的能力,可全面地对个体以及群体的嗅觉偏好进行分析。实验结果显示,该方法优于
现有先进方法,有效地攻克了跨被试嗅觉偏好识别难题,证实了电子鼻与嗅觉脑电结合的
可行性,推动了嗅觉偏好评估技术的发展,而且该人机互补策略可拓展到情绪识别、视觉
处理等脑电任务,为多模态融合在神经科学与人工智能领域的发展开拓了道路。


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
53
第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注
意力网络的味道识别方法
数据是知识的种子,只有不断浇灌,才能开花结果。
——加拿大计算机科学家、“深度学习之父”杰弗里·辛顿
味觉脑电数据的数量和质量会对其特征的挖掘和理解产生重要影响,就如同辛顿所言,
数据是知识的种子,若无有效的方法去“浇灌”这些数据,它们便无法生根发芽和开花结果。
为此我们提出了 TSRDA 方法来实现对味觉脑电时空特征的重构,试图挖掘其潜在的特征
信息,该过程不仅是对数据量的简单扩充,更是对数据内在特征的深入理解。那么怎样保
证这些新生成的数据可真实反映实际情况?又怎样利用这些数据增强模型的准确性与稳
定性?在探索这些问题时,我们发现数据的数量与质量是相辅相成的,唯有把控好种子数
量与质量间的关系才能将这些“种子”培育成丰硕的“果实”。
4.1 引言
相较于嗅觉而言,味觉的神经加工过程更为繁杂,其中涉及了更长的信号传导路径以
及多脑区之间的复杂交互,这使得味觉所诱发的脑电信号较为微弱,这无疑加大了特征提
取的难度。此外,味觉脑电实验对实验条件有着极高的要求,像刺激浓度、刺激液体流速
以及口腔清洁度等诸多因素都可能对脑电信号的稳定性产生影响,这在一定程度上大幅度
增加了数据采集的难度。再者,味觉刺激的恢复时间比较长,被试者在单次实验中可接受
的刺激时长以及次数要远远少于嗅觉实验,这致使味觉脑电数据相较嗅觉脑电而言非常稀
缺,数据量的不足以及信号特征提取的困难成为味觉脑电研究的主要障碍,对数据驱动方
法在该领域的应用造成了极大的限制。现有研究虽然尝试运用 L2 正则化逻辑回归或 SVM
来进行味觉脑电分类,然而由于受到手工特征以及数据规模的限制,模型的泛化能力欠佳,
难以契合实际应用的需求。因此,在有限的味觉脑电数据上提升模型的特征提取能力成为
了当前味觉脑电研究的紧迫任务。
近年来,像 CNN 这类深度学习技术凭借其强大的特征学习能力,逐步在味觉脑电分
析领域得到应用,然而 CNN 一般需要依赖大规模数据进行训练,而味觉脑电由于实验条
件较为复杂,数据采集成本较高,这使得数据稀缺的问题十分突出,这对深度学习模型的
训练以及识别效果都产生了影响。为了缓解因数据不足而带来的过拟合风险,研究者尝试
运用噪声添加、信号剪切拼接等数据增强技术来进行脑电数据的增强,虽然这些方法在一


东北电力大学工学博士学位论文
54
定程度上提高了模型性能,但也导致了噪声干扰、信息丢失等问题,那么在进行数据增强
的同时如何最大限度地保留原始信号中的关键信息并降低由噪声干扰导致的不稳定性就
成为了当前味觉脑电分析急需解决的关键问题。
本研究提出一种 TSRDA 方法以优化味觉脑电信号的时间与空间特征,以此提升数据
的多样性以及有效性。同时,在 CNN 模型中引入 MVCA 模块,从多个特征维度提取关键
信息,提高模型的分类精度与稳定性。实验结果显示,该方法有效缓解了数据不足问题,
在味觉脑电识别任务中表现出色。本研究为味觉脑电分析提供了新的技术手段,也为食品
感官评价以及味觉认知研究提供了理论支撑和数据基础。
4.2 味觉脑电数据集构建
4.2.1 被试者与实验材料
(1)被试者
本研究通过张贴有偿告示的方式,在校内招募了 20 名右利手、不吸烟的自愿被试者
(10 名男性,10 名女性),年龄分布在 20 至 30 岁之间。所有被试者均在近期学校医院组
织的体检中取得健康证明,各项指标符合标准(无癌症、糖尿病或 COVID-19 病史),且近
期未出现感冒、发烧等症状,无精神疾病史。此外,被试者具备正常的味觉功能,能够准
确辨别酸、甜、苦、咸四种基本味道。在实验开始前,被试者签署了知情同意书,明确知
晓实验内容与相关权益。被试者在实验当天的早晨需使用无味牙膏刷牙并清洁头发,在实
验开始前两小时内避免饮食,可少量饮水。本研究遵循《赫尔辛基宣言》(修订版)的相关
要求,研究方案已通过东北电力大学科学研究伦理与科技安全委员会的审批。
表 4-1 四种实验样本信息
Table 4-1 Four experimental sample information 编号 味道 成分 生产商
1 酸味 0.039 M 柠檬酸 + 100 mL 蒸馏水 潍坊英轩实业有限公司,中国 2 甜味 0.44 M 蔗糖+ 100 mL 蒸馏水 云南滇鹏糖业有限公司,中国 3 苦味 3 g 苦瓜粉 + 100 mL 蒸馏水 亳州市德永堂生物科技有限公司,中国 4 咸味 0.65 M 氯化钠 + 100 mL 蒸馏水 孝感广盐华源制盐有限公司,中国
(2)材料
参考以往研究[59],本研究选择了酸、甜、苦、咸四种味道的水溶液作为诱发味觉脑电
的实验材料,溶液的配制方式如表 4-1 所示,具体内容如下:酸味溶液是将 0.075 g 食品级
柠檬酸溶解在 100 mL 蒸馏水中制成,甜味溶液是将 15 g 蔗糖溶解于 100 mL 蒸馏水制成,
苦味溶液是由 3 g 苦瓜粉溶于 100 mL 蒸馏水制得,咸味溶液是将 3.8 g 氯化钠溶于 100 mL
蒸馏水制成。另外还需要准备一瓶 100 mL 的纯蒸馏水。经过预实验,所配制的溶液可有
效诱发被试者的味觉感知,且不会引起被试者的不适或者反感。


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
55
(3)仪器
本研究使用自主研发的低噪声、高精度和高稳定性的味觉诱发器用于刺激被试者味觉
以获取相关脑电信号,其结构如图 4-1 所示。该设备主要是由 STM32F103ZE 控制板(东
莞野火科技有限公司,中国)、S15S-53J 微型真空泵(成都海霖科技有限公司,中国)、SFO
1037V-01 电磁阀(东莞斯凡电子科技有限公司,中国)以及 AB32-S21P020C-11R 液体流
量计(香港 ODE 有限公司,中国)构成。利用控制板,该设备可以对液体流量、电磁阀开
闭以及真空泵运行实现精确控制,并且运用填充了隔音棉的隔音罩降低噪声,在实验过程
中,味觉诱发器有四种工作模式,模式 1 是蒸馏水排放模式,此时控制板会打开电磁阀 1
和电磁阀 3,启动微型真空泵将蒸馏水快速抽到喷嘴处。模式 2 为味觉溶液排放模式,控
制板打开电磁阀 2 和电磁阀 3,启动微型真空泵将味觉溶液输送到喷嘴。模式 3 是蒸馏水
刺激模式,蒸馏水以每秒 0.25 mL 的流速慢慢流向被试者的舌头,持续 2 秒。模式 4 是味
觉溶液刺激模式,味觉溶液以同样的流速缓缓流向被试者的舌头,持续 2 秒。这种高精度、
低噪声的设备保证了实验数据的有效性,为味觉诱发相关脑电研究提供了可靠的技术支撑。
在本章开展的实验中,所运用的味觉脑电采集系统与第 2 章 2.2.1 中所讲述的系统一
致,其设备配置、采样频率以及电极布置等详细信息可查阅第 2 章 2.2.1 的相关部分。
图 4-1 味觉脑电实验装置
Figure 4-1 The taste EEG experimental device
4.2.2 数据采集与预处理
(1)实验过程
实验开始前,根据表 4-1 配制 100 mL 的酸、甜、苦、咸四种溶液,并将其分别装入
250 mL 的样品瓶中,同时准备 100 mL 的蒸馏水置于洁净的 250 mL 清洗瓶中。将这些瓶


东北电力大学工学博士学位论文
56
子置于加热盘中加热至 37.5 °C并保持恒温。同时,确保实验环境无强电磁干扰,并通过中
央空调将实验室温度维持在 21 ± 2 °C。每位被试者需参加四天实验,每天的时间为上午 9
时至 11 时或下午 3 时至 5 时。在每天的实验中,每位被试者将随机接受四种味觉刺激。
实验开始前,被试者需佩戴好脑电帽、耳塞以及鼻塞,同时还要调整下巴托来对头部
进行支撑,以此保证在整个实验过程中头部可保持稳定状态。味觉诱发器的出口管会精确
地放置在被试者舌头中央上方 0.25 至 0.5 厘米的位置,以准确无误地输送刺激液体。在整
个实验过程中,被试者始终处于闭眼状态,从而排除视觉干扰。随机选择一种味觉溶液用
于味觉脑电的诱发,该过程要保证被试者无法通过溶液外观判断味道类型,之后依据实验
要求,将随机选出的味觉溶液以及蒸馏水分别连接至味觉诱发器上。
图 4-2 味觉脑电实验流程
Figure 4-2 The taste EEG experiment process
味觉刺激的整个过程如图 4-2 所示,其具体步骤如下:
(1)将味觉诱发器状态设为模式 1,迅速将蒸馏水送至喷嘴口,之后转换到模式 3,
接着利用蜂鸣器发出适当音量的提示音,持续 0.8 秒,以此来提醒被试者实验已经开始。
(2)1 秒之后,味觉诱发器会以恒定的速度输送 0.5 mL 的蒸馏水,持续时间为 2 秒,
以此让被试者适应水流刺激,在这之后,被试者需将口腔内的液体吐出,并且将头部移回
到初始的位置,10 秒过后,被试者将再次接受同样的水流刺激,以充分适应水流的触感。
(3)2 秒过后,被试者把口中的液体吐出,同时将头部移回最初的位置,在这个过程
中,味觉诱发器转变为模式 2,迅速将管道中的蒸馏水清空,接着将随机选择的味觉溶液
排到喷嘴口。
(4)在经过 10 秒的短暂等待之后,味觉诱发器会切换至模式 4,接着以恒定的速度
把 0.5 mL 的味觉溶液输送至被试者的舌头中央,这个输送过程会持续 2 秒,在味觉溶液被
输送至舌头中央后,被试者需要含住液体 10 秒,以充分诱发味觉脑电,同时还要避免出现
吞咽的情况。紧接着,蜂鸣器会再次发出响声,以此来提示实验已经结束,这时被试者要
进行漱口操作来清洁口腔,在等待 30 分钟之后再开展下一种味觉刺激实验。在每一天所进
行的实验中,被试者会按照顺序依次完成四种味觉刺激实验,而在其余三天所开展的平行


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
57
实验里,都会重复相同的实验步骤,并且在整个实验过程中会严格把控实验流程以及条件,
以此来保证数据采集的稳定性和可靠性。
(2)数据预处理
味觉脑电由 Matlab(R2017b)及其内置工具包 EEGLAB(2021 版)进行预处理。处理
流程如下:
(1)共采集每位被试者在四种味道刺激下的味觉脑电,每次刺激共采集 4 个 10 秒的
平行脑电数据段。每段数据以 2 秒为一个样本进行切分,从每段 10 秒的数据中提取 5 个
脑电样本。按照酸、甜、苦、咸这样的顺序分别给样本做标记,依次对应标签 0、1、2 以
及 3,因此 20 名被试者总共得到 1600 个脑电样本。
(2)运用 FIR 滤波器针对味觉脑电样本实施 0.5 至 50 Hz 的带通滤波操作,以消除脑
电信号中的低频以及高频噪声干扰,随后利用陷波滤波器去除工频干扰,该滤波器的下通
带设定为 49 Hz,上通带设定为 51 Hz,之后将采样频率从原本的 256 Hz 降低到 128 Hz,
来减小数据量以及计算复杂度。最终,每个味觉脑电样本的尺寸为 256×21。
(3)对在水刺激情况下所采集的脑电信号实施相同的预处理操作,每一次水刺激都会
对应两个时长为 2 秒的脑电样本。因此,20 名被试者在每一次实验过程中总共可获取 640
个脑电样本。总之,上述预处理流程充分保证了实验数据的有效性。
4.3 基于时空重构的味觉脑电数据增强方法
本研究提出了一种 TSRDA 方法,该方法是通过对原始训练集中的样本数据做剪切和
拼接操作,重构出包含时间和空间特征的味觉脑电样本,让模型可在时间和空间维度上更
高效地挖掘味觉脑电特征,增强后的数据集中的每个样本都被赋予了双标签,每个标签的
权重是由其对应的原始脑电样本在重构前样本里所占的比例来决定的。这种双标签策略可
精确表征增强后的样本特征与原始样本特征之间的映射关系,为深度学习模型提供更丰富
的监督信息,增强后的样本集通过多样化的样本分布为所提出的 CNN 模型提供了充足的
训练数据,可有效提升 CNN 的识别精度以及稳定性,TSRDA 方法的计算策略如图 4-3 所
示,其主要步骤如下所述。
步骤 1:从原始训练集中随机选取两个样本 n1
labelx
D 和 n2
labely
D ,样本尺寸为 W×H(时间维
度×空间维度)。
步骤 2:分别从样本 n1
labelx
D 和 n2
labely
D 的相同位置切取尺寸为 w×h 的数据块 Sx1 和 Sy1,并
由 Sy1 覆盖 Sx1,得到重构数据 1
,
m
labelx labely
D。
步骤 3:重构后的数据有两个标签,即 labelx 和 labely,其权重分别为 1
1 Sy
WH
− × 和 Sy1
W×H 。
其中  表示数据块时间和空间维度的乘积。


东北电力大学工学博士学位论文
58
图 4-3 TSRDA 方法的计算策略
Figure 4-3 The computational strategy of TSRDA method
图 4-4 Beta(α,β)的概率密度函数
Figure 4-4 The probability density function of Beta (α, β)
步骤 4:根据两个标签及其权重训练模型。
在这项工作中,TSRDA 方法的详细计算如下。在步骤 1 中,W=256,H=21。在步骤 2
中,味觉脑电的左上角定义为点坐标(0,0),右下角坐标为(256,21)。Sx1 和 Sy1 的剪切
需要明确其位置和大小。其中,确定最佳位置对 TSRDA 方法尤为重要。参数优化后,Sx1
和 Sy1 数据块的中心坐标均为 O(p,q),其中 p=λp×256,q=λq×21,λp ~ Beta(1,1),λq ~
Beta(2,1)。Beta(α,β)的概率密度函数如图 4-4 所示。当 α=1、β=1 时,Beta(α,β)
是均匀分布。当 α=2、β=1 时,x 越接近 1,概率密度越大。当 α=1、β=2 时,x 越接近 0,
概率密度越大。当 α=2、β=2 时,x 越接近 0.5,概率密度越大。因此,当 λp ~ Beta(1,1)、
λq ~ Beta(2,1)时,数据块的位置在时间维度上均匀分布,在空间维度上主要分布在脑电


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
59
电极的下半部分(即覆盖 O1-A2 这部分电极)。此外,w=λw×256、h=λh×21、λw ~ Beta(1,
1)、λh ~ Beta(1,1)。在大多数情况下,根据上述剪切方法,数据块(w×h)通常会被包
含在原始样本(W×H)中。但有时会出现数据块不被完全包含在原始样本中的情况,对于
该情况,我们只对样本内的部分进行数据重构。在步骤 4 中,重构后的数据 1
,
m
labelx labely
D 被用
于模型的前向传播,以获得预测值 outputx,y,并使用标签 labelx 和标签 labely 分别计算交
叉熵损失值 lossx 和 lossy。然后根据标签所对应的权重对损失值进行加权求和,得到最终损
失值 lossx,y 用于模型优化。计算公式如下:
,
model( , )
x xy
loss = output labelx (4-1)
,
model( , )
y xy
loss = output labely (4-2)
11
, (1 )
yy xy x y
SS
loss loss loss
HW HW
=− × + ×
××
(4-3)
图 4-5 TSCNN-CA 网络结构 Figure 4-5 The network structure of TSCNN-CA
4.4 基于多尺度通道注意力的味觉脑电识别框架
4.4.1 模型框架
近年来,CNN 被广泛应用于脑电分类任务,该系列模型的卷积和池化操作能够高效提
取脑电数据中的高维特征,识别效果显著。本研究提出了一种具有通道注意的时空卷积神
经网络(Temporal-Spatial Convolutional Neural Network with Channel Attention,TSCNN-CA),
该模型可提取味觉脑电的高维特征,实现对味觉脑电的有效识别。TSCNN-CA 的网络结构


东北电力大学工学博士学位论文
60
如图 4-5 所示。模型的输入数据尺寸为 1×21×256,其中 1 表示单通道,21 表示电极数量,
256 表示每个电极的采样点数量。TSCNN-CA 通过时间卷积和空间卷积分别挖掘味觉脑电
的时间和空间特征。在时间卷积中,卷积核的尺寸为 1×37,填充为 2,步长为 1。而在空
间卷积中,卷积核的尺寸为 3×1,填充为 1,步长为 1。通常情况下,味觉脑电的时域中包
含着比空域更多的有效信息,因此在时间卷积的时,输出通道的数量比输入通道扩大了 16
倍,在空间卷积时的输出通道数量仅扩大了 2 倍,通过这样的设计 TSCNN-CA 可更为有
效地挖掘味觉脑电的时空特征,以实现对味觉脑电的精准分类。
图 4-6 MVCA 模块的计算过程
Figure 4-6 The calculation process of MVCA module
现有研究表明,通过一系列的卷积以及池化操作可有效提取更高维度的味觉脑电特征,
以提升模型的表达能力,然而随着脑电特征通道数的增加,不可避免地会引入冗余信息,
从而对识别任务产生不利影响,为缓解这一问题,实现对味觉脑电关键特征的高效挖掘,
本研究在 TSCNN-CA 的卷积层 1、2 以及 4 之后引入了如图 4-6 所示的 MVCA 模块。
MVCA 模块可聚焦于特定通道的关键特征,减少冗余信息对识别产生的干扰,并且在
TSCNN-CA 的卷积层 2、3、4 以及 5 之后利用 ReLU 非线性激活函数提高网络的表达能
力,让模型有效地建立味觉脑电的特征空间。卷积和池化操作的具体设计如下:卷积层 1
至卷积层 5 的卷积核尺寸都为 3×3,步长为 1,填充为 1。特征通道的数量在经过卷积层 1、
2 以及 4 后分别增加了一倍,逐级提取更高维的数据特征,为了降低计算复杂度同时扩大
模型的感受野,在模型中引入了最大池化操作,其中最大池化 1 和最大池化 2 的池化核尺
寸为 2×4,步长为 2×4,最大池化 3 和最大池化 4 的池化核尺寸为 2×2,步长为 2×2,上述
池化设计既有效地压缩了特征的尺寸,又保留了关键的特征信息。最终,将最大池化 4 所
输出的尺寸为 256×1×3 的特征进行展平,并利用 FC 层和 Softmax 层生成预测结果,以实


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
61
现对味觉脑电数据的精准分类。
4.4.2 多尺度通道注意力
CNN 有提取味觉脑电深层特征的能力,然而随着网络深度不断增加,会不可避免地引
入大量冗余信息,这将对特征提取的效率以及分类性能产生影响,为解决这一问题,通道
注意力机制凭借其优异的自适应特征筛选能力得到广泛运用,有效地削弱了冗余信息的影
响并聚焦关键特征。因此,本研究提出了 MVCA 模块,该模块利用全局平均池化以及全局
最大池化分别提取味觉脑电的总体特征与主要特征,充分挖掘味觉脑电的多视角全局特征
信息,其中的全局平均池化可获取数据的统计学信息,而全局最大池化则可聚焦关键的特
征,将这两种池化方法结合起来可生成更为全面的全局特征表示,接着沿通道维度对多视
角特征信息进行一维卷积操作,以实现数据的跨通道交互,提高模型对多维特征的捕捉能
力。MVCA 模块的计算过程如图 4-6 所示,主要涉及全局池化、一维卷积、信息融合以及
非线性激活,其中全局池化用于提取核心的特征信息,一维卷积则通过学习跨通道的特征
信息提升通道间的信息交互效果,信息融合将多视角特征整合为统一的表示,最后借助非
线性激活函数提升模型对非线性特征的表示能力。MVCA 模块的引入提高了模型所提取特
征的信息质量,为味觉脑电的精准识别奠定了基础,MVCA 模块的详细计算细节如下。
MVCA 模块通过全局平均池化以及全局最大池化来获取多视角全局特征信息,其具体
的计算公式如下所示:
11
1
×
HW
a ij ij
PF
HW= =
= ∑ ∑ (4-4)
max( )
m ij
P = F (4-5)
其中,输入数据 H W C
F ××
∈
 ,Pa 和 Pm 分别是 F 在经过全局平均池化和全局最大池化后
的计算结果。
然后,分别对 Pa 和 Pm 进行独立的一维卷积运算,通过卷积核的滑动实现了数据的跨
通道交互,其计算公式如下:
conv1d( , , , _ , )
a a in out
R = P C C kernel size padding (4-6)
conv1d( , , , _ , )
m m in out
R = P C C kernel size padding (4-7)
其中,输入通道 Cin 为 1,输出通道 Cout 为 1,kernel_size 为 3,padding 为 1。
最终,将 Ra 和 Rm 相加以实现信息融合,然后对其进行非线性激活以得到注意力权重,
进一步将注意力权重乘以原始数据 F 从而得到 MVCA 模块的输出 F’,计算公式如下:
'()
am
F = F ×δ R + R (4-8)
其中δ是 sigmoid 激活函数函数。


东北电力大学工学博士学位论文
62
4.5 实验结果与分析
4.5.1 味觉脑电地形图
为探究水以及酸、甜、苦、咸四种基本味觉刺激所引起的神经活动,本研究随机选取
了 3 名被试者,将其在相同味觉刺激条件下的脑电样本进行平均,生成了 0-1 秒内的平均
脑电地形图,以实现对不同刺激下脑区活动模式的分析。3 名被试者在不同刺激下的平均
脑电地形图如图 4-7 所示,观察该图可知,不同味觉刺激所引起的大脑电活动模式存在差
异,相较于四种基本味觉刺激,水刺激并未引起显著的脑区激活,甜味刺激使得顶叶以及
颞叶区域的脑电活动较为活跃,而苦味和酸味刺激主要激活了额叶、枕叶以及颞叶的脑电
活动,这体现出苦味和酸味在大脑神经活动模式方面的相似之处,但苦味和酸味刺激与甜
味刺激呈现出明显差异。这种差异或许是由甜味在味觉感知以及情绪处理中的特殊作用所
导致的,另外咸味刺激下的脑电活动集中于顶叶和颞叶的部分区域,与甜味刺激引发的部
分脑电活动存在一定相似性,这可能反映出咸味和甜味在感知特征、生理特性等方面的复
杂联系。实验结果说明不同味觉刺激引起了大脑特定区域的差异化神经活动模式,这为揭
示味觉感知的神经机制提供了关键依据。
图 4-7 不同味觉刺激下的平均脑电地形图
Figure 4-7 The average EEG maps under different taste stimulations


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
63
4.5.2 模型设置与评价指标
本文进行了味觉脑电的四分类实验,旨在验证所提方法的有效性,该实验将 20 名被试
者的 1600 个味觉脑电样本按照 3:1 的比例随机划分为训练集和测试集,其中训练集含有
1200 个样本,测试集含有 400 个样本。为保证实验结果的可靠性,每种方法都进行了五次
独立实验,最终将最高分类准确率、最高 F1 分数以及最高 Kappa 系数的平均值当作评价
指标,以全面衡量模型的分类能力。在模型优化过程中,训练集和测试集的批量大小分别
为 64 和 32,运用 Adam 优化器对模型进行优化,迭代次数为 100,学习率为 0.0005,权重
衰减系数为 0.001,上述超参数的设定保证了模型在训练过程中的快速收敛以及后续测试
阶段中的良好泛化能力。
4.5.3 数据增强方法有效性分析
在 TSRDA 方法前后,TSCNN-CA 模型的分类结果如表 4-2 所示,经对比实验结果可
发现,在数据增强之后,模型的准确率从 98.10%提升至 99.56%,F1 分数从 98.09%提升至
99.48%,Kappa 系数从 97.39%提升至 99.38%,TSRDA 方法可有效提高模型的分类准确性。
具体而言,Kappa 系数提升了 1.99%,这一指标的改善说明 TSRDA 方法有效提高了模型的
整体分类性能,也提高了其对不同类别的平衡性,即模型在正确分类样本时对各类别的识
别能力更为均衡,这对解决样本类别不均衡问题颇为关键,比如利用 TSRDA 方法在样本
数较少的类别中进行数据增强来提高模型的识别能力。另外实验结果还显示,采用 TSRDA
方法后,TSCNN-CA 模型的准确率、F1 分数和 Kappa 系数的标准偏差均有所下降,TSRDA
方法不仅提高了模型的分类准确率,还有效提高了模型的分类稳定性,提升了模型在不同
实验条件下的稳定性。总之 TSRDA 方法通过生成更为丰富、平衡的训练数据,可提升
TSCNN-CA 模型的分类准确性和稳定性,有效提高模型在处理样本类别不平衡问题时的性
能,为味觉脑电识别提供了关键支撑。
表 4-2 TSRDA 方法数据增强前后 TSCNN-CA 模型的性能分析
Table 4-2 Performance analysis of TSCNN-CA model before and after data augmentation by TSRDA method 评价指标 数据增强前 数据增强后
准确率 ± std(%) 98.10 ± 2.03 99.56 ± 0.21 F1 分数 ± std(%) 98.09 ± 2.04 99.48 ± 0.31 Kappa 系数 ± std(%) 97.39 ± 2.77 99.38 ± 0.29
4.5.4 与先进模型的比较
为检验本章所提出方法的有效性,本研究将该方法与 6 种当下先进的脑电分类模型做
了对比,在对比实验中,所有分类模型超参数的设定都与 TSCNN-CA 模型一致,包括批量
大小、优化器、迭代次数、学习率以及权重衰减,对比方法的简要介绍如下。
(1)Wang 等人[74]:通过给原始的情绪脑电信号增添高斯噪声的方式来实现数据增强,


东北电力大学工学博士学位论文
64
之后运用 ResNet 模型实现脑电分类。
(2)Zhang 等人[75]:通过对多个癫痫脑电信号进行剪切以及拼接的方式来实现数据增
强,然后利用浅层的 CNN 模型完成脑电分类。
(3)Pei 等人[76]:提出脑区重组方法来增强运动图像脑电信号,提升 EEGNet 模型的
分类性能。
(4)Schirrmeister 等人[77]:采用滑动时间窗分割增强运动图像脑电信号,并使用其提
出的深度 CNN 模型进行分类。
(5)Al-Saegh 等人[78]:提出 CutCat 方法,通过剪切两个样本的特定时间段并依次拼
接这些片段实现数据增强,利用深度 CNN 模型完成分类。
(6)Xu 等人[108]:通过滑动时间窗增强运动图像脑电信号,并基于 VGG-16 模型进行
分类。
表 4-3 展示了先进方法与所提方法的对比结果。总的来说,所提出的 TSRDA 方法在
味觉脑电识别方面优于其他方法,其准确率、F1 分数和 Kappa 系数分别达到了 99.56%、
99.48%和 99.38%,具体分析如下。
表 4-3 TSRDA 方法与先进的方法的比较
Table 4-3 Comparison of TSRDA method with advanced methods 参考文献 Augmentation method 准确率(%) F1 分数(%) Kappa 系数(%) [74] Add Gaussian noise 89.99 ± 1.75 89.68 ± 1.92 87.99 ± 2.45 [75] Time division and reorganization 94.98 ± 3.19 94.69 ± 3.63 93.06 ± 4.42 [76] Brain area recombination 95.30 ± 1.70 95.08 ± 1.94 93.60 ± 2.25 [77] Sliding time window segmentation 95.62 ± 2.30 95.31 ± 2.49 94.05 ± 3.11 [108] Sliding time window segmentation 97.52 ± 0.82 97.45 ± 0.98 96.66 ± 1.08 [78] CutCat 98.67 ± 0.52 98.57 ± 0.60 98.19 ± 0.71 TSRDA 方法 99.56 ± 0.21 99.48 ± 0.31 99.38 ± 0.29
(1)添加高斯噪声的方法效果最差
Wang 等人[74]通过在味觉脑电信号中添加高斯噪声的方式来进行数据增强,该方法所
取得的数据增强效果和预期相比有较大差距,该结果或许是由于高斯噪声的引入增加了信
号中的随机干扰成分,让原本不太突出的味觉脑电特征变得更为模糊,从而使分类模型提
取有效特征的能力被削弱,这表明过多的噪声干扰会让分类模型在区分关键特征与噪声时
面临困难,对模型的分类性能产生负面影响。
(2)基于时间分割和空间重组的方法效果有限
Zhang 等人[75]沿时间维度剪切和拼接的方法,以及 Pei 等人[76]的脑区重组方法在一定
程度上提升了模型的分类效果,但由于这些方法仅能从单一的时间或空间维度增强脑电信
号,因此对模型的性能提升有限。滑动时间窗分割方法[77,108]和 CutCat 方法[78]表现出较好
的分类效果,但仍有较大的提升空间。


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
65
(3)所提方法的综合优势
所提出的 TSRDA 方法可在时间和空间维度对味觉脑电进行有效的数据增强,提升模
型的分类性能,在准确率上相较于参考文献[74]、[75]、[76]、[77]、[78]和[108]分别提高了
9.57%、4.58%、4.26%、2.04%、0.89%和 3.94%。TSCNN-CA 的网络深度和深度 CNN 模型
[77,78]差不多,不过因为引入了 MVCA 模块,TSCNN-CA 可更充分挖掘味觉脑电的关键特
征,既保障了计算的有效性,又提升了分类性能。通过对比实验结果可发现,TSRDA 方法
充分增强了味觉脑电在时间和空间维度的特征信息,有效提高了模型的分类准确性与稳定
性,实验结果验证了其在味觉脑电识别中的良好性能。
图 4-8 所示的误差柱状图展示了不同方法在准确率、F1 分数以及 Kappa 系数方面的表
现,可以看出提出的方法在分类稳定性上比其他先进方法更具优势,该方法可以有效增强
并提取味觉脑电的关键特征,减少冗余信息与噪声带来的干扰。
图 4-8 TSRDA 方法与先进模型比较
Figure 4-8 The comparison of TSRDA method with advanced models
4.5.5 消融实验
(1)数据增强倍数
对于 TSRDA 方法而言,数据增强的倍数会对模型的训练效果以及识别性能产生重要


东北电力大学工学博士学位论文
66
影响,增强倍数过小可能会致使模型训练不够充分,无法充分挖掘样本的特征,增强倍数
过高则可能会引入冗余信息,使味觉脑电的识别准确率以及效率有所降低,因此确定最佳
的数据增强倍数至关重要。
图 4-9 数据增强倍数的消融实验
Figure 4-9 The ablation experiment of data augmentation multiple
本研究针对 TSRDA 方法,将数据增强倍数依次设定为 1、2、3、4、5 以及 6,以进一
步评估 TSCNN-CA 模型在不同增强倍数下的分类性能,图 4-9 所展示的误差柱状图体现出
TSCNN-CA 模型在不同增强倍数下的性能表现。结果显示,TSRDA 方法的引入可有效提
升 TSCNN-CA 的分类准确性与稳定性,与未实施数据增强的原始训练集相比,在引入
TSRDA 方法后,模型性能有了明显提高。随着数据增强倍数从 1 逐渐增至 3,模型的分类
性能也稳步提升,这意味着适度增加样本数量可使模型得到更充分的训练,进而提升模型
的分类准确性与稳定性。然而当数据增强倍数超过 3 后,因冗余信息的干扰,模型的识别
性能反而出现了一定程度的下降。因此,最终我们将数据增强倍数设为 3,此设置综合考
量了模型的分类准确性与稳定性,既能保证模型得到充分的训练,又能有效避免冗余信息


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
67
的干扰。
(2)时空重构位置
对于味觉脑电识别任务,由于被试者差异和味觉刺激的不同,味觉脑电的重要特征在
时间和空间上的分布可能存在显著差异。因此,在 TSRDA 方法中,选择合适的时空重构
位置对于增强味觉脑电的关键特征至关重要。本研究在不同时空位置上对尺寸为 256×21 的
味觉脑电样本进行了重构,以探索最佳的时空重构策略。重构数据块的中心坐标 O(p,q)
中的 p 和 q 分别表示该坐标在时间和空间上的位置,计算公式为 p=λp×256,q=λq×21。其
中 λp 的概率密度被设为 Beta(1,1)、Beta(1,2)、Beta(2,1)和 Beta(2,2)分布,
分别表示重构数据块在空间上均匀分布、主要分布在空间的上半部分、主要分布在空间的
下半部分和主要分布在空间的中间部分。同样,λq 的概率密度被设定为 Beta(1,1)、Beta
(1,2)、Beta(2,1)和 Beta(2,2)分布,分别表示重构数据块在空间上均匀分布,主
要分布在空间的上半部分,主要分布在空间的下半部分以及主要分布在空间的中间部分。
本研究通过对 TSRDA 方法中的重构数据块进行了不同位置分布的设计,以增强味觉脑电
数据,并探讨最优的时空重构策略。为确保实验条件的一致性,数据增强倍数被固定为 3,
增强后的数据将用于 TSCNN-CA 模型的训练。
图 4-10 时空重构的位置对数据增强效果的影响
Figure 4-10 The impact of the position of spatiotemporal reconstruction on the effect of data augmentation
TSCNN-CA 在不同重构位置下的分类结果如图 4-10 所示。在时间和空间维度上,当
λp 和 λq 的概率密度分别服从 Beta(1,1)和 Beta(2,1)时,TSRDA 方法对味觉脑电的
数据增强效果最好。此外,用 TSRDA 方法增强味觉脑电数据时,重构数据块的位置在时
间维度上服从均匀分布更有利于充分增强味觉脑电的重要特征,这表明味觉脑电的重要特
征在时间维度上的分布较为均匀,其特征分布贯穿整个时域。当 λp 的概率密度服从 Beta
(1,1)时,λq 在空间维度上的四种分布均取得了良好的效果,这可能归因于脑电通道之
间的耦合。值得注意的是,当 λq 的概率密度服从 Beta(2,1)时,TSRDA 方法的数据增


东北电力大学工学博士学位论文
68
强效果最好,这表明味觉脑电的重要特征主要分布在空间维度的下半部分所对应的脑电电
极通道中。
(3)TSRDA 和 MVCA 方法
在这一部分我们针对所提出的 TSRDA 和 MVCA 方法进行了消融实验,旨在验证这两
种方法的有效性,其中的比较对象包括四种模型,分别是 Raw&TSCNN,即不含 TSRDA
和 MVCA 的 TSCNN 模型,Raw&TSCNN-CA,也就是仅含 MVCA 的 TSCNN 模型,
TSRDA&TSCNN,此为仅含 TSRDA 的 TSCNN 模型,以及 TSRDA&TSCNN-CA,它是同
时包含 TSRDA 和 MVCA 的 TSCNN 模型,实验结果如图 4-11 所示。
对比数据增强前后 TSCNN 和 TSCNN-CA 的分类结果可以发现,TSRDA 方法可有效
增强味觉脑电数据,较大幅度地提升模型对味觉脑电的识别准确率以及稳定性。此外
Raw&TSCNN 与 Raw&TSCNN-CA、TSRDA&TSCNN 与 TSRDA&TSCNN-CA 模型之间的
对比结果显示,MVCA 方法的引入对挖掘味觉脑电的关键特征有积极影响,有效减少了冗
余信息的干扰。上述结果验证了 TSRDA 和 MVCA 方法在提升模型识别性能方面的有效
性。
图 4-11 TSRDA 和 MVCA 方法的消融实验 Figure 4-11 The ablation experiments of TSRDA and MVCA methods
4.5.6 可视化分析
通过 t-SNE 可视化方法,本研究分析了模型在 Raw&TSCNN、Raw&TSCNN-CA 和
TSRDA&TSCNN-CA 条件下所提取的四种味觉脑电特征的空间分布,以直观展示 TSRDA
和 MVCA 方法的有效性。在该部分,TSCNN 或 TSCNN-CA 模型的 FC 层中包含的 768 个


第 4 章 味觉脑电:基于时空重构数据增强与多尺度通道注意力网络的味道识别方法
69
神经元被用作 t-SNE 的输入特征,t-SNE 将这些特征降维至二维,以便可视化分析。四种
味觉脑电特征的可视化结果如图 4-12 所示,其中橙色五角星、蓝色正方形、紫色三角形和
绿色圆形分别表示酸、甜、苦、咸四种味觉脑电的特征。
图 4-12 酸、甜、苦、咸四种味觉脑电的特征可视化结果
Figure 4-12 The visualization results of the feature of sour, sweet, bitter and salty taste EEG
参照图 4-12(a)可知,在未引入 TSRDA 以及 MVCA 方法时,TSCNN 所提取的不同
类别样本特征的分布呈现出较差的可分性,例如许多甜味脑电样本的特征与咸味脑电样本
的特征相互交错,致使分类边界变得模糊,模型难以有效识别不同类别的味觉脑电信号。
在引入 MVCA 模块后(图 4-12(b)),同一种味觉的脑电特征分布明显变得更为集中,特
征聚类效果有了一定程度的提升,尽管依然存在少量样本较难区分,但整体上的可分性已
有所改善,MVCA 方法在特征优化方面发挥了积极的作用,可降低特征空间的混杂程度,
让模型更易挖掘到味觉脑电的关键特征。引入 TSRDA 和 MVCA 方法后(图 4-12(c)),
同一种味觉的脑电特征空间距离缩小,特征分布更加紧密,而不同味觉的脑电特征空间距
离则进一步增大,类别间的区分度得到了提高,其结果表明 TSRDA 和 MVCA 方法的结合
可有效地提升模型对味觉脑电特征的提取能力,优化特征分布结构,进而有效地提高模型
的分类性能及泛化能力。
4.6 本章小结
味觉脑电实验过程繁杂,需要较高的时间与经济成本,致使难以收集充足的脑电数据,
这使得识别任务极具挑战,鉴于味觉脑电数据量不足的情况,本章将味觉脑电的数据增强
作为研究重点,提出了一种 TSRDA 方法以实现味觉脑电的数据增强,该方法通过增强味
觉脑电数据,有效缓解了数据稀缺的问题,提升了模型的识别能力。数据增强可突破数据
匮乏的限制,但也会引入冗余信息。基于此,我们进一步提出了 MVCA 方法,有效解决了
这一问题,保证所增强的数据可以被充分挖掘。在重构时间和空间特征方面,通过消融确
定了 TSRDA 方法的最佳重构位置,有效增强了味觉脑电信号的时空特征,但其确定最佳
重构位置的过程还较为复杂,其便捷性尚有较大的提升空间,未来可引入 Grad-CAM 等特


东北电力大学工学博士学位论文
70
征可视化技术,以更有效、便捷地确定最佳的重构位置,提高方法的效率和适用性。总之,
本章所提出的数据增强方法和分类模型成功解码了酸、甜、苦、咸四种基本味道所诱发的
味觉脑电信号,为味觉脑电研究提供了关键的技术支持,推动了味觉脑电技术在食品感官
评价中的应用。


第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网络的味道识别方法
71
第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间
注意力网络的味道识别方法
智慧在于知道该忽略什么。
——古希腊哲学家苏格拉底
在味觉脑电信号分析领域,电极的选择十分关键,就如同苏格拉底所言,真正的智慧
不只是获取大量信息,还在于从众多信息中筛选出有价值的部分。在味觉脑电识别任务中,
无关的电极信息会造成信息冗余,致使计算复杂度增加,最终影响识别的效率和精度。那
么在复杂的数据海洋中我们不禁要问,如何选择关键电极?怎样才能真正找到那条通向洞
察的道路?基于此,我们提出了一种基于注意力的类激活映射(Attention-based Class
Activation Mapping, CAM-Attention)方法。通过将 Grad-CAM 和通道-空间注意力卷积神经
网络(Channel Spatial Attention Convolutional Neural Network, CNN-CSA)相结合,以有效
识别并提取脑电信号中的关键特征,从而提升味觉脑电识别的计算效率与精度,为理解味
觉神经机制开辟了新的道路。
5.1 引言
在味觉脑电识别任务中,数据的质量以及有效特征的提取对于模型的性能而言都十分
关键,第 4 章针对味觉脑电数据稀缺这一问题提出了数据增强方法,以扩充数据规模并提
升数据特征的多样性。不过单纯依靠数据增强并不能够完全解决味觉脑电识别所面临的挑
战,除了数据量存在限制之外,味觉脑电信号还存在严重的信息冗余问题。在电极分布方
面,不同电极采集到的信号对于任务的贡献并不平衡。如果直接对全电极数据进行特征提
取,不仅会增加计算的复杂度,还可能因为冗余信息的干扰而致使模型的识别能力下降。
因此,在数据增强的基础之上,怎样筛选味觉脑电的关键信息是提高味觉脑电识别性能的
关键。
无论是传统的机器学习方法,还是近年来被广泛运用的深度学习方法,冗余信息的出
现都会对模型的泛化能力以及计算效率产生负面影响。味觉脑电信号有时空特性,这使得
不同的电极位置在味觉脑电识别任务中的关键程度具有明显差异,然而传统的全电极分析
方式大多时候忽视了这一要点,让无关或者冗余的电极信号对模型的学习进程造成影响。
当前的电极选择方法主要依靠特征选择算法,像 Lasso 和稀疏 CSP 等,虽然可在一定程度
上减少冗余信息,不过依旧存在自动化程度不高、难以充分发掘时空特征等问题,深度学


东北电力大学工学博士学位论文
72
习尽管可自动提取特征,但如果电极的选择不佳,依旧难以避免冗余信息的干扰,影响最
终的识别效果。
为应对该问题,本章提出了一种将 Grad-CAM 与 CNN-CSA 模型相结合的电极选择方
法,该方法利用 Grad-CAM 技术对味觉脑电任务的相关电极展开可视化分析,选择对识别
有较大贡献的电极,以降低冗余信息的干扰,提升模型的计算效率以及可解释性,并且通
过将 Grad-CAM 技术与 CNN-CSA 模型结合以优化特征提取过程,在减轻计算负担的同时
保证识别精度。实验结果显示,该方法可有效剔除冗余电极,提升模型的整体性能,为味
觉脑电信号的高效识别提供了新的解决途径,也为食品感官评价以及味觉认知研究给予了
技术支撑。
5.2 味觉脑电数据集
本章实验使用的数据与第 4 章一致,均来源于味觉脑电数据集,涵盖酸、甜、苦、咸
四种味觉刺激的脑电信号。不同于第 4 章的数据增强,本章主要研究味觉脑电中的信息冗
余问题,重点分析所提出的电极选择方法与 CNN-CSA 模型在味道识别中的表现。数据集
包含 1600 个样本,每个样本有 21 个电极,采样点数为 256。通过相同的数据源,本章与
第 4 章的研究互为补充,提供了模型性能和方法有效性验证的对比基础。
5.3 基于 Grad-CAM 的味觉脑电电极选择与识别方法
5.3.1 方法框架
CAM-Attention 电极选择方法的分析框架如图 5-1 所示,具体步骤如下。
步骤 1:将训练集中的每个味觉脑电样本重塑为 84×64,然后输入 CNN-CSA 模型,进
行酸、甜、苦、咸的分类训练。
步骤 2:将训练好的 CNN-CSA 模型和重塑的训练样本输入 Grad-CAM 模型,生成与
每个训练样本相对应的梯度类激活图。
步骤 3:获得每一类脑电样本的梯度类激活图,并对每一类样本中的所有梯度类激活
图进行平均。例如,酸味脑电的平均梯度类激活图计算如下:
1k
i
label0 i
SourHot Hot
k
= ∑ (5-1)
其中, i
label0
Hot 代表酸味脑电的第 i 个梯度类激活图,k 是酸味脑电中梯度类激活图的
个数。
步骤 4:对四种味觉的平均梯度类激活图进行平均,生成代表四种味觉激活区域的梯
度类激活图 AllHot,用于脑电电极选择。


第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网络的味道识别方法
73
步骤 5:计算 AllHot 中每个电极的类激活值之和,并按降序排序,计算公式如下。
256
1
sort([ , ])
n m n
ChannelList AllHot
=
= ∑  (5-2)
其中,AllHot 中的 m 分别代表脑电电极编号 1、2、......、21。Sort(⋅)表示将每个脑
电电极所对应的数值总和从大到小排序。
步骤 6:确定脑电电极数 Q,在电极列表中选择前 Q 个脑电电极,并在训练集和测试
集中保留对应的电极以生成新的训练集和测试集。将新的训练集和测试集中的每个样本重
塑为 84×64。将重塑后的训练集样本输入 CNN-CSA 模型进行训练,并将重塑后的测试集
样本输入训练后的 CNN-CSA 模型进行测试,以验证模型性能。
图 5-1 CAM-Attention 电极选择方法的整体流程图 Figure 5-1 The overall flow chart of CAM-Attention electrode selection method
5.3.2 Grad-CAM 算法
研究表明,CNN 通过卷积和池化操作能够提取脑电数据的深层特征,在表达更加丰富
的数据信息的同时还能较好地保留数据的空间信息。因此,相较于前端的卷积层和后端的
FC 层,CNN 的最后一个卷积层不仅能够表达深层特征,还能保留脑电的空间信息。Grad
CAM 利用从类别得分到最后卷积层的梯度信息,直观解释了 CNN 在分类和识别过程中的


东北电力大学工学博士学位论文
74
决策机制。在本研究中,Grad-CAM 与 CNN-CSA 模型相结合,用于生成不同类别味觉脑
电的梯度类别激活图,其流程如图 5-2 所示,具体步骤如下。
(1)卷积过程实质上是卷积核的移动。假设直接将 21×256 的原始脑电样本输入 CNN
CSA 模型进行训练,模型会提取更多通道间的脑电特征。然而,该方式不利于生成梯度类
别激活图,难以观察单个脑电通道对分类的贡献。为更有效地挖掘脑电数据在通道间的特
征信息,在输入 CNN-CSA 模型之前,将尺寸为 21×256 的原始脑电样本重塑为 84×64。
图 5-2 Grad-CAM 与 CNN-CSA 模型结合的计算流程图 Figure 5-2 Computational flow chart of the combination of Grad-CAM and CNN-CSA
(2)味觉脑电样本 k
Sc 被重塑为 84×64 后,将其向前传播到训练好的 CNN-CSA 模型
中的 Softmax 层以得到各类别的分数。为了更好地挖掘脑电特征,将通道注意模块(Channel
Attention Module,CAM)和空间注意模块(Spatial Attention Module,SAM)引入 CNN-CSA
模型中,确保梯度类激活图的有效性。计算 Softmax 层之前的类别 c 的得分 yc 相对于最后
一个卷积层之后的脑电特征 Ak 的梯度。计算公式如下:
c k c k
y
GA
∂
= ∂ (5-3)
其中 k
Gc 代表 c 类别的得分在脑电特征 Ak 上的梯度。
(3)对梯度图沿通道维度进行全局平均池化,得到代表梯度图中各通道整体梯度值的
权重 k
ωc 。计算公式如下:
11
1 HW
k
c ij ij
G
HW
ω
==
= × ∑ ∑ (5-4)


第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网络的味道识别方法
75
其中 Gij 代表 k
Gc 中每个通道的特征,H 和 W 代表 Gij 的高度和宽度。
(4)权重 k
ωc 与相应通道的脑电特征 Ak 相乘,并在通道维度的相应位置进行加权处理。
利用 ReLU 激活函数消除与目标类别无关的干扰,突出类别 c 的特征,最终生成一个尺寸
为 5×45 的低分辨率梯度类别激活图 k
Lc 。其计算公式如下
ReLU( )
kk c ck k
L = ω ×A
∑ (5-5)
(5)通过双线性插值将低分辨率梯度激活图 k
Lc 上采样至脑电样本的尺寸,以观察梯
度激活图中不同脑电电极的热度值。然后,进行最小-最大归一化处理,以统一味觉脑电梯
度类激活图中的数值范围。最后,通过最小-最大归一化,得到尺寸为 84×64 的梯度类激活
图k
c
Hot 。
5.3.3 通道和空间注意力机制
注意力机制主要包括通道注意力和空间注意力两种。通道注意力能够在提取深度脑电
特征时,更精准地关注重要通道并忽略冗余信息。空间注意力则能够聚焦特征中的关键空
间位置,在提取浅层特征时更好地挖掘重要的空间特征。本文在 CNN 中引入注意力机制,
以有效提取味觉脑电的关键特征,提高网络的识别性能。其中 CAM 和 SAM 的结构分别如
图 5-3(a)和图 5-3(b)所示。
图 5-3 注意力模块的计算过程
Figure 5-3 The computational process of the attention module


东北电力大学工学博士学位论文
76
对于 CAM,输入的脑电特征 F 的尺寸为 H×W×C。首先,利用平均池化和最大池化对
输入脑电特征 F 的空间信息进行聚合。聚合后的脑电空间信息被分别输入到隐藏层神经元
数为 C/r(其中 r=5,为缩放系数)的共享多层感知机中,从而分别生成两个尺寸为 1×1×C
的交互特征向量。然后,将所得脑电特征向量相加并用 sigmoid 函数激活以生成代表脑电
特征中各通道重要性的权重系数。最后,将权重系数与输入的脑电特征 F 相乘,得到新的
脑电特征 F'。SAM 则侧重表达特征在空间维度上的重要性。输入特征 S 尺寸为 H×W×C。
首先,通过平均池化和最大池化在通道维度上对特征进行聚合,生成两个聚合特征。接着,
将这两个特征沿通道维度拼接为 H×W×2 的特征,以实现信息融合。然后,通过尺寸为 3×3
的卷积核进行特征提取,卷积操作的填充为 1,步长为 1。最后,对卷积后的特征进行 sigmoid
激活,并与输入特征 S 相乘,得到具有空间注意力的新特征 S'。
5.3.4 CNN-CSA 模型
CNN 模型利用卷积以及池化的操作可有效提取味觉脑电数据中的高维特征。近年来,
CNN 在脑电分类任务中获得了广泛的运用,并且展现出了一定优势。本章提出了 CNN-CSA
模型,以实现味觉脑电任务中的电极选择以及味道识别,该模型的结构如图 5-2 所示。
表 5-1 CNN-CSA 模型参数 Table 5-1 CNN-CSA model parameters
序号 操作 核尺寸 步长 填充 输入尺寸 输出尺寸 激活函数 1 卷积 1 3×3 1 1 84×64×1 84×64×8 ReLU 2 SAM — — — 84×64×8 84×64×8 3 最大池化 2×2 2 0 84×64×8 42×32×8 4 卷积2 3×3 1 1 42×32×8 42×32×16 ReLU 5 SAM — — — 42×32×16 42×32×16 6 最大池化 2×2 2 0 42×32×16 21×16×16 7 卷积 3 3×3 1 1 21×16×16 21×16×32 ReLU 8 卷积 4 3×3 1 1 21×16×32 21×16×32 ReLU 9 最大池化 2×2 2 0 21×16×32 10×8×32 10 卷积 5 3×3 1 1 10×8×32 10×8×64 ReLU 11 卷积 6 3×3 1 1 10×8×64 10×8×64 ReLU 12 最大池化 2×2 2 0 10×8×64 5×4×64 13 卷积 7 3×3 1 1 5×4×64 5×4×128 ReLU 14 CAM — — — 5×4×128 5×4×128 15 卷积 8 3×3 1 1 5×4×128 5×4×128 16 最大池化 2×2 2 0 2×2×128 2×2×128 17 展平 — — — 2×2×128 512 18 FC — — — 512 4 19 Softmax — — — 4 4 
CNN-CSA 模型由卷积层、池化层、FC 层、Softmax 层以及注意力模块共同构成,首
先利用卷积层 1 来提取味觉脑电数据的浅层特征,相较于深层特征而言,浅层特征在空域
之中包含更多的冗余信息,因此在进行浅层特征提取时利用 SAM 挖掘关键的空间特征。


第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网络的味道识别方法
77
在卷积层 2 后,再次通过 SAM 提取浅层特征中的关键空间信息,然后利用一系列的卷积
以及池化操作逐步提取深层特征。在经过卷积层 7 后,特征的通道数被扩充到 128,随着
网络深度的不断增加,深层特征中可能存在冗余通道,引入 CAM 以有效关注特征中的关
键通道,去除冗余信息。特征在经过卷积层 8 以及池化操作后被展平,随后依次经过 FC 层
与 Softmax 层来完成最终的分类预测,CNN-CSA 模型的详细参数设置可见表 5-1。
5.4 实验结果与分析
5.4.1 模型设置与评价
味觉脑电样本按照 3:1 的比例随机划分成训练集与测试集,其中,训练集包含 1200
个样本,测试集包含 400 个样本。经过参数预调节后,CNN-CSA 模型的训练集以及测试
集的批量大小分别被确定为 64 和 32,运用 Adam 优化器对模型进行优化,学习率为 0.001,
权重衰减系数是 0.005,最大迭代次数为 200。在模型评价方面,选用准确率以及 F1 分数
为评估电极选择方法有效性以及 CNN-CSA 模型分类性能的评价指标。
5.4.2 味觉脑电电极选择
本节评估了 CAM-Attention 方法与其他经典电极选择方法(如 Lasso[79]、MI-BMInet[81]
和 NMI[82]的有效性。CAM-Attention 与 CNN-CSA 模型相结合,以实现味觉脑电识别。为
保证实验结果的可靠性,每种电极选择方法均进行了五次独立实验,并对实验中所得的最
高准确率和 F1 分数取平均值以评估其性能。
表 5-2 不同电极选择方法的分类结果
Table 5-2 Classification results of different electrode selection methods Channel Lasso(%) NMI(%) MI-BMInet(%) CAM-Attention(%)
准确率 F1 分数 准确率 F1 分数 准确率 F1 分数 准确率 F1 分数
4 59.41 58.52 62.72 62.19 53.70 52.24 80.52 80.04 8 75.07 74.56 73.62 73.80 80.32 79.20 93.47 93.18 12 80.26 80.07 87.49 87.96 88.38 87.83 97.55 97.52 16 81.24 81.01 88.72 89.66 88.38 87.91 97.80 97.79 21 84.36 84.25 89.42 90.34 92.06 91.69 97.99 97.95
表 5-2 展示了不同电极选择方法所对应的分类结果,通过该表可以发现 CAM-Attention
方法的表现要优于其他方法,Lasso 方法的分类效果最差,NMI 和 MI-BMInet 的表现比较
相近。当所选择的电极数量减少时,这四种方法的分类性能都出现了下降,当电极数为 12
时,Lasso、NMI 和 MI-BMInet 的准确率分别是 80.26%、87.49%以及 88.38%,和使用全部
电极时的准确率相比较分别降低了 4.10%、1.93%以及 3.68%。尽管这些方法在减少 FLOPs
方面取得了一定的效果,但其所引起的分类性能下降问题十分突出。相较而言,CAM
Attention 方法在减少电极数量的同时依旧可保持较高的分类性能,当电极数为 12 时,其


东北电力大学工学博士学位论文
78
准确率以及 F1 分数分别是 97.55%和 97.52%,和使用所有电极时相比,仅分别降低了 0.44%
和 0.43%。这表明 CAM-Attention 方法可有效选择关键电极,在有效降低计算复杂度的同
时保持了优异的分类性能。
图 5-4 展示了不同电极选择方法分类结果的折线图,通过观察图 5-4(a)以及图 5-4
(b)可发现,不管是在选择全部电极还是部分电极的情况下,CAM-Attention 方法在准确
率以及 F1 分数方面都要优于其他方法,CAM-Attention 方法在味觉脑电识别任务中有较大
优势。当选择的电极数少于 12 个时,所有方法的识别准确率和 F1 分数都会出现明显下降,
这意味着过度减少电极数会致使关键信息的丢失,影响味觉脑电信号的有效识别,因此在
减少电极数的过程中,要防止丢失对分类十分关键的信息。综合考量分类性能和计算复杂
度,选择 12 个电极是比较合适的方案,与选择 4、8、16 或者 21 个电极相比,选择 12 个
电极可在保留关键特征信息的同时有效提升计算效率,实现识别准确率与效率的较好平
衡。
图 5-4 不同电极选择方法的有效性评估
Figure 5-4 The effectiveness evaluation of different electrode selection methods
5.4.3 味觉脑电识别
Grad-CAM 和 CNN-CSA 模型属于 CAM-Attention 方法中的两个关键部分。浅层网络
可节约计算资源,深层网络则在特征提取上有着一定优势,因此 CNN-CSA 模型网络结构
的变化会对梯度类激活图的生成产生重要影响,这一节选取了在脑电分析中被广泛运用的
浅层经典网络 LeNet5[109]、AlexNet[94]、EEGNet[92]、ViT[110]以及更深层的 ResNet18[91]网络
来剖析网络结构和 Grad-CAM 模型相结合所产生的效果,通过对比上述经典网络与 CNN
CSA 模型的结果来证实 CNN-CSA 模型与 Grad-CAM 模型相结合的有效性。实验中,只有
CAM-Attention 方法中的 CNN-CSA 模型被替换为不同的网络模型,其他参数如批量大小、
优化器、学习率、权重衰减和迭代次数均与 CAM-Attention 方法保持一致。为确保实验的


第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网络的味道识别方法
79
可靠性,每种网络模型下的电极选择方法均进行了五次独立实验,并对准确率和 F1 分数
进行了平均计算。
表 5-3 显示了不同网络结合 Grad-CAM 进行电极选择的结果。在不使用电极选择的情
况下,CNN-CSA 模型达到了 97.99%的准确率和 97.95%的 F1 分数,分别比 AlexNet 高
1.05%、1.07%,比 ViT 高 2.24%、2.55%,比 LeNet5 高 7.96%、8.33%,比 ResNet18 高
9.74%、9.96%,比 EEGNet 高 28.21%、29.93%,这表明 CNN-CSA 模型本身具有更强的味
觉脑电特征挖掘能力。当 EEG 电极数从 21 个减少至 12 个时,所有模型的准确率和 F1 分
数均有所下降,其中 EEGNet、ResNet18、LeNet5、ViT 和 AlexNet 的准确率分别下降了
12.51%、18.66%、5.27%、8.70%和 1.95%,F1 分数分别下降了 12.05%、19.89%、5.39%、
9.39%和 2.04%。然而,CNN-CSA 模型的准确率和 F1 分数几乎没有下降,这表明该模型
与 Grad-CAM 模型结合后很好地保留了味觉脑电中关键的脑电信息,实现了对味觉脑电关
键电极的选择。
表 5-3 Grad-CAM 结合不同网络进行电极选择的分类结果
Table 5-3 Grad-CAM classification results for electrode selection by combining different networks
Channel
EEGNet(%) ResNet18(%)LeNet5(%) ViT(%) AlexNet(%) CNN-CSA(%)
准确率 F1 分
数 准确率 F1 分
数 准确率 F1 分
数 准确率 F1 分
数 准确率 F1 分
数 准确率 F1 分
数
4 33.40 30.98 49.97 47.11 60.32 59.03 48.57 47.27 73.67 72.23 80.52 80.04 8 49.27 46.92 59.87 57.70 76.83 75.96 73.65 72.82 92.09 92.23 93.47 93.18 12 57.27 55.97 69.59 68.10 84.76 84.23 87.05 86.01 94.99 94.84 97.55 97.52 16 61.59 59.65 76.57 75.70 86.03 85.26 94.92 94.72 95.78 95.51 97.81 97.79 21 69.78 68.02 88.25 87.99 90.03 89.62 95.75 95.4 96.94 96.88 97.99 97.95
实验结果表明 CNN-CSA 模型比基于自注意力架构的 ViT 模型表现更好,原因主要有
以下三个方面:
(1)局部特征提取能力
CNN-CSA 模型提取局部区域特征的优势明显,在味觉脑电数据中存在一些和特定味觉
紧密关联的局部脑电模式,CNN-CSA 模型可利用卷积运算有效捕捉这些局部特征,更精
准地区分不同味觉刺激。
(2)数据效率
一般情况下,味觉脑电数据的维度较高且结构较为复杂,ViT 模型需要依赖更多的训练
数据才能实现良好的识别效果,相较而言,CNN-CSA 模型对于局部特征更为敏感,可在数
据条件有限的状况下学习到更好的特征表示。
(3)结合 Grad-CAM 的优势
将 Grad-CAM 与 CNN-CSA 模型相结合可更为精准地选择出关键的味觉脑电电极,
Grad-CAM 通过可视化模型的注意力区域可清晰地识别出味觉脑电中包含关键特征信息的
电极,而 CNN-CSA 模型可以更高效地提取这些关键电极的特征。


东北电力大学工学博士学位论文
80
总之,CNN-CSA 模型在味觉脑电数据任务中有更强的局部特征捕捉本领和更高的数据
分析效率,这些特性使得 CNN-CSA 模型在味觉脑电电极选择以及识别任务中表现更为出
色。
表 5-4 展示了在不同电极数的情况下各类网络模型的 Params 以及 FLOPs,将 EEGNet、
LeNet5 和 AlexNet 模型与 ResNet18 以及 CNN-CSA 模型对比可以发现,EEGNet、LeNet5
和 AlexNet 模型的第一个 FC 层神经元数量会随着样本量的增多而增加,使得网络 Params
随着电极数的增多而增加。随着电极数的减少,这些模型的 FLOPs 也会减少,减少电极数
可提高味觉脑电的识别效率。以 CNN-CSA 模型为例,当脑电电极数从 21 减少至 12 时,
其 FLOPs 减少了 41.18%,但识别准确率和 F1 分数仅分别下降了 0.44%和 0.43%。由此可
见,CNN-CSA 模型结合 Grad-CAM 能够有效选择脑电电极,在保证识别性能的同时,有
效提升了味觉脑电的识别效率。
表 5-4 不同网络、不同电极数量下的 Params 和 Flops
Table 5-4 Params and Flops for different networks and different numbers of electrode channels
Channe l
EEGNet ResNet18 LeNet5 ViT AlexNet CNN-CSA Params Flops Params Flops Params Flops Params Flops Params Flops Params Flops 4 0.29M 1.37M 11.19M 33.97M 1.86M 4.10M 3.10M 3.20G 0.95M 1.87M 1.20M 3.07M 8 0.36M 3.46M 11.19M 67.94M 3.34M 8.16M 3.10M 6.31G 1.34M 4.75M 1.20M 6.13M 12 0.46M 6.14M 11.19M 101.90M 4.81M 12.22M 3.10M 9.44G 1.74M 7.63M 1.20M 9.20M 16 0.61M 10.28M 11.19M 135.87M 6.29M 16.28M 3.10M 12.57G 2.13M 10.50M 1.20M 12.26M 21 0.68M 14.08M 11.19M 186.74M 7.76M 21.26M 3.10M 16.49G 2.72M 14.48M 1.20M 15.64M
图 5-5 不同网络与 Grad-CAM 结合后的性能比较
Figure 5-5 The performance comparison of different networks combined with Grad-CAM
图 5-5 所示的折线图展示了不同网络与 Grad-CAM 结合后的性能。从图中可以看出,
无论选择全部电极还是部分电极,Grad-CAM 与 CNN-CSA 模型的组合在准确率和 F1 分数
方面始终优于其他模型与 Grad-CAM 的组合。同时,随着电极数量的减少,CNN-CSA 模
型准确率和 F1 分数的下降幅度明显小于其他模型。这表明 CNN-CSA 模型能够更有效地


第 5 章 味觉脑电:基于类激活映射电极选择与通道、空间注意力网络的味道识别方法
81
从关键信道中提取重要信息,并在电极选择过程中尽量减少关键信息的丢失,从而确保稳
定的识别性能。
5.4.4 不同味觉刺激下脑区分布
依据图 5-1 所计算得出的各类味觉的平均梯度类激活图如图 5-6 所示,激活图的尺寸
为 84×64,图中纵向的 84 行对应的是空间维度,横向的 64 行代表的是时间维度,每四行
构成一个电极的平均梯度激活区域。观察图 5-6 可发现,不同味觉的平均梯度激活图在局
部位置有差异,但其主要的激活区域大致相同。其中苦味和咸味的激活图相似程度较高,
而甜味和咸味的激活图存在明显差异,这种差异或许可以反映出不同味觉刺激给予被试者
的感受差异,可为未来的研究提供一些线索。
图 5-6 四种味觉脑电的热度图
Figure 5-6 The heat maps of four taste EEG
图 5-7 四种味觉刺激下的激活脑区
Figure 5-7 Brain regions activated by four taste stimuli
对每个平均梯度激活图中的每个电极的热度值分别进行求和操作,之后按从大到小的
的顺序选择出求和后数值处于前 12 的电极,以实现对脑电特征区域的深入分析,接着在
10-20 系统脑电极分布图中标记出这些电极所对应的区域,得到如图 5-7 所示的不同味觉
激活的特征电极的分布情况。整体而言,特征电极主要聚集在大脑的中部与后部区域,这
体现出味觉刺激对这些脑区产生了一定影响,经过分析可以发现,四种味觉的共同特征电
极主要分布于额叶中部、颞叶前部、枕叶以及大脑中央区域,这意味着这些脑区在味觉处
理过程中有一定的共性。但是,不同味觉激活的特征电极在顶叶和颞叶后部的分布存在较


东北电力大学工学博士学位论文
82
大差异,这表明不同味觉刺激会使不同的脑区被激活,不同味觉所激活的脑区分布呈现出
一定的独特性,这一发现证实了味觉信息在大脑中的分布模式,同时也为后续的味觉脑电
信号分析给予了参考。
5.5 本章小结
本章提出了一种名为 CAM-Attention 的味觉脑电电极选择方法,该方法将 Grad-CAM
和 CNN-CSA 模型相结合,可有效提高味觉脑电的识别精准度与效率。本章还设计了用与
采集不同味觉刺激下味觉脑电数据的实验。为更精准地识别味觉脑电的关键特性,提出了
CNN-CSA 模型,该模型可更高效地捕捉味觉脑电的时空特征,提升模型的识别精度。CAM
Attention 方法通过将 CNN-CSA 模型与 Grad-CAM 相结合,可自适应地选择出有助于味道
识别的关键电极,从而更高效地提取出其中的有效特征,以成功区分不同的味觉刺激。总
之,CAM-Attention 方法有效降低了味觉脑电识别任务的计算复杂度,提高了模型的识别
效率,为味觉脑电研究提供了新的思路和技术支持,也为探索其在食物感官评价,脑电信
号处理等领域的潜力奠定了基础。


第 6 章 联觉脑电:基于局部-全局融合网络的风味甜度量化方法
83
第 6 章 联觉脑电:基于局部-全局融合网络的风味甜度量化
方法
世界的复杂性就在于局部与全局的和谐共存。
——法国哲学家、复杂性理论的重要贡献者埃德加·莫兰
莫兰的名言“世界的复杂性就在于局部与全局的和谐共存”深刻揭示了我们研究的核心
思想,在嗅-味联觉脑电信号中,局部的神经活动和全局的脑功能彼此相互交织在一起,共
同构建了复杂的感官交互体验,那么仅依靠局部细节能否充分地理解联觉反应?是否需要
从全局的角度去揭示其中所隐藏的整体联系?传统方法无法同时捕捉这种复杂的两面特
性,而我们所提出的 EEG-LGFNet 模型恰恰是针对这一挑战给出的解答,该模型利用局部
注意力模块深入挖掘脑电信号的细粒度特征,通过全局注意力模块捕捉整体的脑电模式,
二者相互补充配合,让气味增强甜味感知的定量分析变得更加精确,通过这种局部与全局
的平衡方式,我们加深了对嗅-味联觉脑电的理解,揭示了大脑多感官信息处理的深层运行
机制。
6.1 引言
在前几章开展的研究工作中我们针对嗅觉和味觉脑电信号进行了较为细致的分析,探
讨了如多频特征挖掘,跨被试模式识别,数据增强以及电极选择等一系列方法,这些研究
工作揭示出了嗅觉与味觉信息在脑电信号中的表现特征,同时也为后续深入研究复杂风味
感知的神经机制构建了相应的技术基础。然而,即便这些方法在针对嗅觉或者味觉脑电数
据的建模以及优化方面已经取得了一定进展,但它们依然面临着在更为复杂的风味交互任
务中如何实现高效建模的问题。基于此,本章重点关注气味对甜味感知的增强效应,提出
了一种全新的脑电信号分析方法,试图实现对该现象的客观量化。
在食品科学与营养研究范畴,气味对甜味感知所产生的增强效应已然引发了广泛的关
注,甜味感知属于影响食品接受程度以及消费者健康的关键因素,随着“减糖增甜”理念的
推行,怎样在减少糖分摄入之际维持甜味契合感成为了业界关注的重点内容。近年来,气
味增强甜味感知作为一项全新的食品配方策略受到了广泛研究,不过现有工作主要依靠主
观评估,缺少系统的神经科学方面的证据。脑电技术凭借其高时间分辨率的特性,为风味
感知的神经机制研究给予了关键支持。然而,现有的脑电分析方法在特征提取以及模式识
别方面依旧存在诸多挑战,怎样借助脑电技术来客观地量化这一现象成为了亟待解决的问


东北电力大学工学博士学位论文
84
题。前几章的研究已经证实传统的手工特征工程方法难以充分挖掘脑电信号的复杂信息,
而深度学习方法虽然在模式识别方面展现出巨大潜力,但仍需要优化,以适应不同风味刺
激下的脑电变化。本章重点探究如何运用深度学习方法高效表征气味对甜味感知的增强作
用,提出了 EEG-LGFNet 模型,该模型融合了局部注意力和全局注意力机制,可同时提取
脑电信号的短时动态特征以及长时依赖信息,前几章研究提出的脑电特征建模思路对该模
型的设计给予了巨大启发,保证了该模型得以充分发挥深度学习的优势。我们在不同时间
窗口以及脑区范围内对 EEG-LGFNet 进行了验证,结果显示该方法比传统深度学习模型更
具优势,可更准确地量化气味增强甜味感知作用。
在前面几章研究工作的基础上,本章提出了一种嗅-味联觉脑电分析方法,拓展了深度
学习在风味感知研究中的应用,实现了对气味增强甜味感知的客观量化,虽然前几章的方
法没有直接用于本章研究,但它们在脑电特征建模、深度学习优化等方面给出了关键的思
路与启发。本研究为食品科学和神经科学的交叉研究给予了新的视角,还为个性化营养和
食品健康管理提供了技术支持,未来随着 EEG-LGFNet 的优化以及应用推广,该方法有望
成为风味研究的关键分析工具,促使食品行业朝着健康化与个性化方向发展。
6.2 嗅-味联觉实验设计与数据采集
为深入探究气味对人类感知甜味的影响,本研究提出了一种基于脑电技术的气味增甜
表征方法,整体流程如图 6-1 所示。本研究利用蔗糖与气味的混合物同时刺激味觉和鼻后
嗅觉,并采集被试者的脑电信号。脑电信号经预处理后被输入 EEG-LGFNet 模型,以量化
被试者的甜味感知,从神经科学角度解析气味的增甜效应。同时,感官实验中的甜味感官
评分被用作混合物的实际甜味评价,为 EEG-LGFNet 模型提供参考基准。通过不断优化模
型以缩小实际感官甜度与预测感官甜度间的误差,最终实现对气味增甜效果的准确表征。
6.2.1 被试者与实验材料
(1)被试者
通过在学校内张贴有偿招募通知,共有 16 名右利手、不吸烟的志愿者(8 男 8 女,年
龄 20 至 30 岁)报名参与实验。全部志愿者在学校医院完成了身体检查,确认其无精神疾
病史,无嗅觉或味觉障碍,近期无流感、发烧。被试者被要求在实验当天的早上清洁口腔
和头发,并在实验开始前两小时内避免饮食。本研究严格遵循《赫尔辛基宣言》(修订版)
的相关要求,实验方案已获东北电力大学科学研究伦理与科技安全委员会批准。
(2)材料
本研究参考 Barba 等人[111]的方法,选用娃哈哈集团股份有限公司生产的纯净水作为溶
剂基质,配制了不同浓度的蔗糖溶液以及蔗糖与 2-甲基丁酸乙酯的混合溶液。蔗糖溶液包


第 6 章 联觉脑电:基于局部-全局融合网络的风味甜度量化方法
85
括 S1(100 mL 纯净水+2 g 蔗糖)、S2(100 mL 纯净水+4 g 蔗糖)、S3(100 mL 纯净水+6 g
蔗糖)、S4(100 mL 纯净水+8 g 蔗糖)和 S5(100 mL 纯净水+10 g 蔗糖)。混合溶液包括 S
O1(100 mL 纯净水+6 g 蔗糖+1 μL 2-甲基丁酸乙酯)、S-O10(100 mL 纯净水+6 g 蔗糖+10
μL 2-甲基丁酸乙酯)和 S-O100(100 mL 纯净水+6 g 蔗糖+100 μL 2-甲基丁酸乙酯)。
图 6-1 气味增甜表征总览图
Figure 6-1 The overview of sweetening characterization
(3)仪器
本研究使用的脑电诱发仪与第 4 章 4.2.1 中所使用的完全相同,以保证实验溶液可精
确地作用于被试者舌头的中央区域,此系统拥有高稳定性、高精度以及低噪音的特性,其
具体的组成和功能在第 4 章 4.2.1 中有详细说明。此外,本章实验所采用的嗅-味联觉脑电
采集系统和第 2 章 2.2.1 中介绍的实验平台相同,其设备配置、采样频率以及电极布置等
信息可参照第 2 章 2.2.1。
6.2.2 感官训练
本研究的感官训练具体分为两部分,分别是甜味感知训练以及嗅-味联觉感知训练,通
过甜味感知训练使被试者熟悉不同程度的甜味,以便较为客观地评价实验溶液的甜味情
况。通过嗅-味联觉感知训练充分激发被试者的嗅-味联觉感知,以保证被试者对实验溶液
中气味以及甜味的全面感知。
(1)甜味感知
为了建立客观的甜度评价标准,将五种浓度的蔗糖溶液(S1、S2、S3、S4、S5)的甜度
值分别设定为 2、4、6、8 和 10。在 4 秒内将 1 mL 的蔗糖溶液通过脑电诱发仪输送至被试
者舌头中央。输送完毕后,被试者需含住溶液 10 秒,充分体验其甜味。随后,告知被试者


东北电力大学工学博士学位论文
86
每种溶液的甜度值。在脑电实验前,每位被试者需按照上述流程品尝每种浓度的蔗糖溶液
10 次以熟悉不同甜度水平。
(2)嗅-味联觉感知
为了充分激发被试者的嗅-味联觉感知,在 4 秒内通过脑电诱发仪将三种各 1 mL 的蔗
糖与 2-甲基丁酸乙酯的混合溶液(S-O1、S-O10、S-O100)输送至被试者舌头中央。输送完
毕后,被试者需含住溶液 10 秒,并按照要求用嘴吸气、用鼻子呼气,使挥发性气味化合物
通过喉咙进入鼻腔,从而引发鼻后嗅觉。在脑电实验前,每位被试者需按上述流程品尝每
种溶液 10 次,以熟悉嗅-味联觉感知过程。
6.2.3 数据采集与预处理
(1)脑电采集
1)环境:脑电实验前,将实验室温度控制在 21 ± 2°C,保持周围环境安静,避免强电
磁干扰。
2)样品:制备 200 mL 的 S3 溶液,以及 100 mL 的 S1、S2、S4、S5、S-O1、S-O10 和 S
O100 溶液,将所有溶液加热至 37.5°C。将 100 mL 的 S1、S2、S3、S4 和 S5 溶液分别倒入一
次性纸杯中保温。将 100 mL 的 S3、S-O1、S-O10 和 S-O100 溶液分别倒入 250 mL 样品瓶中
保温。
3)采样:为被试者佩戴脑电帽和耳塞。随机选择样品瓶,并将其连接至脑电诱发仪。
调整被试者的座椅高度,使脑电诱发仪的出口位于其舌头中心上方 0.25–0.5 厘米处。启动
脑电诱发仪和脑电采集系统,采集 14 秒的脑电数据,其中前 4 秒为溶液输送时间,后 10
秒为溶液刺激时间。刺激结束后,通知被试者排出口中溶液并用纯净水漱口。然后,以 S1、
S2、S3、S4 和 S5 溶液的甜度评分为参考,要求被试者对所尝溶液的甜度进行评分,并将其
为脑电数据的标签。为确保被试者得到充分休息,每次采样间隔 5 分钟,在此期间使用纯
净水清洗脑电诱发仪的输水管道。上述步骤重复进行,直至采集完所有样品的脑电数据。
4)脑电实验周期:每位被试者共完成 8 次平行实验(重复第 3 步 8 次),每次间隔一
天。共采集 16 名被试者的 512 个脑电片段(16 名被试者×8 个平行实验×4 个刺激条件)。
(2)脑电预处理
使用 MATLAB(R2017b)及其内置的 EEGLAB 工具包(2021 版)对采集到的脑电数
据进行预处理。预处理步骤如下。
1)共采集 512 个脑电片段,去掉每个片段的前 5 秒和最后 1 秒,保留中间 8 秒。随后
将其分割为长度为 1 秒的样本,最终生成 4096 个样本。每个样本的标签与所属片段一致。
2)对样本进行 0.5 至 50Hz 的带通滤波,利用 FIR 滤波器去除低频和高频噪声。同时,
使用通带为 49–51Hz 的陷波滤波器消除工频干扰。为了提高计算效率,将采样率从 256 Hz


第 6 章 联觉脑电:基于局部-全局融合网络的风味甜度量化方法
87
降至 128 Hz,生成尺寸为 128×21 的脑电样本。
3)将降采样后的样本按 3:1 的比例随机分为训练集和测试集,其中训练集包含 3072
个样本,测试集包含 1024 个样本。
6.3 气味增甜感官甜度量化模型
6.3.1 模型框架
EEG-LGFNet 模型框架如图 6-2(a)所示,它主要由 EEG 嵌入、局部-全局融合自注
意力模块(Local Global Fusion Transformer Block,LGFTB)以及定量预测层构成。该模型
可通过对嗅-味联觉脑电信号的分析来客观量化气味对于甜味的增强效应。首先,尺寸为
21×128 的脑电样本被沿时间维度以 1 个步长剪切,生成 128 个尺寸为 21×1 的局部脑电块。
然后,对这些局部脑电块实施编码操作,并且加入量化标记,以丰富和整合脑电特征。接
着,在 128 个编码后的局部脑电块中嵌入位置信息,以突出脑电信号的时间动态特性,提
高对脑电时间特征的理解与分析。然后,将编码信息和量化标记输入四个串联的 LGFTB
中,以挖掘局部与全局脑电特征间的协同关系。最后,脑电特征从 LGFTB 被输入到由两
层 FC 层所构成的定量预测层以实现感官甜度的预测,其中的第一层将神经元数量从 640
减少到 320,第二层将神经元数量从 320 减少为 1。
6.3.2 EEG 嵌入
通过卷积运算将 128 个尺寸为 21×1 的局部脑电块编码为长度为 640 的一维向量,接
着将这些编码后的片段连接并加入一个量化标记,构成尺寸为 640×129 的编码序列,随后
在这个编码序列里嵌入尺寸为 640×129 的可学习位置信息,该过程保证了输入数据的所有
局部特征可被有效整合,同时实现了输入数据和位置信息的充分结合。这不仅增强了模型
的特征表示能力,也为后续的自注意力模块提供了全面又丰富的特征数据。
6.3.3 局部和全局注意力机制
LGFTB 包含 LN、局部注意力、全局注意力以及 MLP 等模块,其结构如图 6-2(b)
所示,尺寸为 640×129 的输入 x 经过 LN 标准化后得到 x′,之后 x′分别被输入到局部注意
力模块以及全局注意力模块,局部注意力模块主要负责提取脑电的局部特征,全局注意力
模块则用于捕捉脑电的整体特征。这两个模块并行运行,各自生成尺寸为 640×129 的输出,
接着将局部注意力模块和全局注意力模块的输出相加,然后再跟输入残差 x 相加,得到融
合特征 x′′,其尺寸为 640×129,融合特征 x′′经过 LN 标准化后输入 MLP 进行非线性变换,
以提取深层特征,然后 MLP 的输出与残差 x′′相加生成最终的输出 y,其尺寸依旧是 640×129。
LGFTB 的设计充分融合了局部和全局注意机制、非线性特征变换以及残差连接,保证了对