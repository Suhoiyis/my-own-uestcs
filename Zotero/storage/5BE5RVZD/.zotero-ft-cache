单 位 代 码 10445
学 号 2022317009
分 类 号 TP391
硕士专业学位论文
癫痫脑电的对比学习特征表示及用于致痫
区识别的脑电预训练模型研究
Contrastive Learning Feature Representation of Epileptic EEG and Pre
trained EEG Models for Seizure Focus Identification
学 位 类 别 :电子信息
领 域 :新一代电子信息技术(含量子技术等)
学 习 方 式 :全日制
研 究 生 :李洁
指 导 教 师 :袁琦 副教授
提 交 时 间 :2025 年 5 月


目录
第一章 绪论...............................................................................................1
1.1 研究背景及意义...............................................................................1
1.2 国内外研究现状...............................................................................2
1.2.1 癫痫发作检测研究现状.............................................................2
1.2.2 致痫区脑电识别研究现状.........................................................5
1.3 论文结构安排...................................................................................7 第二章 基于深度自监督对比学习的癫痫脑电特征学习方法 ..............9
2.1 脑电数据增强.................................................................................10
2.2 基于卷积神经网络的编码器 ........................................................11
2.3 时间对比模块.................................................................................12
2.4 上下文对比模块.............................................................................15
2.5 微调与分类.....................................................................................16
2.6 结果与分析.....................................................................................17
2.6.1 TUSZ 数据库介绍.....................................................................18
2.6.2 预处理.......................................................................................19
2.6.3 评价指标...................................................................................21
2.6.4 实验结果...................................................................................21
2.6.5 对比与讨论...............................................................................22
2.7 本章小结.........................................................................................26
第三章 结合预训练模型的致痫区脑电识别算法 ................................27
3.1 概述.................................................................................................27
3.2 可解释的癫痫脑电预训练模型 ....................................................28
3.2.1 形状表示...................................................................................28
3.2.2 模型架构...................................................................................29
3.2.3 预训练模型...............................................................................33
3.2.4 下游任务的特征表示...............................................................35
3.3 双通道联合特征提取.....................................................................37
3.4 结果与分析.....................................................................................40
3.4.1 Bern-Barcelona 数据库介绍 ....................................................40
3.4.2 脑电数据的标准化...................................................................41
3.4.3 预训练模型配置与训练细节...................................................42
3.4.4 实验结果...................................................................................43
3.4.5 对比与讨论...............................................................................49
3.5 本章小结.........................................................................................54


第四章 总结与展望 ................................................................................56
4.1 工作总结.........................................................................................56
4.2 未来展望.........................................................................................57
参考文献...................................................................................................59


山东师范大学硕士学位论文
I
摘要
癫痫是一种常见的神经系统疾病,尽管目前已有药物、手术和神经调控等治疗手段,
但仍有约三分之一的患者得不到有效的治疗。传统的癫痫诊断方法依靠经验丰富的专家
用肉眼观察脑电图(Electroencephalography,EEG)进行判断,但这种方法不仅主观性强、
误判率高而且耗时费力。此外,传统的机器学习方法难以捕捉癫痫脑电信号中复杂的非
线性特征,而现有的深度学习方法虽然具备较强的特征提取能力,但其解释性相对较弱。
因此,为了提高癫痫诊断的准确性与可解释性,本文分别针对癫痫发作检测和致痫区脑
电识别提出了基于深度学习的方法。
在癫痫发作检测方面,本研究提出了一种基于深度自监督对比学习的癫痫脑电特征
学习方法。该方法首先利用数据增强策略处理癫痫脑电数据,然后通过时间和上下文对
比模块,在增强后的脑电数据集上进行训练并提取抽象特征。时间对比模块根据癫痫脑
电信号的时间序列特性,利用自回归模型来挖掘过去和未来时间点的依赖关系;上下文
对比模块则使用非线性投影对特征进行非线性变换并映射到用于对比的特征空间中,学
习更加有区分性的脑电特征表示。最后将学习到的抽象表示送入 XGBoost 分类器进行分
类。实验结果表明,癫痫脑电特征学习方法的准确率和特异性分别达到了 92.07%和
92.13%,验证了本方法在癫痫分类任务中的优势,以及在癫痫发作检测方面的可靠性。
在致痫区脑电识别方面,本研究设计了双通道联合特征提取框架,并提出了一种可
解释的预训练模型。双通道联合特征提取框架提取了 8 类时域脑电特征和 17 类非线性脑
电特征,融合了脑电信号不同维度的信息,能够全面捕捉信号的特征。而预训练模型能
够将脑电时间序列的子序列拆解为抽象形状、偏移量、缩放等多个属性并学习到一个包
含各种抽象形状的癫痫脑电码本,之后对这些形状进行排列组合可以有效地表示不同的
致痫区脑电数据。将双通道联合特征提取框架提取的特征与可解释的预训练模型提供的
潜在空间标记、编码直方图两种可解释的特征表示,分别输入五种分类器进行组合实验,
实验结果显示两两结合的特征性能优于单一特征的性能,而三者结合的特征在 SVM 分类
器上性能表现最佳,其准确率、敏感度和特异性分别达到了 93.85%、95.1%和 91.51%。
综上所述,本文提出的两种方法提升了癫痫发作检测与致痫区脑电识别的准确性和


山东师范大学硕士学位论文
II
可解释性,为癫痫的精确诊断提供了有力支持。
关键词:癫痫;脑电信号;对比学习;自监督学习;预训练模型
分类号:TP391


山东师范大学硕士学位论文
III
Abstract
Epilepsy is a common neurological disorder, and despite the availability of drugs, surgery
and neuroregulation, about one-third of patients are still not effectively treated. The traditional
method of diagnosis of epilepsy relies on experienced experts to observe Electroencephalography
(EEG) with the naked eye for judgment, but this method is not only subjective, high error rate and
time-consuming. In addition, traditional machine learning methods are difficult to capture complex
nonlinear features in epilepsy EEG signals, while existing deep learning methods have strong
feature extraction capabilities, but their interpretation is relatively weak. Therefore, in order to
improve the accuracy and interpretability of epilepsy diagnosis, this thesis proposes a deep
learning-based method for seizure detection and EEG recognition of epileptogenic regions
respectively.
In terms of seizure detection, this study proposed a method of epileptic EEG feature learning
based on deep self-supervised contrast learning. The method first uses data enhancement strategy
to process epileptic EEG data, and then uses time and context comparison modules to train and
extract abstract features on the enhanced EEG data set. According to the characteristics of epileptic
EEG time series, the time comparison module uses an autoregressive model to find the dependency
between past and future time points. The context contrast module uses nonlinear projection to
transform the features and map them to the feature space for comparison to learn a more
differentiated EEG feature representation. Finally, the learned abstract representation is fed into
the XGBoost classifier for classification. The experimental results showed that the accuracy and
specificity of the proposed method reached 92.07% and 92.13%, respectively, which verified the
advantages of the proposed method in the task of epilepsy classification and its reliability in the
detection of epilepsy.
In terms of EEG recognition of epileptogenic regions, this study designed a dual-channel joint
feature extraction framework and proposed an interpretable pre-training model. The dual-channel
joint feature extraction framework extracts 8 kinds of time domain EEG features and 17 kinds of


山东师范大学硕士学位论文
IV
nonlinear EEG features, and integrates the information of different dimensions of EEG signals to
capture the characteristics of the signals comprehensively. The pre-trained model can disassemble
the subsequence of EEG time series into abstract shape, offset, scale and other attributes, and learn
an epilepsy brain codebook containing various abstract shapes, and then arrange and combine these
shapes to effectively represent different EEG data of epileptogenic regions. The features extracted
by the dual-channel joint feature extraction framework and the interpretable feature
representations provided by the interpretable pre-training model, including potential spatial
markers and coded histogram, were respectively input into five classifiers for combined
experiments. The experimental results show that the performance of the features combined by the
two is better than that of the single feature, and the features combined by the three have the best
performance on the SVM classifier. The accuracy, sensitivity and specificity were 93.85%, 95.1%
and 91.51%, respectively.
In conclusion, the two methods proposed in this thesis have improved the accuracy and
interpretability of epileptic seizure detection and electroencephalogram (EEG) identification of
epileptogenic areas, providing strong support for the precise diagnosis of epilepsy.
Key words: Epilepsy; EEG signals; Contrastive learning; Self-supervised learning; Pre-trained
model
CLC Number: TP391


山东师范大学硕士学位论文
1
第一章 绪论
1.1 研究背景及意义
癫痫是由大脑神经元异常放电所引起的神经系统疾病[1]。全球大约有七千万人因癫痫
发作而影响到正常的工作和生活,中国每年新增的癫痫病例高达四十万到六十万,癫痫
患病率逐年升高。癫痫不仅给患者带来了身体上的痛苦,也给他们的家庭生活造成了沉
重的负担。脑电图(Electroencephalography,EEG)是癫痫检测必不可少的辅助工具,传
统的癫痫检测方法依靠经验丰富的专家用肉眼观察脑电图的波形进行诊断,然而这种方
法存在很多局限性:癫痫脑电图的数据量比较大而且脑电图波形十分复杂,医生在诊断
过程中不仅需要消耗大量的时间和精力,而且长时间进行诊断容易疲劳,可能会导致判
断出错。此外,专业的神经学家和经验丰富的癫痫专家数量有限,无法满足不断增加的
癫痫脑电数据量和日益复杂的诊断需求。因此,人工判读脑电图在当今大环境下面临巨
大的挑战。
传统的机器学习方法能够分析癫痫脑电数据并识别脑电波形中的异常活动,辅助医
生判断癫痫的发生,这在一定程度上提高了诊断的效率。然而传统的机器学习方法依赖
人工设计特征,这不仅会消耗大量的时间而且还需要专家深入分析癫痫脑电信号并手动
选择特征。而且机器学习模型在处理大规模的脑电数据时泛化能力比较差,无法准确捕
捉到脑电信号中复杂的非线性特征,当癫痫发作的样本较少时,容易出现过拟合或欠拟
合的问题,影响最终的检测结果。
深度学习技术的应用推动了癫痫检测技术的发展。深度学习能够在没有人工干预的
情况下自动从癫痫脑电数据中提取出有意义的特征。其多层次的网络结构不仅能够发现
人类专家难以察觉的复杂模式,而且还能准确捕捉到脑电信号中复杂的非线性关系,显
著提高了癫痫发作的检测精度。但是深度学习也有其自身的不足,特别是缺乏可解释性。
虽然深度学习可以自动学习特征并进行识别,但是其内部层次结构复杂而且参数比较多,
这使得模型的决策过程变得复杂,让人难以理解。尽管深度学习算法在癫痫检测和致痫
区识别等方面有着广阔的发展前景,然而其可解释性不足仍然是实际应用中的一大障碍。


山东师范大学硕士学位论文
2
因此,提高癫痫检测的准确性以及克服深度学习算法的可解释性障碍具有非常重要的意
义,不仅可以减少癫痫患者的诊断时间,提高诊断效率,还极大地减轻了医生的工作负
担。
1.2 国内外研究现状
1.2.1 癫痫发作检测研究现状
传统的癫痫检测方法主要依赖时域、频域、时频域和非线性的信号处理技术,通过
人工设计特征并结合浅层分类器实现癫痫发作的检测。在时域方面,Huang 等人提出了一
种基于深度自动编码器的癫痫检测方法,在时域提取均方误差、原始-重建信号比和余弦
相似度等特征,输入随机森林、AdaBoost、梯度提升三种典型分类器进行验证。该方法
计算效率高,能避免时频变换,但特征提取方法的泛化性有待进一步研究[2]。Wang 等人
采用基于时域信号特征的检测算法和新的阈值计算方法,选取信号幅值、信号斜率、线
长和能量四个信号特征作为癫痫检测特征进行分类,准确率达到了 94%[3]。在频域方面,
Polat 等人提出了基于决策树分类器和快速傅里叶变换的混合系统,通过快速傅里叶变换
提取癫痫脑电信号的频域特征,并利用决策树分类器进行癫痫发作检测。该方法分类准
确率较高,但是在特征提取和分类方法的多样性上存在一定局限[4]。
时频域分析结合了时域和频域的优点,能够同时描述信号的时间变化和频率变化。
Dash 等人通过基于高斯窗的斯托克韦尔变换(Gaussian Window-Based Stockwell Transform,
GWST)提取时频域特征,结合多种机器学习(随机森林、支持向量机、XGBoost 等)和
深度学习(长短期记忆网络)模型进行分析,在不同验证方式下均有较高准确率,但是
使用的数据集样本量相对较小[5]。Swami 等人采用进化多目标优化方法从三个不同的数据
库中获取数据并利用小波包变换提取多类型特征,采用广义回归神经网络分类器进行分
类。该方法使用多个数据集,增强了模型的泛化能力,但是多目标优化的参数选择可能
影响结果,需要进一步研究[6]。时频域与非线性特征结合或者多领域特征融合的方法,特
别适用于处理复杂的癫痫脑电信号。Savadkoohi 等人结合巴特沃斯滤波器、傅里叶变换和
小波变换,在时域、频域和时频域对癫痫脑电信号进行特征提取,并采用支持向量机和 K
近邻算法进行分类。该研究在多个域进行特征提取,全面挖掘数据信息,但是未充分探


山东师范大学硕士学位论文
3
讨模型在不同临床场景下的适用性[7]。Kong 等人提出了一种用于癫痫检测的多域特征融
合与选择的方法(PMPSO),以解决现有癫痫检测方法特征选择不佳和冗余度高的问题。
运用离散小波变换和 Welch 方法,从原始 EEG 数据中提取时域、频域、时频域和非线性
特征,使用支持向量机、随机森林和 XGBoost 等多种分类器,基于优化后的特征构建癫
痫检测模型[8]。Fan 等人提出了一种基于尖峰相位锁值(Phase Locking Value,PLV)功能
网络和多领域特征融合的癫痫检测方法,整合时域、频域、通道相关性和尖峰特征并输
入 到 双 向 长 短 期 记 忆 网 络 、Transformer 及 其 优 化 模 型 (Bi-LSTM-Attention、LV
Transformer)中进行分类[9]。
这些传统方法在一定程度上能够识别癫痫发作,但由于手动选择特征的局限性,这
些传统方法在面对复杂癫痫脑电信号模式和噪声环境时的有效性较差。手动特征选择不
仅可能漏掉一些关键的信号特征,还可能增加模型对噪声的敏感性,导致检测精度降低。
随着深度学习理论的不断发展,近年来涌现出很多基于深度学习的癫痫脑电分类算法,
特别是基于卷积神经网络[10](Convolutional Neural Network,CNN)、循环神经网络[11]
(Recurrent Neural Network,RNN)和图神经网络[12](Graph Neural Network,GNN)的
深度学习模型[13],以及多种网络或模块组合而成的混合模型。
基于卷积神经网络的模型通常通过池化和卷积操作提取输入数据的特征,克服了传
统方法中手动特征选择的困难。Zhang 等人采用三种卷积神经网络架构(EEGNet、
Shallow ConvNet、Deep ConvNet) 进 行 发 作 间 期 癫 痫 样 放 电 (Interictal Epileptiform
Discharge,IED)的自动检测,但是实验数据仅来源于 11 名儿童癫痫患者,样本量较小,
模型的普适性有待进一步验证[14]。Abderrahim 等人提出了 4 种深度学习模型(S-CNN、
Modif-CNN、CNN-SVM 和 Comb-2CNN)用于癫痫状态分类,其中 Modif-CNN 表现最佳,
准确率达到了 97.96%,表明模型对癫痫状态分类效果良好,但是实验仅对单通道数据进
行研究,未能充分利用多通道数据的信息[15]。
循环神经网络是一种人工神经网络架构,广泛用于处理时间序列数据。Pilcevic 等人
提 出 了 基 于 改 进 的 混 合 自 适 应 正 余 弦 算 法 (Hybrid Adaptive Sine Cosine Algorithm,
HASCA)RNN 的癫痫检测方法,在二分类实验中达到了 99.87%的准确率,但是此模型的
计算成本和泛化能力仍需要进一步优化[16]。长短期记忆网络[17](Long Short Term Memory,
LSTM)是循环神经网络的一种变体,通过引入门控机制有效解决了传统循环神经网络模


山东师范大学硕士学位论文
4
型中的梯度消失问题。Najafi 等人提出了一种基于离散小波变换的 RNN-LSTM 的癫痫分
类 模 型 , 从 时 域 和 频 域 提 取 15 个 特 征 并 通 过 皮 尔 逊 相 关 系 数 (Pearson Correlation
Coefficient,PCC)分析筛选出显著相关特征(p<0.05),输入到 RNN-LSTM 模型中进行
分类[18]。双向长短期记忆网络(Bidirectional Long Short-Term Memory,Bi-LSTM)是长
短期记忆网络的一种扩展,能够同时考虑序列的过去和未来信息,通过结合正向和反向
信息,能更准确地捕捉复杂的序列依赖关系。Tang 等人通过路径签名(Path Signature)将
多通道头皮 EEG 信号数据转换为高维特征向量并输入到带注意力机制的 Bi-LSTM 网络中
捕捉 EEG 信号的长期依赖特征,在 CHB-MIT 数据集上的平均准确率达到了 99.09%[19]。
Ravi 等人将 CNN 提取的空间特征和 Bi-LSTM 捕捉的时间特征拼接后输入全连接层进行分
类,模型平均准确率达到了 95.90%[20]。
传统深度学习方法局限于处理图像和时间序列数据等规则结构,对于节点和图结构
的复杂关系表达能力有限,基于图神经网络的模型逐渐被提出。Mohammed 等人提出了两
种基于图神经网络的模型 FC-GNN 和 CA-GNN,用于检测脑电图中的癫痫样放电。FC
GNN 利用不同频率子带的功能连接图构建 GNN,捕捉脑区间的耦合关系。CA-GNN 通过
自注意力机制自动学习重要的连接特征,避免手工提取功能连接特征,但是深度学习架
构结果解释性较差,难以像传统机器学习算法那样直观理解模型决策过程[21]。Wang 等人
提出了加权邻接图和双流图框架,使用图神经网络分别聚合时域和频域图的顶点特征并
通过序列卷积模块提取时序特征,融合双流信息后进行癫痫发作分类。该方法在保持信
号信息的同时,大幅降低时间和空间复杂度,但是模型的性能可能受数据集质量和特征
选择的影响,对不同来源和特性的数据集适应性需进一步研究[22]。Liu 等人提出了一种基
于图对比去噪模块(Graph Contrastive Denoising,GCD)的癫痫检测方法,通过预训练和
微调两个阶段优化图结构,预训练时利用对比学习去除噪声,微调时与图神经网络结合
优化参数,有效提升多种 GNN 的性能,但是未充分考虑标签噪声对模型性能的影响[23]。
Abadal 等 人 构 建 了 基 于 图 卷 积 网 络 (GCN)、 图 注 意 力 网 络 (GAT)、 自 监 督 GAT
(SelfGAT)和图 Transformer Networks 的多种 GNN 架构,用于阿尔茨海默病诊断和癫痫
发作分类。经过实验验证,图 Transformer 架构表现出色,在癫痫发作判别中准确率超过
了 96%[24]。这些研究表明,深度学习模型能够自动从原始癫痫脑电信号中提取复杂的特
征,在检测精度和鲁棒性方面显著优于传统机器学习方法。


山东师范大学硕士学位论文
5
目前,越来越多的研究致力于将传统机器学习方法与深度学习技术相结合,或者通
过整合不同的深度学习模块,提出了多种混合模型。Islam 等人提出了一种基于 Base-2
Meta 堆叠分类器的癫痫检测混合模型,结合手动剔除噪声和统计通道选择技术,提取均
值、标准差、均方根能量、功率、近似熵等 34 个特征,以 XGBoost 和 LightGBM 为基础
分类器,多种模型为元分类器进行实验。虽然取得了较高的准确率,但特征数量和特征
排名可能会因后续增加新特征而改变,还需进一步研究[25]。Shen 等人选取 6 个特定的通
道数据,经 6 阶巴特沃斯带通滤波去噪,用短时傅里叶变换进行时频分析并将结果转换为
图像数据,并输入 Google-Net CNN 模型进行分类,在 CHB-MIT 数据库上准确率达到了
97.74%,灵敏度达到了 98.90%[26]。Xu 等人提出了一种结合图卷积网络和卷积神经网络的
动态功能连接神经网络,该网络能够从多通道脑电信号中提取全面特征,其准确率在
CHB-MIT 数据集上得到了显著的提升,但是受训练样本数量和患者个体差异的影响,特
异性结果欠佳,还需进一步研究[27]。癫痫发作检测研究在深度学习的推动下取得了很大
的进步,但仍存在着模型可解释性差、对大规模高质量数据依赖大等问题。
1.2.2 致痫区脑电识别研究现状
致痫区脑电信号的早期识别研究通常采用时域、频域和时频域相结合的方法来提取
特征,并利用机器学习模型进行分类。Madhavan 等人使用同步压缩变换将一维 EEG 信号
转换为二维时频矩阵,实现致痫区脑电信号的精准识别。在 Bern-Barcelona 数据库上,该
方法分类准确率超过了 99%,能有效提取特征,减少冗余信息,但是该方法仅依赖单一数
据库,缺乏多源数据验证[28]。Jabran 等人利用时频分析和电源定位对 19 名患儿的发作间
期癫痫放电进行研究,研究表明时频分析为致痫区识别提供了更多的补充信息,但是样
本量较小,结果的普遍性受限[29]。Al-Salman 等人通过双树复小波变换和快速傅里叶变换
的混合变换提取多尺度时频特征,用最小二乘支持向量机分类器进行分类。在 Bonn 数据
库上平均准确率达到了 97.7%,能有效提取特征,但是模型仅在两个公开数据库上测试,
在其他数据上的有效性需进一步验证[30]。Abirami 等人使用 Temple University Hospital 数据
集中每个癫痫发作信号,计算了时域、频域和时频域的 110 个特征,并使用统计检验和
XGBoost 算法对特征进行了排名,以识别重要特征,构建了基于识别特征和机器学习算法
的二分类和多分类癫痫发作分类系统,但是数据不平衡,部分癫痫类型患者数据较少,


山东师范大学硕士学位论文
6
影响分类平衡[31]。Partamian 等人对 43 例耐药性癫痫患者的发作间期颅内脑电图数据进行
分析,通过人工智能技术自动识别癫痫致痫区,准确率达到了 92%[32]。
致痫区脑电信号具有非线性、复杂和动态的特征,使用非线性方法分析脑电信号可
以提取更多隐含的、难以通过线性特征捕捉到的信息,因此目前很多算法还考虑到了非
线性的分析方法。Sharma 等人利用非线性的三阶累积量分析致痫区脑电信号,运用局部
敏感判别分析降低特征维度并根据判别概率对降维后的特征进行重要性排序,再用 SVM
进行分类[33]。Yakovleva 等人开发了一种利用非线性动力学工具进行分析的方法,计算
Lyapunov 指数谱、多尺度熵和 Lempel-Ziv 复杂度,构建了致痫区脑电信号分析的识别框
架[34]。You 等人结合灵活解析小波变换与熵特征,通过对脑电信号进行 15 级子带分解,
计算对数能量熵和模糊分布熵,使用多种分类器进行分类,最高分类准确率为 94.80%[35]。
Karasmanoglou 等人结合了来自两种模态(脑电图、心电图)的时间、频谱和非线性特征,
采用最小协方差行列式(Minimum Covariance Determinant,MCD)、孤立森林(Isolation
Forest,IsF)、单类支持向量机(One-Class Support Vector Machine,OCSVM)和局部离群
因子(Local Outlier Factor,LOF)等异常检测模型,通过早期融合(数据层面)和晚期融
合(决策层面)处理脑电图和心电图数据[36]。
随着信号处理技术的进步,研究者通过深度学习算法(如 CNN、RNN、LSTM、
GNN 等)实现了致痫区脑电信号的自动识别,显著降低了传统人工判读的主观性。这些
模型通过多模态特征融合策略,整合时域波形、频域功率谱、时频域及非线性动力学等
多维度特征,并通过训练模型自动提取判别性特征进行分类。Sairamya 等人结合小波包分
解的小波系数特征和一维四元二进制模式的直方图特征,使用人工神经网络实现对致痫
区信号的高效分类,分类准确率达到了 95.74%,但是特征向量长度较长,增加了存储和
计算负担[37]。Saminu 等人运用小波变换、同步挤压变换等技术,结合统计和非线性特征
提取方法,提取时频、统计和非线性特征,经特征筛选后用支持向量机、深度神经网络
等进行分类。此方法在分类任务中表现出色,准确率达 99.7%,高于多数对比方法,但是
未深入研究模型超参数优化对结果的影响[38]。Grattarola 等人提出了一种基于注意力机制
的图神经网络的癫痫发作定位方法。通过构建功能网络(FNs)分析颅内脑电图数据,无
需先验标注即可自动定位癫痫发作区,但是仅在 8 名患者数据上验证,样本量小,结论普
适性受限[39]。Liu 等人通过结合强化学习与深度卷积神经网络,添加额外功能模块并运用


山东师范大学硕士学位论文
7
半监督特征选择算法处理脑电信号,在 Bern-Barcelona 数据集上实现了 95.87%的准确率。
该模型虽然通过强化学习实现了特征选择的自动化,减少了人工干预,但模型可解释性
较差而且训练成本比较高[40]。Karimi-Rouzbahani 等人分析了 55 例患者的颅内脑电图数据,
从发作间期和发作期的神经信号中提取 34 种特征,涵盖信号矩特征、非线性复杂度特征、
频域特征和基于网络的特征 4 大类,用决策树分类器进行分类[41]。深度学习方法具有强大
的自动特征学习能力,能够从复杂的脑电信号中提取深层次的特征,在分类准确率上表
现得比传统方法更为优异。但是深度学习模型的可解释性较差,在临床应用中仍然面临
挑战。
1.3 论文结构安排
本文共有四个章节,分别为绪论、基于深度自监督对比学习的癫痫脑电特征学习方
法、结合预训练模型的致痫区脑电识别算法、总结与展望。下面对本文各个章节的内容
做简单介绍:
第一章为绪论。本章简单概述了癫痫检测的研究背景与意义,全面地阐述了癫痫发
作检测系统与致痫区脑电识别系统的国内外研究现状,归纳和总结了经典的脑电分析方
法,最后概括了论文的主要工作内容。
第二章介绍了基于深度自监督对比学习的癫痫脑电特征学习方法。本章节首先详细
阐述了所提出的癫痫发作检测模型的核心组成部分,包括脑电数据增强策略、基于卷积
神经网络的编码器、时间对比模块和上下文对比模块等,介绍了基于特征学习方法所进
行的实验与结果,并说明了所使用的天普大学医院脑电图数据库以及数据预处理过程。
最后通过一系列对比实验验证了本研究所提模型的优越性能,并与其他分类算法进行了
比较。
第三章介绍了结合预训练模型的致痫区脑电识别算法。本章节首先阐述了可解释的
癫痫脑电预训练模型,并对其核心组成部分进行了描述。接着介绍双通道联合特征提取
框架,详细阐述了从原始脑电信号提取的 25 维特征。之后介绍了 Bern-Barcelona 数据库
及标准化等数据预处理操作并通过实验验证模型性能,分析所提取的特征的可解释性以
及特征组合后的效果,并与其他致痫区识别方法进行对比,验证了本方法的优越性。


山东师范大学硕士学位论文
8
第四章为总结与展望。本章对所提出的基于深度自监督对比学习的癫痫脑电特征学
习方法和结合预训练模型的致痫区脑电识别算法这两种方法的主要内容以及所做工作进
行了全面总结,分析两个深度学习模型的优势与不足之处,并给出以后工作中可行的改
进计划。


山东师范大学硕士学位论文
9
第二章 基于深度自监督对比学习的癫痫脑电特征学习方法
图 2-1
本章描述了基于深度自监督对比学习的癫痫脑电特征学习框架,图 2-1 详细介绍了模
型框架的组成部分。针对癫痫脑电信号的特点,本研究设计了弱增强和强增强两种数据
增强策略来捕捉癫痫脑电数据的多样性。以经过增强处理后的脑电数据作为输入送到时
间对比模块中,模块利用两个自回归模型学习脑电数据的时间特征,并在每个时间步长
内建立过去和未来增强脑电特征间的映射关系。上下文对比模块进一步学习更加有区分
性的脑电特征表示,目的是提高同一脑电信号在不同情境下的特征稳定性,同时能够有
效区分不同信号之间的差异。最后通过微调操作让系统能够更加适用于癫痫脑电时间序
列检测任务,并将其与 XGBoost 等多种分类器相结合,构成了完整的癫痫发作检测系统。
基于自监督对比学习的癫痫脑电特征学习框架


山东师范大学硕士学位论文
10
2.1 脑电数据增强
数据增强在本研究所提出的脑电特征学习方法中至关重要。对比学习通过比较不同
样本的脑电特征表示,提取脑电时间序列数据中的有用信息,将相似脑电样本拉近,同
时让不同脑电样本远离,从而使癫痫脑电特征空间中的相似性和差异性更加明显。
在对比学习中,通常使用样本同一增强的两个(随机)变量进行训练,以增强模型
对特征表示的鲁棒性。具体地说,给定一个样本 x ,从同一个增强族 G 中采样,会产生两
个视图 x1 和 x2 ,即 x1 G 和 x2 G 。然而,如果从不同的增强策略生成视图就可以提高
特征表示的鲁棒性。因此本研究采用了两种独立的增强方法:弱增强和强增强[42]。弱增
强通过向脑电信号中添加随机变化并缩放信号的幅度来实现,这种方法相对简单,保留
了原始脑电信号时间序列的结构。强增强采用了一种排列和抖动的策略,将脑电信号分
割成最多 M 段的随机分段,并进行乱序重组。每个段的长度是随机的,对这些段进行随
机排序并在排列后的脑电信号中添加抖动,这种方法比弱增强更加复杂。
原始脑电信号与经过数据增强后的脑电信号的示例如图 2-2 所示。对于每个输入的癫
痫脑电样本 x ,将其强增强视图表示为 xh ,弱增强视图表示为 xl ,其中 h
h
x G, l
l
x G。
这些视图随后被输入到具有卷积架构的编码器中,通过三层卷积进一步提取更高维度的
特征表示[43]。
(a) 弱增强后的脑电数据样本示例


山东师范大学硕士学位论文
11
(b) 强增强后的脑电数据样本示例
图 2-2 原始脑电信号与数据增强后的脑电信号样本示例
2.2 基于卷积神经网络的编码器
受 Wang 等人[44]所提出的三层深度卷积神经网络架构的启发,本研究利用一个三层卷
积神经网络架构来构建编码器,进一步进行更高维度特征的学习。如图 2-3 所示,其主要
由三个卷积模块、池化层、全连接层和输出层组成,其中每个卷积模块在一维卷积层、
批量归一化层和最大池化层三部分的基础上,添加了 ELU 激活函数,激活函数 ( )
f x 如公
式 2-1 所示。
( 1), 0
() , 0
ex x
fx x x
 − 
= 

(2-1)
其中,取值为 1。
为了避免出现过拟合现象,本研究在第一个卷积模块中额外添加了随机丢弃层,按
照 15%的概率随机丢弃神经元中的信息,从而提升模型的泛化能力,减少过拟合。具体的
网络模型参数见表 2-1。
对于输入的脑电样本 x ,基于卷积神经网络的编码器将 x 映射为高维潜在表示(High
Dimensional Latent Representations) ( )
enc
R = f x 。定义 1 2
[ , ,..., ], d
ti
R = r r r r  ,其中 t 为总
时间步长, d 为脑电特征的长度。将强增强的潜在表示 Rh 和弱增强的潜在表示 Rl ,输入


山东师范大学硕士学位论文
12
到时间对比模块中进一步处理。
图 2-3 编码器的三层卷积网络结构
表 2-1 网络模型结构的参数设置
模型结构 参数设置
输入层 input_channels=22
卷积层 1 filters=32, kernel_size=25, stride=1 ,padding=4
卷积层 2 filters=64, kernel_size=8, stride=1, padding=4
卷积层 3 filters=64, kernel_size=8, stride=1, padding=4
最大池化层 1 kernel_size=3, stride=2, padding=1
最大池化层 2 kernel_size=3, stride=2, padding=1
最大池化层 3 kernel_size=3, stride=2, padding=1
随机丢弃层 dropout=0.15
2.3 时间对比模块
时间对比模块利用 Transformer 结构提取脑电时间序列数据的上下文特征,结合历史
信息来预测未来的潜在表示,并利用对比损失函数优化特征表示,使模型能够捕捉癫痫


山东师范大学硕士学位论文
13
脑电时间序列的长程依赖关系并增强特征的鲁棒性,模块具体结构如图 2-4 所示。给定高
维潜在表示 R ,自回归模型 far 将所有 t 时刻之前的 R 编码为上下文向量 ( )
t ar t
T f R
=,
h
Tt  ,其中 h 为 far 的隐藏维度。上下文向量 Tt 包含了癫痫脑电序列截止到时间 t 之前的
所有信息,被用来预测从 Rt+1 到 t k
R + (1  k  K ) 的时间步长。为了预测未来的时间步长,
本研究采用对数双线性模型,将上下文向量 Tt 线性映射到与潜在表示 t k
R + 相同的维度,通
过点积衡量预测与真实值之间的相似度。此模型能够有效保留输入 t k
x + 和上下文向量Tt 之
间的互信息,确保上下文向量包含预测未来所需的特征,从而做出准确的预测:
( ) ()
()
()
, exp T
k tk t k t tk
fx T T R
++
= (2-2)
其中, k 是一个线性函数,将 Tt 映射回与 R 相同的维数,即 : d
k
h→ 。
图 2-4 时间对比模块结构图
相比于循环神经网络,Transformer 不仅能够并行处理所有时间步,加快训练的速度,
而且能够通过自注意力机制捕捉任意距离的时间依赖关系。因此,本研究采用
Transformer 结构作为自回归模型,Transformer 结构主要由多头注意力模块和多层感知机
构成,采用预归一化残差连接使得梯度更加稳定,通过堆叠多个 Transformer 层生成最终
特征提取层。其具体结构如图 2-5 所示,参数设置如表 2-2 所示。
表 2-2 Transformer 结构的参数设置
参数名称 参数含义 参数值
Hidden_dim 隐藏层维度 100
Layers_number Transformer 层数 4
Heads_number 注意力头数 4
Dropout 随机丢弃层 0.1


山东师范大学硕士学位论文
14
受 BERT 模型[45]的启发,本研究在输入中添加了一个特殊标记 h
T  作为上下文向量
Tt ,用于标识序列的起始位置,通过自注意力机制聚合全局的时间序列信息,每层
Transformer 都会更新 T 的状态,最终Tt 包含整个癫痫脑电时间序列的上下文信息。
图 2-5 Transformer 的具体结构
具体来说,给定的输入是某个时间步 t 之前的特征序列 d Time
t
R
  , d 是特征维度,
Time 是时间步长度。将经过编码后的特征向量 t
R 通过一个线性投影层 d h
Tran
→
 进行
映射:
( ), h Time
Tran t
R RR 

=  (2-3)
线性投影层将输入的脑电特征从原始特征维度 d 映射到目标特征维度 h ,不仅能够调
整模型的复杂度,还可以让模型学习到更丰富的特征,提升对输入脑电时间序列的理解。
生成的输出 R 和添加的特殊标记 T 被拼接成一个新的脑电特征向量 ( 1)
0 [; ]
 h Time+ T R
 =,
(h
T  , h Time
R
 ),其中下标 0 表示作为第一个 Transformer 层的输入。
在 Transformer 中,模型通过多个相同的层进行处理,每层包括一个多头注意力模块
( MHA )和一个多层感知机( MLP )模块:
()
 MHA( Norm  1 )  1, 1 L
−−
= +   (2-4)
()
 = MLP ( Norm  ) + , 1   L (2-5)
在第一层中,先进行 MHA 操作,然后加入残差连接,计算公式为:
()
()
1 00
 = MHA Norm  + (2-6)
其中, MHA 是多头注意力机制,输入为通过归一化处理的0 。 Norm 是对0 进行归一化
操作,输出的 ( 1)
1
h Time
 +
 是经过多头注意力模块处理的特征,保留了原始的残差。通过
多头注意力机制,模型能同时关注输入特征的不同部分,捕捉任意距离的时间依赖关系。
然后,对1 进行 MLP 处理,计算公式为:


山东师范大学硕士学位论文
15
()
()
1 11
 = MLP Norm  + (2-7)
其中, MLP 包含了两个全连接层和一个 Re LU 非线性激活函数,加入残差连接1 后得到
的 ( 1)
1
h Time
 +
 作为下一层的输入,通过 MLP 非线性变换,模型可以学习到更复杂的特征
表示。
Transformer 模型包含 L 层,每层都重复以上操作。最后,经过 L 层的 Transformer 层
处理后,提取最终输出的 h (Time 1)
L  +
 的第一个位置(即上下文标记 T 对应的位置)的向
量,得到上下文向量 0 h
Tt =L  ,该上下文向量 Tt 包含了整个时间序列的上下文信息,
将作为后续上下文对比模块的输入。
在跨视图预测任务中,强增强经过 Transformer 结构生成 h
Tt ,弱增强经过 Transformer
结构生成 l
Tt ,使用 h
Tt 预测弱增强 l
tk
R + 的未来时间步长,反之亦然。之后通过时间对比损
失函数最小化同一脑电样本的预测值和真实值之间的点积,同时最大化与批次内其他样
本 t,k 的点积。 Lh 和 Ll 两个损失的计算公式如下:
,
1
exp(( ( )) )
1 log exp(( ( )) )
tk
hT l
K
t tk h hT l n kt
kn
kT R
L K TR
=
+
= −   (2-8)
,
1
exp(( ( )) )
1 log exp(( ( )) )
tk
lT h
K
t tk l lT h n kt
kn
kT R
L K TR
=
+
= −   (2-9)
2.4 上下文对比模块
上下文对比模块旨在学习更加有区分性的脑电特征表示。该模块首先使用非线性投
影对上下文进行非线性变换,将上下文映射到用于对比的特征空间中[46]。对于包含 N 个
样本的脑电数据集,数据增强操作为每个脑电样本生成两个增强视图,从而总共得到 2N
个上下文表示[43]。规定训练模型时一次性输入模型的样本称为同一批次样本,定义同一
输入的两个增强视图为正样本对,而将同一批次内其他输入视为负样本对。对于上下文
i
Vt ,将 i
Vt + 表示为来自相同输入的另一个增强视图 i
Vt 的正样本,因此,( i
Vt , i
Vt + )被定
义为正样本对。同时,将同批次其他输入的剩余 2N − 2 个上下文视为 i
Vt 的负样本,即 i
Vt
可以与其负样本形成 2N − 2 个负样本对。通过上下文对比损失函数来最大化正样本对之
间的相似度,最小化其与同一批次内的负样本对之间的相似度,从而使模型学习到更有


山东师范大学硕士学位论文
16
区分性的表示[42]。其具体结构如图 2-6 所示。
图 2-6 上下文对比模块的具体结构
给定上下文 i
Vt ,将其与其正样本 i
Vt + 的相似度除以其与所有其他 2N −1个样本(包括
正对和 2N − 2 个负对)的相似度,以实现归一化处理。在特征空间中,同一样本的不同
增强视图被拉近,不同样本的上下文被推远,增强了对输入扰动的鲁棒性。对比损失迫
使模型关注样本间的本质差异,而非无关噪声,具体的上下文对比损失函数 Lc 定义如下:
]
2
1 1[
exp( ( , ) / )
log 1 exp( ( , ) / )
ii
N
tt c N im
i mi t t
m
sim V V
L
sim V V



+
==
= −  (2-10)
其中, ( , ) T
sim u v = u v u v 表示余弦相似度;  
[]
1 0,1
mi  是指示函数,当 m  i 时取值为 1;
 是温度参数,控制相似度的敏感度,避免相似度过于尖锐或过于平滑。
总的损失为时间对比损失和上下文对比损失的加权组合,具体形式如下:
12
()
hl c
L =  L + L +  L (2-11)
其中,1 和2 是标量超参数,表示每个损失的相对权重。
2.5 微调与分类
本研究利用增强后的大规模脑电时间序列数据对该对比学习模型进行预训练。预训
练完成后,模型经过微调以便更好地适应癫痫发作检测任务。预训练过程中,模型能够
学习到丰富的脑电特征知识,显著提高了模型脑电特征学习和识别能力。相比于训练一
个全新的网络模型,这种方法不仅大幅度减少了训练时间,还提升了模型在癫痫发作检
测中的性能。


山东师范大学硕士学位论文
17
具体来说,微调过程包括以下几个步骤:首先,保存预训练模型的权重、参数和网
络结构;然后,从指定路径加载已保存的模型,并将其权重融入当前模型;接着,删除
原模型中与输出层相关的权重,并重新训练特定层以更好地适应癫痫发作检测任务;最
后,将更新后的预训练权重加载到当前模型,实现微调,提升模型的检测性能。通过这
种方法,微调后的模型能够充分利用预训练的优势,显著提升训练效率和检测准确性。
本研究从微调后网络模型的倒数第二层提取更加高维抽象的特征表示,提取出来的
特征包含了原始数据丰富的信息,能够体现脑电时间序列数据的复杂模式和特定规律。
将对比学习模型提取的特征作为输入,输入到 XGBoost 分类器中,XGBoost 分类器接收这
些特征并基于这些特征实现对脑电时间序列数据的准确分类。具体流程如图 2-7 所示。
图 2-7 微调与分类流程图
2.6 结果与分析
实验过程主要分为三个阶段:原始脑电数据预处理、模型预训练与微调以及脑电特
征提取与分类。实验流程如图 2-8 所示。本研究使用了六种分类器对提取的脑电特征进行
性能评估,包括 XGBoost 分类器、逻辑回归(Logistic Regression)分类器、AdaBoost 分
类器、随机森林(Random Forest)分类器以及岭回归(Ridge Regression)分类器。各分
类器的具体参数设置详见表 2-3。
图 2-8 实验流程图


山东师范大学硕士学位论文
18
表 2-3 本研究使用的分类器参数列表
分类器 参数
XGBoost min child_weight = 3, max_depth = 3, learning_rate = 0.15, n_estimators = 300
Random Forest n_estimators = 300, random_state = 96
AdaBoost n_estimators = 300, random_state = 42
Logistic Regression max_iter = 200
Ridge Regression Alpha = 10.0
本实验的预训练进行了 40 个周期,批次大小设置为 32。使用 Adam 优化器,将学习
率设置为 4
3 10−
 ,权重衰减设置为 4
1 10−
 , 1 = 0.9 , 2 = 0.99 。对于强增强,本实验设
置 M = 5 ,而对于弱增强,将数据集的缩放比例设置为 2。设置1 = 1,而当2  0.9 时,
模型获得了较好的性能。在上下文对比中,设置 = 0.2 。
实验的预处理阶段使用 MATLAB R2021b 完成,其余算法实现与数据分析在 PyCharm
集成开发环境中基于 Python 3.7 和 PyTorch 1.9.0 进行。硬件平台为搭载 Intel Xeon E5-2623
v4 处理器(4 核,2.6G Hz)的 Windows 10 系统。
2.6.1 TUSZ 数据库介绍
天普大学医院(Temple University Hospital,TUH)脑电图数据库是一个持续更新的
数据集,是目前世界上最大、最全面的开源临床脑电图数据库[47, 48]。数据库的数据类型
多样,涵盖了不同年龄、不同类型以及不同发作状态的患者。本研究使用的 TUSZ(The
Temple University Hospital Seizure Detection Corpus,TUSZ)数据库是 TUH 数据库的一个
子集,拥有超过 30,000 份临床头皮脑电图记录。此数据库包含多导联的脑电图信号,这
些导联均按照国际 10-20 脑电图电极定位系统进行标定,如图 2-9 所示,通道数量从 20 至
128 不等。脑电数据通过 16 位模/数转换器进行数字化处理,以 EDF 格式进行存储,采样
频率范围为 250 至 1024 Hz。TUSZ 数据库还包含 10 多种不同的电极配置和 40 多种通道配
置[49]。对于每一段脑电图记录,TUSZ 数据库都提供了详细的临床信息注释。这些注释包
括患者的基本信息、癫痫发作类型、发作起始时间、发作持续时间等。TUSZ 脑电数据集
分为训练集、验证集和测试集三部分,分别用于模型训练、参数优化和模型评估,且三
者之间不存在重叠。本研究所使用的数据详细信息列于表 2-4。


山东师范大学硕士学位论文
19
图 2-9 国际 10-20 脑电图电极位置和命名系统
表 2-4 用于本研究癫痫检测实验的 TUSZ 数据集
数据集 类别 患者数量
(F:女性)
总时间 (S)
最长时间 (S)
最短时间 (S)
训练集
发作 17(9F) 28308 1240 16
非发作 12(5F) 12204 1800 72
验证集
发作 18(12F) 17724 2340 8
非发作 11(5F) 27504 3168 180
测试集
发作 29(16F) 20356 712 16
非发作 36(18F) 180340 2112 108
2.6.2 预处理
2.6.2.1 降采样
降采样是癫痫脑电信号预处理中的关键步骤,尤其是在特征提取以及癫痫发作检测
等任务中具有重要意义。降采样指的是通过降低信号采样率来减少数据点的数量,在保
留脑电信号的主要特征的同时减少数据量并提高数据处理效率。脑电信号通常以较高的
采样频率进行采集,长时间的脑电信号采集会产生大量的数据,不仅会增加存储成本,
还会在后续的分析处理中消耗大量的计算资源。降采样可以有效降低数据的复杂度还能
减少计算量,提高分析效率。本实验将 TUSZ 数据库中的脑电数据统一降采样至 250 Hz。
2.6.2.2 分段处理
患者的脑电图通道数有 22 个和 20 个两种配置,本实验选择了 22 个通道的配置,具


山东师范大学硕士学位论文
20
体 为 :FP1-F7、F7-T3、T3-T5、T5-O1、FP2-F8、F8-T4、T4-T6、T6-O2、A1-T3、T3-C3、
C3-CZ、CZ-C4、C4-T4、T4-A2、FP1-F3、F3-C3、C3-P3、P3-O1、FP2-F4、F4-C4、C4
P4、P4-O2。为了便于数据的统一处理,本研究对所使用的癫痫脑电信号进行统一的分段
处理:使用一个长度为 4s 的滑动窗口来切割所有的脑电图记录,具体如图 2-10 (a)所示。
例如,一个 10 分钟的脑电图数据在经过四秒的滑动窗口后被分成 150 段,每段 4 秒,每
个片段代表一个样本。长度不足 4 秒的片段及异常数据被剔除。按照 250 Hz 的采样率,
每段包括 1000 个采样点,实验采样了 22 个通道,因此每个样本的尺寸为 22*1000,具体
如图 2-10 (b)和 2-10 (c)所示。
(a) 4 秒滑动窗口
(b) 4 秒癫痫样本 (c) 4 秒非癫痫样本
图 2-10 TUSZ 数据库的脑电示例样本


山东师范大学硕士学位论文
21
2.6.3 评价指标
本研究使用敏感度、特异性、准确率、F1 值和 G-mean 作为衡量模型性能标准的指标。
在本文中正例表示癫痫发作期,负例表示非发作期,其中 TP 是被正确归类为正例的正例
样本,FN 是被错误归类为负例的正例样本,TN 是被正确归类为负例的负例样本,FP 是
被错误归类为正例的负例样本,评价指标的定义如下:
敏感度(Sensitivity,SEN):描述识别出的正例占所有正例的比例。
TP
SEN TP FN
= + (2-12)
特异性(Specificity,SPE):描述识别出的负例占所有负例的比例。
TN
SPE TN FP
= + (2-13)
准确率(Accuracy,ACC):描述正确识别的样本占所有样本的比例。
TP TN
ACC TP FN FP TN
+
= + + + (2-14)
F1 值:综合考虑敏感度和特异性的评价指标,用于评价模型的整体性能。
2
12
TP
F TP FN TN
= + + (2-15)
G-mean:一种用于衡量二分类模型性能的指标,用于评估敏感度和特异性之间的平
衡,特别适用于不平衡数据集。
G − mean = Sensitivity * Specificity (2-16)
2.6.4 实验结果
本研究针对编码器中三层卷积网络结构的不同卷积核尺寸(4、8、12)进行了三轮
测试,结果见表 2-5,该表给出了不同分类器在 4、8、12 三种卷积核尺寸下的敏感度、特
异性、准确性、F1 和 G-mean 的值。如表 2-5 所示,尺寸较大的卷积核虽然可以扩大网络
对输入数据的观察范围,捕捉到更广泛的输入特征,但也会增加模型复杂度和计算资源
消耗。尺寸较小的卷积核在保留更多细节信息的同时降低了模型复杂度,从而实现更快
的分类。
实验结果表明,当卷积核尺寸超过 8 时模型的分类准确率开始下降。综合考虑时间成
本和性能指标,本研究认为当卷积核尺寸为 8 时模型的性能表现最佳。XGBoost 均衡了特


山东师范大学硕士学位论文
22
异性和敏感度,表现出优异的性能,被选定为最终的分类器。其在此卷积核尺寸下的准
确率、敏感度、特异性、F1 分数和 G-mean 分别为 92.07%、91.53%、92.13%、70.06%和
91.83%。
表 2-5 不同分类器在不同卷积核尺寸下的实验结果
卷积核 尺寸
评价指标
(%) XGBoost Random
Forest AdaBoost Logistic
Regression
Ridge Regression
4
ACC 91.19 85.62 91.33 91.94 90.62
SEN 92.12 95.18 89.21 90.56 88.77
SPE 91.09 84.54 91.56 92.09 90.83
F1 67.97 57.32 67.6 69.5 65.76
G-mean 91.6 89.7 90.38 91.32 89.8
8
ACC 92.07 85.82 91.76 92.77 89.68
SEN 91.53 94.47 88.38 88.7 88.09
SPE 92.13 84.85 92.14 93.23 89.86
F1 70.07 57.49 68.51 71.35 63.39
G-mean 91.83 89.53 90.24 90.93 88.97
12
ACC 91.15 83.9 92.15 91.98 91.71
SEN 91.58 96.08 89.68 91.05 87.07
SPE 91.10 82.52 92.43 92.09 92.23
F1 67.74 54.77 69.87 69.75 68.06
G-mean 91.34 89.05 91.04 91.57 89.61
2.6.5 对比与讨论
本部分对特征进行了可视化并讨论了高强度数据增强中脑电信号段数的划分、时间
与上下文对比模型中优化器的选择,以及预训练模型中的批次大小。
本研究采用经典的多维标度(Multidimensional Scaling,MDS)算法,将模型自动学
习的高维脑电特征数据映射至低维空间[50],保留数据点间的距离关系,从而实现脑电特
征分布的可视化,如图 2-11 所示。当采用相关性距离、余弦距离、欧几里得距离和汉明
距离等不同度量时,发作期和非发作期的脑电特征分布均表现出了较好的可分性,进一
步验证了本研究提出的模型在脑电特征学习上的有效性。


山东师范大学硕士学位论文
23
图 2-11 基于 TUSZ 训练集以四种不同的相关距离使用 MDS 算法绘制的样本散点图
在强增强中,将脑电信号分为 M 段的策略对实验效果有重要影响。当 M 值较大时,
每个段的长度较短,有利于捕捉信号中的短期波动和局部特征,但信息量较少,可能影
响模型对信号的整体理解;而 M 值较小时,较长的段包含更多上下文信息,有助于捕捉
全局趋势,但段数较少可能限制模型的泛化能力。实验结果表明,当 M 值设为 5 时,模
型性能最佳,准确率达到了 92.07%,如图 2-12 所示。
图 2-12 不同的 M 值对实验结果的影响
5 10 15
ACC 0.9207 0.8849 0.901
SEN 0.9153 0.9365 0.9119
SPE 0.9213 0.8791 0.8997
F1 0.7007 0.6228 0.6514
G-mean 0.9183 0.9073 0.9058
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95


山东师范大学硕士学位论文
24
图 2-13 三种网络优化器对模型性能的影响
本研究进一步讨论了训练编码器和预训练模型中三种优化器 SGD、Adam 和 RMSprop
在本算法中的性能表现。如图 2-13 所示,Adam 优化器在预训练模型中展现出显著的优越
性,准确率和特异性分别达到了 92.07%和 92.13%。RMSprop 优化器和 SGD 优化器在一
定程度上表现良好,其中 RMSprop 优化器特异性为 92.84%,准确率为 92.43%;SGD 优
化器特异性为 90.43%,准确率为 89.05%。相比于 RMSprop 优化器和 SGD 优化器,Adam
优化器的优势更为明显,性能更加优越。
图 2-14 批次大小对实验结果的影响
本研究对预训练模型的批次大小(MiniBatchSize)进行了对比实验,评估不同批次
大小对模型性能和训练效率的影响。实验中分别使用了 MiniBatchSize 为 16、32、64、128
SGD RMSprop Adam
ACC 0.8905 0.9243 0.9207
SEN 0.7681 0.8876 0.9153
SPE 0.9043 0.9284 0.9213
F1 0.5872 0.7042 0.7007
G-mean 0.8334 0.9077 0.9183
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
16 32 64 128 256
ACC 0.9402 0.9207 0.8962 0.8506 0.8224
SEN 0.807 0.9153 0.9239 0.9377 0.929
SPE 0.9553 0.9213 0.8931 0.8407 0.8104
F1 0.7326 0.7007 0.6436 0.5601 0.5149
G-mean 0.878 0.9183 0.9084 0.8879 0.8677
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1


山东师范大学硕士学位论文
25
和 256,实验结果如图 2-14 所示,当批次大小设置为 32 时模型性能最佳,敏感度为
91.53%,特异性为 92.13%。当批次大小从 32 增加到 64 时,模型的 F1 值明显下降,随着
批次的增加,模型的各项指标都呈现出下降趋势,因此选择 32 作为最佳批次大小。
表 2-6 不同癫痫检测方法在 TUSZ 数据集上的分类结果
作者 方法 ACC
(%)
SEN (%)
SPE (%)
F1 (%)
G-mean (%)
Zhu et al.[51] Meta Learning 67.92 — — 51.03 
Tsiouris et al.[52] Unsupervised module — 93.94 — — 
Zhang et al.[53] DWT+CNN — 59.07 89.72 — 
Ayodele et al.[54] Domain generalization + RCNN — 74.5 — — 
Sabor et al.[55] BHI + CNN + MLP + SVM — 68.2 94.6 — 
Thuwajit et al.[56] EEGWaveNet 67.68 59.21 75.3 47.55 
Rahmani et al.[57] META + GNN 82.7 — — 82.08 
Baghersalimi et al.[58] Federated Learning — 87.94 83.81 — 85.83
Statsenko et al.[59] CNN+Source Reconstruction 96.0 87.7 91.16 — 
本研究 Temporal Contrasting+
Contextual Contrasting + XGB 92.07 91.53 92.13 70.07 91.83
不同癫痫检测方法在 TUSZ 数据库上的分类性能表现如表 2-6 所示。从表中可以看出,
本研究的准确率达到了 92.07%,在这些研究中表现为最佳。其中,Zhu 等人提出用于多类
癫痫发作检测的系统,首次将元迁移学习应用于多类癫痫发作检测,以解决癫痫发作检
测中患者间发作模式差异大的问题,F1 分数达到 51.03%[51]。Tsiouris 等人的方法在敏感度
方面表现优异,达到 93.94%,但该方法仅针对失神发作的脑电数据进行评估,因此其结
果具有特定的局限性[52]。Zhang 等人提出的基于离散小波变换和卷积神经网络的癫痫发作
检测系统(DWT-Net),利用多个特征提取器来增强模型对局部时空特征的识别能力,但
其敏感度和特异性分别为 59.07%和 89.72%,表现出较大的不平衡[53]。Ayodele 等人使用
域泛化方法,整合 CHB-MIT 和 TUSZ 等不同头皮 EEG 数据集,经数据变换、特征提取后
用循环卷积神经网络训练模型,为解决癫痫发作检测中训练数据不足和模型泛化性差的
问题提供了新途径,但也存在难以扩展到颅内脑电图数据的局限性[54]。Sabor 等人提出了
一种基于脑心交互(Brain-Heart Interaction,BHI)的新方法,用于检测癫痫发作及其在
大脑中的放电位置,具有更低的复杂度和更好的性能,其敏感度和特异性分别为 68.2%和


山东师范大学硕士学位论文
26
94.6%,同样存在显著的不平衡[55]。Thuwajit 等人采用多尺度卷积、时空特征提取和分类
器模块构成的多尺度卷积神经网络架构,在 CHB-MIT、TUSZ 和 BONN 数据集上进行评
估,具有可泛化、学习速度快等优点,但在小数据 集上存在复杂度较高的问题[56]。
Rahmani 等人提出了一个个性化的癫痫检测和分类框架,从有限的癫痫样本中快速适应特
定的患者,使用图神经网络结合元学习技术进行癫痫检测和分类任务,其准确率和 F1 分
数分别为 82.7%和 82.08%,但是该方法所用测试集的患者数量仅为 26,而本文实验的测
试集患者数量为 65,是前者的 2.5 倍,这显著提升了实验数据的可信度[57]。
2.7 本章小结
本文结合对比学习与自监督学习,提出了一种用于癫痫发作检测的脑电特征学习方
法,旨在通过增强特征表示的鲁棒性来提升癫痫脑电识别的准确性。该方法首先引入了
脑电时间序列的弱增强和强增强,以捕捉脑电数据的多样性,并通过这些增强来学习脑
电时间序列特征表示。在时间对比模块中,利用过去和未来的增强脑电特征进行预测,
从而使模型在应对时间变化时,能够生成更稳定的脑电特征表示,由此通过挑战模型在
时间维度上的预测能力,促使其学习更具鲁棒性的脑电特征,从而有效抵抗时间步和增
强操作带来的扰动。而上下文对比模块基于时间对比模块生成的脑电特征,进一步提升
了特征的区分度,实现了更精细的脑电时间序列特征学习。最终,通过微调确保了用于
癫痫发作检测任务的高质量脑电特征表示。为了验证本研究提出的方法,本章还进行了
一系列的讨论和对比实验,进一步证明了本研究提出的方法在癫痫发作检测中的优势。


山东师范大学硕士学位论文
27
第三章 结合预训练模型的致痫区脑电识别算法
3.1 概述
针对致痫区脑电信号的非平稳特性,本研究提出了一种双通道联合特征提取框架[40]
(详见 3.3 小节),并结合两种由可解释的癫痫脑电预训练模型衍生的特征表示:潜在空
间标记(Latent-space Tokens)与编码直方图(Code Histogram),构建了一个结合预训练
模型的致痫区脑电识别算法,算法整体流程如图 3-1 所示。
图 3-1 结合预训练模型的致痫区脑电识别算法流程图
双通道联合特征包括 8 类时域特征与 17 类非线性特征,不仅反映出脑电信号的时域
和非线性特性,还为致痫区的脑电识别提供多维度的支持。潜在空间标记能够呈现输入
数据在潜在空间中离散、抽象的形状表示,帮助模型理解脑电信号的变化趋势。而编码
直方图通过可视化样本在码本中的出现次数,直观呈现出不同编码在致痫区与非致痫区
出现的频率差异。这两种特征表示不仅包含了输入数据的关键信息还具有互补性,共同
强化了算法的可解释性。
为了验证不同特征表示对所提算法的性能影响,本研究将两种基于癫痫脑电预训练
模型的特征表示以及双通道联合特征分别输入 XGBoost、Random Forest、AdaBoost、
SVM 和 Ridge Regression 五种分类器进行性能评估。此外还进行了特征组合实验,将三种
特征表示两者结合或者三者结合起来进行分类,以此来评估不同特征组合下的分类性能。


山东师范大学硕士学位论文
28
3.2 可解释的癫痫脑电预训练模型
本研究设计了一个由时间序列编码器、属性解码器、矢量量化模块及形状解码器等
模块组成的具有可解释性的癫痫脑电预训练模型。此模型能够将脑电时间序列的子序列
拆解为多个属性,包括抽象形状、偏移量、缩放、起始时间和持续时间等。经过多个损
失函数的协同作用,模型能够生成包含各种抽象形状的癫痫脑电码本,对这些形状进行
排列组合可以有效地表示不同的癫痫脑电数据。该模型的设计使得癫痫脑电数据的分析
和理解变得更加透明,给临床医生和研究人员对致痫区的研究和诊断提供了更多的参考
依据。
3.2.1 形状表示
在致痫区脑电识别任务中,本研究定义数据集为  
( , ) ( , ) | 1, ,
ii
X Y = x y i =  n ,其中每
个样本 Q T
xi 
 为包含 Q 个变量的多元癫痫脑电时间序列,对应类别标签 
1, ,
yi   J ,
J 为类别的数量。为了深入分析癫痫脑电时间序列的特征,每个多变量的脑电样本可以拆
解为 Q 个独立的单变量序列,记作 m T
xi  , T 表示特征维度。
对于任意单变量癫痫脑电时间序列  
123
, , , ,n
X = x x x x (n 为总长度),定义其子序列
为连续观测值的有限集合。设子序列  
11
, ,,
k i i ik
s xx x
+ +−
= 表示从位置 i 开始、长度为 k 的
局部序列,其中1 i n − k +1。这种滑动窗口式的截取方法能够有效捕捉癫痫脑电时间序
列中的局部模式特征。
图 3-2 子序列分解与属性元组生成流程图
为了实现更精确的建模,本研究提出五种不同属性的组合 ( , , , , )
k k k kkk
 = c p  t l 来描述
癫痫脑电数据中的子序列 sk 的特征。通过五种不同属性组合,模型能够全面捕捉和描述
癫痫脑电信号的各种变化。这些属性包括信号的形状、位置、尺度等,组合起来可以更
准确地反映癫痫脑电信号的不同特性,从而提高模型的精度和可靠性,具体信息如表 3-1
所示。设置最小长度 1/ 64
min
l = 。预训练模型可将单变量癫痫脑电时间序列 X 转化为结构


山东师范大学硕士学位论文
29
化的特征集合  
1, ,
 = k∣k =  K ,其中每个特征元组 k
 包含形状、位置、尺度等多维
度信息[60]。图 3-2 为子序列分解与属性元组生成流程图。
表 3-1 属性元组的具体信息
属性 定义 取值
ck 子序列 sk 抽象形状的编码 code
d
ck  ( 8
code
d =)
pk 子序列 sk 的偏移量 1
pk 
k 子序列 sk 的尺度(标准差) 1
k  ( 0
k  )
tk 子序列 sk 在 x 中的相对起始位置 1
tk  ( 0 1
k min
t  −l )
lk 子序列 sk 相对于 x 的相对长度 1
lk  ( ,
1
1 64
min k k min
l l  −t l = )
3.2.2 模型架构
可解释的癫痫脑电预训练模型基于矢量量化的思想,通过多个编码器和解码器将癫
痫脑电时间序列数据映射到潜在空间生成了包含各种抽象形状的癫痫脑电码本[60]。模型
包含以下几个主要部分:时间序列编码器、时间序列解码器、形状解码器、属性编码器。
图 3-3 展示了可解释的癫痫脑电预训练模型的整体结构。
图 3-3 可解释的癫痫脑电预训练模型的整体结构


山东师范大学硕士学位论文
30
3.2.2.1 时间序列编码器
时间序列编码器采用了基于 Transformer 的分片式时间序列特征编码方法[61, 62],通过
三个阶段的处理将原始癫痫脑电时间序列转化为一种能从整体上把握信息的潜在表示,
时间序列编码器表示为:
 )
ˆ 1, , (
embed
d
k enc
h  ∣k =  K = T x (3-1)
具体来说,单变量癫痫脑电时间序列 L
x  被均匀划分为 k 个非重叠的固定长度的片
段。片段数量 k 与维度 patch
d 由序列总长度 L 及模型参数决定,每个片段包含特定时间窗口
内的局部特征。
随后,各片段通过可学习线性投影矩阵映射到 embed
d 维空间,并采用可训练的位置编
码矩阵对片段进行位置标记,通过向量叠加将时序顺序信息融入特征表示。嵌入矩阵
(0) embed
kd
H
 既包含局部特征细节,又包含全局位置关系。
最后,嵌入矩阵输入多层 Transformer 编码器进行特征优化。通过多头自注意力机制,
Transformer 动态建立了不同片段之间的特征关联,每个片段的表示在迭代更新过程中融
合其他片段的上下文信息。经过 N ( N = 8 )层处理后,Transformer 输出一个更高维度的
潜在嵌入  1
ˆK
kk
h = 。这些潜在嵌入不仅表示单一片段的信息,而且还综合了所有片段的信息,
帮助模型捕捉全局时序特征。图 3-4 展示了时间序列编码器的具体结构。
图 3-4 时间序列编码器结构示意图
3.2.2.2 属性解码器
属性解码器 dec
A 接收潜在嵌入 hˆk ,并提取属性元组 ˆ ( ˆ , , , , )
k k k kkk
 = c p  t l ,每个属性是
通过特定的函数从潜在向量 hˆk 中提取的。
形式上, dec
A 执行:


山东师范大学硕士学位论文
31
()
()
()
()
()
( )( )
()
( )( )
min
min
ˆ
ˆ
ˆ
ˆ
(ˆ , , , , ) ( )
ˆ
ˆ
ˆ1
ˆ1
,
c
p
k k k k k k dec k
kk
kk
kk
kk
k lk k
s
c
p
c p tl A h
t
o
fh
fh
softplus f h
sigmoid f h l
l sigm id f h t l

 

=
=

=

 =
 
= −

= −

=
+
其中 (3-2)
如图 3-5 所示,每个解码函数( , , , ,
cp tl
ff f ff
 )都通过一个具有隐藏层和 ReLU 激活
函数的多层感知机(MLP)来实现。 ˆ k
 表示量化之前的属性元组[63]。该解码器能够从潜
在表示中还原出癫痫脑电时间序列的属性信息,为后续的量化和重建奠定了基础。
图 3-5 属性解码器结构示意图
3.2.2.3 码本与矢量量化
本节通过低维编码将连续特征转换为抽象形状表示,将离散的致痫区脑电码本表示
为  8
1
code
N ii
Cc =
=  ,其中每个向量 ci 代表了码本中的一种基础形状。将编码维度设定为 8
可以迫使模型忽略一些细节噪声,并将注意力集中在具有全局意义的时序模式特征上,
比如趋势、周期等[64]。
编码器输出的连续潜在向量 hˆk 通过线性投影压缩至低维空间 8
cˆk  ,之后进行矢量
量化:
arg min || ˆ ||
i
kk C
i c
c cc

= − (3-3)


山东师范大学硕士学位论文
32
这个过程将连续的特征 ck 转换为癫痫脑电码本中欧氏距离最近的离散编码 ci ,实现
了连续特征到离散符号的转化。离散化过程自动去除了冗余信息,帮助解码器在重建时
生成更有规律、结构清晰的波形。在重建阶段,离散编码 ci 被重新映射至高维空间作为解
码器的输入。解码器输出的癫痫脑电信号将自动对齐至癫痫脑电码本定义的标准模式,
从而抑制过拟合风险。
3.2.2.4 形状解码器
形状解码器的核心目标是将潜在编码还原为与输入子序列形状对齐的癫痫脑电时序
信号。如图 3-6 所示,给定原始癫痫脑电时间序列 X ,从位置 tk 截取长度为 lk 的子序列
[: ]
k kk k
s = x t t + l ,其抽象形状编码 ck 、偏移量 pk 及尺度因子k 构成解码器的输入。
图 3-6 潜在空间结构图
首先通过双线性插值将 sk 标准化为固定长度 d s 的序列 arg s
t et d
sk  ,消除原始长度 lk
的影响:
()
g :
ar
kk k
t et k tt l
s Interpolate x +
= (3-4)
形状解码器 dec
S 基于抽象形状编码 ck 生成一个与插值后的目标子序列 target
sk
t arget
sk 长度
相同的新序列:
ˆ ()
s
norm d k dec k
s  = S c (3-5)


山东师范大学硕士学位论文
33
该输出是去除了尺度信息与偏移量的抽象波形,因此,最终的输出要通过乘以k 和加上
pk 来恢复这些信息,具体表示为:
ˆ ()
ds k dec k k k
s  = S c  + p (3-6)
这个过程将解码器输出的标准化波形 ˆnorm
sk 重新缩放到原始数据的幅度范围,并通过插值
调整波形的长度至目标长度 lk ,确保重建脑电信号 sˆk 在形状、尺度和位置上均与信号
t arget
sk 一致。
3.2.2.5 属性编码与重建
量化后的属性元组 ( , , , , )
k k k kkk
 = c p  t l 通过可学习的线性投影 Linear 映射至低维空间:
embed ( )
d
kk
h  = Linear  (3-7)
其中, k = 1, 2,..., K ,表示不同的时间步。投影通过神经网络中的线性层进行,在训练过
程中能够自适应地调整,从而更好地捕捉到输入数据的潜在结构。时间序列解码器 dec
T接
收所有的 hk ,并基于这些输入生成重建的癫痫脑电时间序列 xˆ 。时间序列解码器的目标是
从这些编码表示中恢复出原始的癫痫脑电时间序列数据。图 3-7 为时间序列解码器的具体
结构图。
图 3-7 时间序列解码器的具体结构图
3.2.3 预训练模型
3.2.3.1 重建损失
时间序列重建要求模型在重建整个时间序列时尽量减少原始输入和重建结果之间的
差异,输出的癫痫脑电时间序列尽可能接近原始输入,并从中提取出潜在空间的有用表


山东师范大学硕士学位论文
34
示。因此,模型通过双重监督机制约束重建过程:
(1)时间序列整体重建损失,通过均方误差约束完整癫痫脑电时间序列重建质量:
2 2
ˆ
|| ||
x = x − x (3-8)
(2)子序列局部重建损失,约束癫痫脑电子序列的形状重建精度:
arg 2 2
1
1ˆ
|| ||
K t et s kk
ks s
k=
=−
 (3-9)
其中 t arget
sk 是对应的目标子序列, sˆk 是重建后的子序列,损失函数 s 通过计算所有子序列
的均方误差的平均值,使模型能够精确地恢复癫痫脑电时间序列中的每个子序列。双重
监督机制不仅确保了时间序列的全局一致性,还强化了子序列的可解释性,从而提高了
模型的准确性。
3.2.3.2 矢量量化损失
受 Van 等人[64]的启发,本研究定义了矢量量化(Vector Quantization)目标函数,用
于训练编码器 enc
T 和癫痫脑电码本 C 。此外,受 Yu 等人[65]的启发,本研究还引入额外的
熵项来提升癫痫脑电码本中各编码的均衡使用率。这种设计可避免模型过度依赖少数编
码而忽略其他编码,通过熵正则化迫使癫痫脑电码本中所有编码被更均匀地选择,提升
表征多样性。完整的码本学习目标函数定义为:
() () ( )
( ) ()
()
2
v commit
2
22
ˆ ˆˆ
c sg sg , ,
ˆ
c  c c H q c C  H q c C 
=− + − + −  

矢量量化损失 码本使用熵项
(3-10)
其中, sg() 为停止梯度算子(Stop-gradient Operator), H () 为离散变量的熵函数。前半
部分的目的是最小化编码器输出的向量 cˆ 和从码本中选出的与 cˆ 最接近的编码 c 之间的距
离。距离度量函数 ( )
2 2
ˆ
( , ) [|| k || | k ]
q c C = softmax c − c c C 将编码向量 cˆ 与癫痫脑电码本 C 中
所有向量 ci 的欧氏距离转化为类别分布,类别分布表示编码器输出的 cˆ 最可能选择癫痫脑
电码本中的哪个编码。具体公式信息如表 3-2 所示。
表 3-2 具体公式的物理意义
项名称 数学表达式 功能
编码器量化损失 2
2
|| cˆ − sg(c) || 迫使编码器输出 cˆ 逼近码本中最邻近的编码 c ,优
化编码
码本更新损失 2
2
ˆ
|| ( ) ||
commit sg c − c 约束码本中的编码 c 逼近编码器输出 cˆ ,优化码本
码本使用熵项 [H (q)] − H ( [q]) 最大化码本的分布熵,避免部分编码被过度使用或
完全忽略


山东师范大学硕士学位论文
35
3.2.3.3 形状解耦损失
在公式 3-9 中,属性元组 ( , , )
kkk
c p  通过精确地重建子序列进行优化。 ( , )
kk
t l 定义了
目标子序列 target
sk 的位置和形状,因此 ( , )
kk
t l 是学习抽象形状和癫痫脑电码本的关键。然而,
仅通过公式 3-8 的时间序列整体重建来选择信息丰富的子序列具有挑战性。因此引入了额
外的正则化项 d ,让潜在空间的标记能够学习到不同位置和尺度上的形状信息,从而更
好地捕捉信号的变化。该正则化项定义为:
( ) ( )( )
()
11 2 2 12
2
d 12 2
2 11
1 1 || , , ||
KK
kk k k
kk
k k relu t l t l
K  
==
=     − − (3-11)
其中 ( )
k, k
 t l 的坐标变换定义为:
( ) ( ) () ( )
( ) () ( )
min
min
cos ln / ln
, sin ln / ln
kk kk kk
ll
l ll
t
tt




= 


(3-12)
()
cos tk 和 ( )
sin tk 提供了 tk 的位置编码, ( ) ( )
min
ln / ln
lk l 对 lk 进行尺度变换,以控制其在
潜在空间中的分布。超参数用于定义变换后的坐标空间中的阈值距离,当两个 ( , )
kk
tl 样
本在该空间中的距离超过此阈值时,则认为它们具备足够的多样性。
整体预训练目标是最小化加权损失:
pre x x s s v v d d
=  + + + (3-13)
其中 x 、 s 、v 、 d 是超参数,用于平衡各损失项的权重。实验中设定 0.25
commit
= ,
d1
xsv
 =  =  =  = 。这些损失项的加权组合共同作用,帮助模型在学习过程中平衡不同
方面的目标,以便在处理形状信息时能够更好地解耦和捕捉多样化的细节,具体公式信
息如表 3-3 所示。
表 3-3 具体公式的物理意义
损失项 主要功能 与 d 的协同效应
x 保证全局时序一致性 防止局部优化破坏时间连续性
s 强化局部形状重建精度 确保分散的 ( , )
kk
t l 仍能精准恢复子序列
v 优化码本与编码器的量化表示 解耦形态与时空信息,支撑全局与局部重建
3.2.4 下游任务的特征表示
可解释的癫痫脑电预训练模型提供了两种核心的特征表示:潜在空间标记和编码直


山东师范大学硕士学位论文
36
方图。潜在空间标记能从复杂的癫痫脑电信号里提取出与癫痫发作相关的波形变化、频
率特征等,编码直方图能够统计不同特征在脑电信号中的出现频率,直观反映癫痫相关
特征的重复规律。潜在空间标记更关注抽象和整体的特征表示,而编码直方图则注重信
号特征的频率和分布。结合这两种表示方式,可以提高模型在致痫区识别中的准确性和
可解释性。
3.2.4.1 潜在空间标记
潜在空间标记(Latent-space Tokens)是模型通过编码器将输入数据映射到低维潜在
空间后生成的离散表示,包含了多个信息维度,如量化后的癫痫脑电码本向量、子序列
的均值与标准差、子序列的起始位置和相对长度等。对于输入的单变量癫痫脑电时间序
列 x,标记表示形式定义为:

4
()
1
(, , ,,)
code K
kd k k k kkk k
  c pt l
+
 =
 = = (3-14)
其中, k 是癫痫脑电时间序列分段的数量, code
d 代表癫痫脑电码本向量维度。这种标记表
示进行了多维信息融合,适用于复杂任务,但在分类任务中的可解释性相对较弱。图 3-8
为潜在空间标记示例图。
图 3-8 潜在空间标记示例图
3.2.4.2 编码直方图
受计算机视觉中概念瓶颈模型(Concept Bottleneck Models,CBMs)的启发[66],本研
究将癫痫脑电码本 C 中的每个编码 ci 视为癫痫脑电时间序列数据中的一个概念。模型通过


山东师范大学硕士学位论文
37
最小化潜在向量 cˆk 与某个编码 ci 之间的距离,确定每个潜在向量所对应的编码索引。编
码索引向量的定义如下:
1,..., 1
ˆ
argmin
code
K
ki iN
k k
i i cc
==

== −


(3-15)
所有潜在向量 cˆk 都被映射到相应的编码索引后,就可以计算直方图表示。编码直方
图(Code Histogram)是一种通过统计各个编码索引出现频率来表示癫痫脑电时间序列数
据的方法,其定义如下:
()
code
N
r  = histogram i (3-16)
其中, r 中的每个元素表示对应的编码索引 i 出现的频率。
3.3 双通道联合特征提取
在致痫区脑电信号识别任务中,特征提取是信号分析与处理的核心环节,其主要目
的是从原始的高维、非平稳脑电信号中提取具有判别性的低维特征表示,以减少数据冗
余、提高可解释性,并为后续分类模型提供有效的区分信息。
传统的线性分析方法主要描述了脑电信号的频率、幅值等基本特征。然而大脑神经
元活动产生的脑电信号不仅是简单的线性变化,而是具有高度的复杂性和非线性特征。
时域特征通过统计方法直接反映癫痫脑电信号的幅值和波动,而非线性特征则从信号动
态变化的角度来评估其复杂性和随机性。结合这两种特征表示,有助于更全面地揭示致
痫区的病理特征,如高频振荡、低熵值和高复杂度,从而为精准识别致痫区提供更有力
的支持。
针对致痫区脑电信号的非平稳特性,本研究提出了双通道联合特征提取框架,从脑
电信号的每个通道中提取 25 维特征,包括 8 类时域统计指标与 17 类非线性动力学指标,
具体如表 3-5 和表 3-6 所示。然后,将两个通道提取的特征进行水平拼接,构建双通道联
合特征。基于 Bern_Barcelona 数据库的双通道癫痫脑电信号,经特征提取与双通道特征融
合后生成的数据集命名为双通道联合特征集,该特征集包含时域与非线性特征的联合表
征,为致痫区脑电识别提供了多个维度的信息。图 3-9 展示了具体的双通道联合特征提取
框架。


山东师范大学硕士学位论文
38
图 3-9 双通道联合特征提取框架
表 3-5 和表 3-6 分别列出了本研究提取的几种重要时域脑电特征和非线性脑电特征,
其中 N 为脑电信号样本的数据长度。
表 3-5 本研究提取的时域脑电特征总结[40]
脑电特征名称 公式 描述
峰度[67]
(Kurtosis, KUS)
()
()
4
1
2 2
1
1 ()
1 ()
N
i
N
i
Xi X
N
KUS
Xi X
N
=
=
− =

−
 


表征信号分布的尖锐程度
均方根[67]
(Root Mean Square, RMS)
2
()
N
iX i
RMS N
=  反映信号的平均能量水平
偏度[67]
(Skewness, SKN)
()
()
3
1
3 2
1
1 ()
1 ()
N
i
N
i
Xi X
N
SKN
Xi X
N
=
=
− =

−
 


反映信号分布的非对称程度
平均绝对偏差 [67]
(Mean Absolute Deviation,
MAD) i 1
1 ()
N
MAD X i X
N=
=−
 衡量信号偏离均值的平均程
度
一阶差分[68]
(First Difference, FD)
1
1
1 | ( 1) ( ) |
1
N
i
FD X i X i
N
−
=
= +−
−  对脑电信号计算一次差分
归一化一阶差分[68]
(Normalized First Difference, NFD)
X
X
NFD 
=  脑电信号的自相似性的度量
二阶差分[68]
(Second Difference, SD)
2
1
1 | ( 2) ( ) |
2
N
i
SD X i X i
N
−
=
= +−
−  对脑电信号计算两次差分
归一化二阶差分[68] (Normalized Second Difference, NSD)
X
x
NSD 
=  脑电信号的自相似性的度量


山东师范大学硕士学位论文
39
表 3-6 本研究提取的非线性脑电特征总结[40]
脑电特征名称 公式 描述
熵[69] —— 表征信号灰度图像 I 的纹理
Tsallis 熵[69]
(Tsallis Entropy, TE) ( , )
,
11
1 jk
jk
TE C
= −
−  信号的不确定性和无序性的
度量
香农熵[69]
(Shannon Entropy, SE) ( )
,,
, log
jk jk
jk
SE = − C C 信号中包含的集合信息量期
望值的度量
雷尼熵 [69]
(Renyi Entropy, RE) ( , )
,
1 log
1 jk
jk
RE C

= −  用于近似脑电信号时间序列
的频谱复杂度
零交叉[70]
(Zero Crossing, ZC)
()
11
11
sgn
N ii
i ii
XX
ZC X X threshold
−+
=+


= 
− 

 信号的符号的变化比率
Hjorth 活动性[71] (Hjorth Activity, HA)
2 x
HA = Hjorth 参数,确定信号的活
动性
Hjorth 移动性[71] (Hjorth Mobility, HM)
x
x
HM 


= Hjorth 参数,确定信号的移
动性
Hjorth 复杂性 [71] (Hjorth Complexity, HC)
/
/
xx
xx
HC  

 

= Hjorth 参数,确定信号的复
杂性
顺序变化的对数根和[71] (Log Root Sum of Sequential Variation, LRSSV)
() ()
2 1 10 1
log 1
N
i
Xi
LRSSV X i
−
=

= 
−−

 衡量信号之间的序列变化程
度
平均曲线长度[72]
(Mean Curve Length, MCL) ( ) ( )
1
11
k
ik N
MCL X i X i
N =− +
= −−
 信号一阶差分绝对值的平均
值
平均能量[72]
(Mean Energy, ME) ( )2
1
1k
ik N
ME X i
N =− +
=  信号中所有样本的平方的平
均值
平均 teager 能量[72] (Mean Teager Energy, MTE)
() () ( )
2
3
11
2
k
ik N
Xi
MTE X i X i
N =− +

−
= 
−−

 一种非线性能量
近似熵[72]
(Approximate Entropy, ApEn)
() ()
m1
m
i1
1 ln
1
Nm i
r cr
Nm
 −+
=
= − +
() ()
m m1
ApEn  r  + r
=−
反映信号中规律性和随机性 的程度
对数能量熵 [73]
(Log Energy Entropy, LEE) ( 2 )
1 log
N i
i
LEE X
=
=  信号的复杂程度的度量
排列熵[74]
(PermutationEntropy, PrEn)
! 2
1
Pr log
D
jj
j
En p p
=
=  基于数据排序关系的复杂性
度量方法
样本熵[74]
(SampleEntropy, SampEn)
() ()
1
lim ln
m
m
N
Br
SampEn B r
+
→



= − 





基于模式相似性来量化时间 序列复杂性的方法
模糊熵[75]
(FuzzyEntropy, FzEn)
( ) ()
11
1 1,
11
,1 1
ss ll xy x y yx
Fg S
s sl

−−
= =

= 
− −− 

() ()
1
ln , ln ,
ll
FzEn  F g + F g
  
=−
  
基于模糊理论的复杂度度量


山东师范大学硕士学位论文
40
3.4 结果与分析
基于 Bern_Barcelona 数据库,将预处理后的脑电信号分别输入双通道联合特征提取框
架与可解释的预训练模型,生成双通道联合特征、潜在空间标记和编码直方图三种特征
表示。为了验证所提致痫区脑电识别算法的有效性,本研究在 Bern_Barcelona 数据库的所
有数据上进行了实验。为了保证结果的可靠性,在实验过程中均采用十折交叉验证,使
用统计指标的平均值作为最终结果。在十折交叉验证法中,患者的脑电数据按 9:1 的比例
分成无重叠的训练集和测试集,交叉验证的划分方式如图 3-10 所示。
图 3-10 数据十折交叉验证示意图
3.4.1 Bern-Barcelona 数据库介绍
Bern_Barcelona 数据库是由伯尔尼大学神经学中心提供的数据库,主要用于癫痫研究。
该数据库采集了五名患有长期耐药性颞叶癫痫患者的颅内脑电信号,使用国际 10-20 电极
系统,参考电极放置在头顶的 Fz 和 Pz 处,采样频率为 512 Hz。每段脑电信号数据的采样
时间为 20 秒,共记录了 10240 个数据点。为了确保数据的质量,所有的脑电信号数据都
经过了四阶巴特沃斯滤波器的处理,滤波范围是 0.5 到 150 Hz,使用了前向和反向滤波技
术以减少信号的相位失真。
该数据库由经验丰富的专家将脑电信号分为致痫区脑电信号与非致痫区脑电信号,
包括 3750 段致痫区的信号和 3750 段非致痫区的信号,共有 7500 段脑电信号,每段脑电
信号包含两个通道的数据。所有脑电信号在正式纳入数据库前经过目视检查,去除了明


山东师范大学硕士学位论文
41
显测量干扰的信号。每个文件包含来自同一时间段记录的两个通道的脑电信号数据样本。
该数据集的致痫区信号与非致痫区信号片段如图 3-11 所示。
(a) 致痫区信号片段
(b) 非致痫区信号片段
图 3-11 Bern_Barcelona 数据集的致痫区信号与非致痫区信号片段示例
3.4.2 脑电数据的标准化
标准化是脑电信号预处理中的重要步骤,通过消除不同特征之间的量纲差异,把所
有特征转换到一个统一的尺度,使它们的均值为 0,标准差为 1。该过程能有效解决因尺
度差异导致的模型权重偏移问题。
原始特征表示为  
12 m
x = x , x ,, x , m 表示特征的个数,则标准化过程定义如下:


山东师范大学硕士学位论文
42
norm 2
x
x
x
x 
−
= +
(3-17)
其中 x 是 x 的均值,即
1
1N
xi i
x
N

=
= ;2
x 是 x 的方差,即 ( )2
2
1
1N
x ix i
x
N

=
=−
 ;5
1 10−
=
是一个小的常数,用于避免方差为零时产生除零错误。
3.4.3 预训练模型配置与训练细节
模型的设置与 MOMENT-Small 模型[62]相对应。具体参数设置如表 3-4 所示,包括将
单变量癫痫脑电时间序列插值的标准长度、分割的非重叠片段以及每个片段的维度,编
码器 enc
T 和解码器 dec
T 中的 Transformer 层包含的注意力头的数量、嵌入维度、前馈层维度
等。本研究采用非对称结构,编码器 enc
T 为 8 层,解码器 dec
T 为 2 层[76],编码器负责提取信
息,而解码器生成最终的输出。经过大量实验验证,本研究将癫痫脑电码本 C 中的编码数
量设置为 64,每个编码的维度设置为 8。目标子序列 target
sk 和解码后的子序列 sk 的长度 d s
设置为 128,最小形状长度 min
l 设置为1/ 64 。
在预训练阶段,本研究使用 SGD 优化器训练模型,使用权重衰减= 0.01,动量参数
1 = 0.9 ,2 = 0.999 ,梯度裁剪阈值为 1.0,且有效批次大小为 128。采用余弦退火学习
率调度策略,初始学习率为 4
1 10−
 ,最终学习率为 5
1 10−
 ,并包含 1 个训练轮次的线性预
热阶段。预训练数据来自 UEA(University of East Anglia)多变量时间序列分类库[77]的 29
个数据集的训练集。
表 3-4 实验参数设置
参数名称 参数意义 参数值
T 插值的标准长度 512
K 分割的非重叠片段 64
patch
d 每个片段的维度 8
heads _ num 注意力头的数量 8
embed
d 嵌入维度 512
ff _ size 前馈层维度 1024
code
N 码本 C 的编码数量 64
code
d 每个编码的维度 8
d s 子序列的长度 128
min
l 最小形状长度 1/64


山东师范大学硕士学位论文
43
3.4.4 实验结果
本实验通过不同特征表示的比较和组合分析,表明特征组合在致痫区脑电信号识别
中具有较好的性能优势。同时,提出的方法在可解释性方面也展示了良好的效果,为脑
电信号的精确分析和致痫区识别提供了新的思路。为了科学、全面地评估模型性能,本
研究使用敏感度(Sensitivity,SEN)、特异性(Specificity,SPE)、准确率(Accuracy,
ACC)、F1 值和 G-mean 作为衡量模型性能标准的指标。关于评价指标的详细内容,请参
阅 2.6.3 小节。
实验结果表明,特征组合不仅提高了致痫区脑电信号识别的准确性,而且在不同的
评价指标上均表现出较强的稳定性和可靠性。此外,模型的可解释性使得研究人员能够
直观地理解特征在决策过程中的贡献,为临床应用提供了更为可信的支持和参考。
3.4.4.1 特征组合
实验将潜在空间标记、编码直方图两种特征表示,以及针对致痫区脑电信号提取的
双通道联合特征,分别单独及组合后输入多种分类器,旨在评估不同特征表示及其组合
在致痫区脑电信号识别任务中的性能表现。
图 3-12 展示了三种单一特征表示和三种组合特征表示在各分类器下的性能指标。如
图所示,对于双通道联合特征分类实验,SVM 分类器的表现最佳,准确率达到了 92.66%,
敏感度达到了 94.4%;XGBoost 分类器的表现也比较好,准确率和敏感度分别达到了 90.53%
和 91.73%。在潜在空间标记的分类实验中,XGBoost 分类器和 Random Forest 分类器的表
现都很好,F1 值分别为 91.67%和 91.93%。在编码直方图的分类实验中,SVM 分类器的
性能指标相对最高,特异性和 F1 分数分别为 89.36%和 89.16%;相比于其他两种特征的分
类实验,编码直方图在五种分类器下的性能表现最差,其准确率和敏感度都没有超过 90%。
在三种组合特征的分类实验中,SVM 分类器的表现最佳,其准确率和敏感度分别为
93.85%和 95.1%;XGBoost 分类器的表现也很好,准确率为 93.24%,敏感度为 94.56%,
F1 值为 93.5%。AdaBoost 和 Ridge Regression 分类器对不同特征的处理效果各有差异,整
体效果不如前三种分类器。相比于三种独立特征的分类实验,特征组合实验在不同分类
器下的性能指标整体呈上升趋势,这表明结合多种特征能够更全面地捕捉致痫区脑电信
号的复杂信息。


山东师范大学硕士学位论文
44
(a) 双通道联合特征 (b) 潜在空间标记
(c) 编码直方图 (d) 三种组合特征
图 3-12 五种分类器在多特征集下性能指标对比图
当把双通道联合特征与潜在空间标记、编码直方图进行组合时,分类性能明显提升。
图 3-13 展示了不同特征两两组合后的分类结果。双通道联合特征与潜在空间标记组合后,
在 XGBoost 分类器上的敏感度提高到 92.7%,相比单独使用双通道联合特征提高了 0.97%;
Ridge Regression 分类器的准确率也由 79.6%提高到 82.8%。编码直方图与潜在空间标记组
合后,在 SVM 分类器中的准确率达到 93.54%,表现出较强的综合性能;相比于单独使用
0 0.2 0.4 0.6 0.8 1
ACC
SEN
SPE
F1
G_MEAN
XGBoost RandomForest Ridge Regression
AdaBoost SVM
0 0.2 0.4 0.6 0.8 1
ACC
SEN
SPE
F1
G_MEAN
XGBoost RandomForest Ridge Regression
AdaBoost SVM
0 0.2 0.4 0.6 0.8 1
ACC
SEN
SPE
F1
G_MEAN
XGBoost RandomForest Ridge Regression
AdaBoost SVM
0 0.2 0.4 0.6 0.8 1
ACC
SEN
SPE
F1
G_MEAN
XGBoost RandomForest Ridge Regression
AdaBoost SVM


山东师范大学硕士学位论文
45
潜在空间标记进行分类实验,AdaBoost 分类器的性能有明显的提升,其特异性和 F1 值分
别提高了 5.5%和 4.6%。在双通道联合特征与编码直方图的组合实验中,SVM 分类器和
XGBoost 分类器的性能表现很好,其敏感度分别达到了 92.67%和 91.32%;相比于单独使
用编码直方图进行分类实验,RandomForest 分类器的性能也有了较大的提升,其敏感度
和 F1 值分别提高了 8.2%和 8.04%。
(a) 双通道联合特征+潜在空间标记 (b) 双通道联合特征+编码直方图
(c) 潜在空间标记+编码直方图 (d) 三种组合特征
图 3-13 特征两两组合及三种特征全部组合后的分类结果
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ACC SEN SPE F1 G_MEAN
SVM AdaBoost Ridge Regression RandomForest XGBoost
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ACC SEN SPE F1 G_MEAN
SVM AdaBoost Ridge Regression RandomForest XGBoost
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ACC SEN SPE F1 G_MEAN
SVM AdaBoost
Ridge Regression RandomForest
XGBoost
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ACC SEN SPE F1 G_MEAN
SVM AdaBoost Ridge Regression RandomForest XGBoost


山东师范大学硕士学位论文
46
当三种特征全部组合时,XGBoost 分类器的 G-mean 值达到了 93.1%,SVM 分类器的
敏感度达到了 95.1%。然而并不是所有的特征组合都能提升性能,有些组合在分类器上的
表现甚至不如单一特征。比如,SVM 分类器在双通道联合特征与潜在空间标记组合的分
类实验中,准确率和敏感度分别为 91.5%和 93.6%,而在单独使用双通道联合特征的分类
实验中,准确率和敏感度为 92.66%和 94.4%,性能指标有所下降。
不同的特征在不同分类器中各有优势。双通道联合特征通过结合时域特征和非线性
动力学特征,能够较全面地描述致痫区脑电信号的特征。潜在空间标记和编码直方图特
征从不同角度对数据进行表示,在 SVM 分类器上表现出色。特征组合实验表明,合理融
合特征可以提高分类性能,但并不是简单地将特征叠加就能取得好效果,特征之间的互
补性和相关性也需要考虑。
3.4.4.2 可解释性
本研究提出的方法在可解释性方面展现出显著优势。双通道联合特征提取框架整合
了 8 类时域统计指标与 17 类非线性动力学指标,从多个维度深入分析原始癫痫脑电信号。
时域统计指标(如均方根、峰度、偏度等)能够反映信号在时间域内的基本统计特
性。例如,峰度反映了信号尖峰的集中程度,与癫痫样放电的突发性相关;而均方根能
够有效揭示癫痫脑电信号的强度、波动性和能量,均方根值的增大表示脑电活动变得更
加剧烈或波动性增强。非线性动力学特征(如近似熵、样本熵等)能够有效捕捉癫痫脑
电信号的复杂性、规律性和非线性特征。
这些特征有助于从更深层次理解脑电信号的潜在模式,进一步提高了信号分析的精
度和可靠性。通过将时域统计与非线性动力学特征相结合,所提框架能够全面而准确地
描述癫痫脑电信号的多样性特征,增强了模型的可解释性。
本研究基于 XGBoost 模型,结合沙普利加性解释(SHapley Additive exPlanations,
SHAP)进行全局特征重要性分析,并绘制了特征贡献度排序图。通过计算每个特征的平
均 SHAP 值的绝对值,并按照各特征对模型输出的平均绝对贡献进行排序,从而展示了各
特征对模型分类结果的影响力。根据图 3-14 可以看出,非线性动力学指标 PrEn(排列熵)
对应的条形最长,占据贡献度首位,表明它对模型分类结果的影响最为显著。而位于末
尾的特征条形较短,说明它们对模型输出的贡献较小。


山东师范大学硕士学位论文
47
图 3-14 基于 SHAP 值的癫痫脑电多维特征全局贡献度排序图
本研究提出的可解释预训练模型通过协同作用不同的损失函数,构建了包含 64 种抽
象形状的癫痫脑电码本。这些抽象形状在不同层次上捕捉了癫痫脑电信号的复杂变化模
式,经过巧妙地排列组合,能够精准且高效地表示各种癫痫脑电信号。这种方法不仅增
强了模型的可解释性,使其能够清晰地捕捉到脑电信号的动态变化趋势,还为致痫区脑
电识别提供了直观且透明的线索。
图 3-15 展示了模型生成的癫痫脑电码本示例图。从图中可以看到,这些抽象形状呈
现出各自独特的曲线形态,每一条曲线都蕴含了特定的脑电信号特征信息。它们或起伏
有致,或平缓延伸,表面上看似简单的线条,实则是复杂脑电活动的高度凝练与抽象表
达,共同构成了一个有序且富有逻辑的癫痫脑电信号表征体系。


山东师范大学硕士学位论文
48
图 3-15 癫痫脑电码本示例图
编码直方图通过可视化样本在码本空间的分布频率,展示了致痫区和非致痫区的频
率差异。如图 3-16 所示,编码 C02 在致痫区的出现频率明显较高,而编码 C22 在非致痫
区更常见。这些差异为分类任务提供了关键依据,模型通过学习这些频率规律来进行分
类。与传统的深度学习模型不同,这种方法通过可视化展示决策过程,让每个频率差异
都可以被追溯,从而明确哪些特征对模型的判断起到了重要作用。
图 3-16 编码直方图示例图
每种特征不仅包含了致痫区和非致痫区脑电信号的信息而且都具有解释性。双通道


山东师范大学硕士学位论文
49
联合特征提取框架通过整合时域和非线性特性,为模型提供了更全面的信号描述。潜在
空间标记和编码直方图展示了模型的决策依据,使分类结果可追溯。结合多维度特征提
取、可解释性模型构建以及决策过程的可视化,本研究为癫痫脑电信号分析提出了一种
新方法,该方法具有显著的可解释性优势,不仅有助于深入理解癫痫的病理机制,也为
临床决策提供了有力支持。
3.4.5 对比与讨论
本部分验证了研究中使用的不同方法的有效性,并讨论了几个关键因素对模型性能
的影响。首先,本研究探讨了不同的权重衰减系数和丢弃率如何影响模型的表现。接着
分析了模型准确率与癫痫脑电码本大小之间的关系,并验证了提取的双通道联合特征在
识别致痫区脑电信号中的有效性。此外还评估了三种优化器 Adam、SGD(随机梯度下降)
和 RMSProp,在预训练模型上的性能表现。同时还展示了不同损失函数在单独使用和协
同使用时的效果。
本实验分别测试了不同的权重衰减系数和丢弃率对模型性能的影响。所有实验均使
用相同的训练集和测试集,使用相同的优化器 SGD 进行训练,并将学习率设置为 4
1 10−
,
批量大小设置为 128,迭代 50 轮,数据为十折交叉验证实验均值。基于可解释的癫痫脑电
预训练模型提取的潜在空间标记特征和编码直方图特征分别进行实验。
(a) 潜在空间标记在不同丢弃率下,准确率随权重衰减情况
0 0.01 0.1 1 10 100
0 0.902 0.8924 0.8835 0.8526 0.8387 0.7918
0.2 0.8635 0.8585 0.8416 0.8296 0.8077 0.7829
0.5 0.8386 0.8297 0.8217 0.7988 0.7859 0.7591
0.8 0.8018 0.7928 0.7639 0.7411 0.7211 0.6992
0.65
0.7
0.75
0.8
0.85
0.9
0.95


山东师范大学硕士学位论文
50
(b) 编码直方图在不同丢弃率下,准确率随权重衰减情况
图 3-17 不同丢弃率下,两种特征准确率随权重衰减变化的情况
图 3-17 展示了不同丢弃率(0、0.2、0.5、0.8)下,两种特征表示准确率随权重衰减
变化的情况。由图 3-17 (a)可以看出,当权重衰减为 0 时,丢弃率为 0 的模型准确率最高,
为 90.2%;随着权重衰减逐渐增大,准确率呈现整体下降的趋势,并且各个丢弃率下的准
确率变化趋势很相似。图 3-17 (b)的结果表明,随着权重衰减不断增加,准确率逐渐降低。
在丢弃率为 0 时,准确率从 87.33%下降到 79.73%;当权重衰减为 0 时,丢弃率为 0.2 的模
型准确率最高,达到了 89.53%。总体来看,权重衰减对模型准确率有显著影响,不同丢
弃率下的影响趋势相似,但程度有所不同。
图 3-18 码本大小对模型准确率的影响
本研究还探讨了模型准确率与癫痫脑电码本大小之间的关系。由图 3-18 可知,对于
0 0.01 0.1 1 10 100
0 0.8733 0.8681 0.8423 0.828 0.8165 0.7977
0.2 0.8953 0.8791 0.8584 0.845 0.812 0.776
0.5 0.8395 0.8304 0.8015 0.7886 0.7457 0.7424
0.8 0.8326 0.7935 0.7647 0.7418 0.7209 0.7016
0.65
0.7
0.75
0.8
0.85
0.9
0.95
32 64 128 512
潜在空间标记 0.8225 0.902 0.9157 0.9285
码本直方图 0.8772 0.8953 0.8821 0.8685
0.7
0.75
0.8
0.85
0.9
0.95
1


山东师范大学硕士学位论文
51
潜在空间标记,当癫痫脑电码本大小为 32 时,模型的准确率为 82.25%,处于较低水平;
随着癫痫脑电码本增大到 64,准确率显著提高到 90.2%。当码本进一步增大到 128 和 512
时,准确率分别提升至 91.57%和 92.85%,呈现出随着码本增大,准确率逐步提高的趋势。
对于编码直方图,使用较小的码本时准确率为 87.72%,但随着码本增大到 64,准确
率提升至 89.53%。然而当码本进一步增大到 128 和 512 时,准确率反而有所下降。这表明
当码本过小时,生成的表示过于抽象,会无法捕捉足够的细节;而当码本过大时,可能
会产生重复或相似的表示,影响分类效果。64 大小的码本在模型预训练中表现最佳,能
够在保持一定抽象性的同时提供足够的细节,从而获得最有效的分类结果。
(a) 双通道联合特征的分类性能 (b) 原始数据的分类性能
图 3-19 双通道联合特征和原始数据的分类性能对比图
本研究通过在双通道联合特征集和原始数据集上进行分类性能评估,进一步验证了
提取的双通道联合特征的有效性。从图 3-19 (a)可以看出,双通道联合特征提取框架将原
始脑电信号的维度从 10240 降到 50,压缩率高达 99.5%,且分类性能得到了显著提升。在
双通道联合特征集上的分类实验,大多数指标都超过了 80%。而图 3-19 (b)显示,相同算
法在原始数据集上的分类性能整体较差,部分指标甚至低于 70%。Ridge Regression 分类
器在原始数据上的准确率为 71.3%,而在双通道联合特征集上提升到了 89.06%。通过对比
两个图中相同算法在不同数据集上的表现,可以明显看出,基于双通道联合特征集的模
型在分类任务中的表现优于原始数据集,有力地证明了该特征集的有效性。
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ACC SEN SPE F1 G_MEAN SVM AdaBoost Ridge Regression
RandomForest XGBoost
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
ACC SEN SPE F1 G_MEAN
SVM AdaBoost Ridge Regression
RandomForest XGBoost


山东师范大学硕士学位论文
52
(a) 不同优化器下潜在空间标记的分类性能 (b) 不同优化器下编码直方图的分类性能
图 3-20 不同优化器下两种特征表示的分类性能结果图
本研究还讨论了预训练模型中 Adam、SGD 和 RMSProp 三种优化器的性能表现。从
图 3-20 (a)可以看出,SGD 优化器在预训练模型中展现出显著的优越性,其准确率和敏感
度分别达到了 90.2%和 93.2%,远超 Adam 优化器和 RMSProp 优化器;在特异性和 F1 值
方面,SGD 优化器也同样领先。总体来说,SGD 在各项指标上都优于其他两个优化器。
图 3-20 (b)显示,SGD 优化器在编码直方图的分类实验中依然表现最优,其准确率为
89.53%,F1 值为 89.16%。RMSProp 优化器表现良好,准确率为 88.12%;Adam 优化器的
表现比较差。总的来说,相比于 RMSprop 优化器和 Adam 优化器,SGD 优化器在这些任
务中的表现更为出色。
图 3-21 各种损失函数单独作用和协同作用的效果对比图
0.67 0.72 0.77 0.82 0.87 0.92
ACC
SEN
SPE
F1
G_MEAN
RMSProp SGD Adam
0.82 0.84 0.86 0.88 0.9 0.92
ACC
SEN
SPE
F1
G_MEAN
RMSProp SGD Adam
0.72
0.74
0.76
0.78
0.8
0.82
0.84
0.86
0.88
0.9
ACC SEN SPE F1 G_MEAN
loss_x loss_v loss_s loss_d loss


山东师范大学硕士学位论文
53
为了更好地处理和分析癫痫脑电时间序列数据,本研究在可解释的癫痫脑电预训练
模型中设计了多种损失函数,包括时间序列整体重建损失 loss_x、子序列局部重建损失
loss_s、矢量量化损失 loss_v、形状解耦损失 loss_d 以及整体的加权损失 loss。
各种损失函数协同作用以实现不同的优化目标,从而提升模型的整体性能。如图 3-21
所示,矢量量化损失函数单独作用时,准确率达到了 86.22%,显著高于其他损失类型,
表明矢量量化损失对提升整体分类准确率起着重要作用。子序列局部重建损失单独作用
时,敏感度和特异性分别为 83.24%和 82.68%,表明子序列局部重建损失能有效捕捉致痫
区脑电信号的特征。在加权损失函数的协同作用下,准确率和特异性分别达到了 89.28%
和 88.2%,综合表现最佳,说明联合优化策略能有效提升模型的分类性能。
表 3-7 Bern-Barcelona 数据库中本方法与其他方法的比较结果
方法 数据量 ACC
(%)
SEN (%)
SPE (%)
F1 (%)
G-mean (%)
DWT, KNN, PNN, LS-SVM[78] F: 50
NF: 50 84 84 84 — 
EMD-DWT, entropy, KNN[79] F: 3750
NF: 3750 89.4 90.7 88.1 — 
EWT, CTM, LS-SVM[80]
F: 50
NF: 50 90 88 92 — 
F: 750
NF: 750 82.53 81.6 83.46 — 
23 Different Features, student t-test, LS
SVM[81]
F: 3750
NF: 3750 87.93 89.97 85.89 — 
WVG, SVM [82] F: 50
NF: 50 92.5 91.25 94.75 — 
Rhythms, SURE entropy, SVM[83]
F: 50
NF: 50 93 90 96 — 
F: 3750
NF: 3750 82.6 — — — 
CWT, Pre-Trained Model[84] F: 3750
NF: 3750 92.27 92.4 92.93 — 
本研究 F: 3750
NF: 3750 93.85 95.1 91.51 93.23 93.3
注:F (Focal) :致痫区脑电信号;NF (Non-Focal) :非致痫区脑电信号。
表 3-7 给出了在 Bern-Barcelona 数据库上,本方法与其他已发表方法的比较结果。
Sharma 等人提出了一种基于离散小波变换和熵特征的集成指数方法,采用 LS-SVM 分类
器实现了 84%的平均准确率、敏感度和特异性[78]。Anindya 等人提出一种基于经验模式分
解和离散小波变换组合域的综合分析方法,利用香农熵、对数能量熵和 Renyi 熵等特征,


山东师范大学硕士学位论文
54
在 KNN 分类器上的准确率达到了 89.4%,灵敏度达到了 90.7%[79]。Bhattacharyya 等人使
用小波变换得到脑电信号重建相空间(Reconstructed Phase Space,RPS),并且进一步得
到它的二维投影。在 50 对和 750 对致痫区和非致痫区脑电信号中,分别实现了 90%和
82.53%的 准 确 率[80]。Acharya 等 人 设 计 了 一 种 计 算 机 辅 助 检 测 系 统 (Computer-Aided
Detection,CAD)用于定位致痫区。将提取的 9 类非线性特征根据 t 检验进行排序,采用
最小二乘支持向量机作为分类器,准确率、敏感度和特异性分别达到了 87.93%、89.97%
和 85.89%[81]。Modaket 等人提出了一种基于加权可见性图理论(Weighted Visibility Graph
Theory)的脑电图信号分析方法,通过提取网络特征并采用支持向量机分类器进行分类,
结 果 显 示 在 最 佳 参 数 下 , 准 确 率 达 到 了 92.5%, 敏 感 度 和 特 异 性 分 别 为 91.25%和
94.75%[82]。Akbari 等人提出了一种基于经验小波变换和非线性特征的自动化方法,利用
支持向量机和 K 近邻分类器进行分类,实验结果表明,采用 SURE 熵的 SVM 分类器在小
数据集和大数据集上的分类准确率分别为 93%和 82.6%,比其他方法提高了约 9%[83]。
Narin 等人提出了一种基于连续小波变换和二维卷积神经网络的方法,通过使用预训练模
型对二维小波图像进行分类,在 InceptionV3 模型上取得了 92.27%的最佳分类准确率,其
敏感度和特异性也分别达到了 92.40%和 92.93%[84]。
以往研究中,部分方法只有准确率、灵敏度和特异性三个评价指标,或者只使用了
Bern-Barcelona 数据库的一部分。然而,本研究使用准确率、灵敏度、特异性、F1 值和 G
mean 五个评价指标来对结果进行全面评估,并完成了数据库中所有脑电数据的检测工作,
因此更具有说服力。从表中可以清晰地看出,在性能评估指标的全面性以及结果的对比
方面,本研究提出的致痫区脑电信号识别算法均展现出显著优势。该算法的准确率
(ACC)、敏感度(SEN)和特异性(SPE)、F1 值和 G-mean 分别达到了 93.85%、95.1%、
91.51%、93.23%和 93.3%,充分证明了本研究方法在 Bern-Barcelona 数据库上具备优异的
性能表现。
3.5 本章小结
本章围绕致痫区脑电信号识别算法展开研究,提出了一种具有可解释性的癫痫脑电
预训练模型。首先详细阐述了模型的时间序列编码器、时间序列解码器、形状解码器、


山东师范大学硕士学位论文
55
属性编码器等核心架构,然后设计了一种多任务优化策略,该优化策略不仅有效提升了
模型性能,还确保了特征提取过程的可解释性。接着详细介绍了 Bern-Barcelona 数据库以
及对数据库中的脑电数据进行了标准化处理。在特征提取方面,本研究基于该预训练模
型提取了潜在空间标记和编码直方图两种特征表示,并针对致痫区脑电信号设计了双通
道联合特征。这些特征分别或组合输入多种分类器以验证模型性能。实验结果显示,该
算法在致痫区脑电信号识别任务中表现优异,准确率为 93.85%,敏感度为 95.1%,特异性
为 91.51%。通过与现有方法的对比实验,进一步验证了模型架构与多损失函数设计的有
效性,尤其是在可解释性方面,潜在空间标记与编码直方图的应用使得模型的决策过程
变得更加透明可见,从而为脑电信号的分析和临床诊断提供了可靠的技术支持。


山东师范大学硕士学位论文
56
第四章 总结与展望
4.1 工作总结
传统的时频分析方法往往难以实现癫痫脑电信号的精确重建,从而影响分类效果。
本研究专注于癫痫脑电信号的分析与处理,旨在提高癫痫发作检测和致痫区脑电信号识
别的准确性和效率。在研究背景和意义部分,本文强调了癫痫疾病研究的临床价值和社
会重要性。通过梳理国内外相关研究现状,发现当前癫痫发作检测和致痫区识别方法存
在一定的局限,这为本文提供了研究的切入点。
在基于深度自监督对比学习的癫痫脑电特征学习方法中,首先对所提出的模型架构
进行了详细的介绍。本研究采用两种独立的数据增强方法,通过向脑电信号中引入随机
变化或打乱信号结构并加入抖动来增强数据的多样性。将经过数据增强处理后的癫痫脑
电信号作为输入送到基于卷积神经网络构建的编码器中,进行更高维度特征的学习。时
间对比模块采用自回归模型来优化对比损失,通过建立过去和未来增强脑电特征间的映
射关系来提取脑电时间序列数据中的时间特征。而上下文对比模块通过上下文对比损失
函数来最大化正样本对之间的相似度,最小化其与同一批次内的负样本对之间的相似度,
进一步学习更加有区分性的脑电特征表示。完成预处理步骤的 TUSZ 癫痫脑电数据在经过
微调处理后的模型上取得了较好的检测效果,本研究通过科学的评价指标对实验结果进
行分析得到其准确率、敏感度、特异性、F1 分数和 G-mean 分别为 92.07%、91.53%、
92.13%、70.06%和 91.83%。最后将基于深度自监督对比学习的癫痫脑电特征学习方法与
其他方法进行对比讨论,验证了本文所提方法的有效性。
针对致痫区脑电信号识别,本文有效设计了结合预训练模型的致痫区脑电识别算法。
首先介绍了所提出的由时间序列编码器、属性解码器、形状解码器等模块构建的可解释
的癫痫脑电预训练模型,该模型能够将脑电时间序列的子序列拆解为多个属性,包括抽
象形状、偏移量、缩放、起始时间和持续时间等。通过重建损失、矢量量化损失与形状
解耦损失的多任务优化策略,模型能够学习到一个包含各种抽象形状的癫痫脑电码本,
这些形状通过排列组合可以有效地表示不同的癫痫脑电时间序列数据。而且模型能够提


山东师范大学硕士学位论文
57
供两种可解释的特征表示:潜在空间标记和编码直方图。将这两种特征表示与提取的双
通道联合特征进行组合,能够有效提高致痫区脑电信号的识别精度。通过五个评价指标
对模型性能进行了深入分析,并与传统方法进行了对比。结果表明,提出的模型在致痫
区脑电信号的识别任务中具有显著优势,其准确率、敏感度、特异性、F1 值和 G-mean 分
别达到了 93.85%、95.1%、91.51%、93.23%和 93.3%。在可解释性方面,潜在空间标记和
编码直方图的结合应用使得模型的决策过程更加清晰,为癫痫临床诊断提供了技术支持。
4.2 未来展望
本文提出的两个模型分别在 TUSZ 数据库和 Bern_Barcelona 数据库上进行了训练学习
和实验检测,并在这两个数据库上取得了令人满意的实验结果。但是,此项工作依然存
在局限性和不足,需要进一步优化和验证。未来的工作将从以下几个方面展开:
(1)自适应数据增强策略。在基于深度自监督对比学习的癫痫脑电特征学习方法中,
弱增强和强增强的设计只针对实验中使用的 TUSZ 数据库,对其他癫痫脑电数据库的适用
性有待验证。未来考虑设计基于元学习的增强策略,自动优化增强参数(如抖动强度、
分段数),适应不同的数据分布。
(2)对比学习任务改进。时间对比模块和上下文对比模块的设计可能无法充分捕捉
时间序列数据的重要特征和复杂关系,在处理具有特殊时间依赖或复杂上下文结构的数
据时可能存在局限性。未来将结合时间序列的因果关系、周期性等特征,优化时间对比
模块的预测任务,使其能更好地捕捉时间序列的动态变化。改进上下文对比模块,增强
模型对复杂上下文结构的理解和处理能力,从而进一步提升模型的学习能力。
(3) 模 型 优 化 与 轻 量 化 。 模 型 包 含 时 间 对 比 模 块 和 上 下 文 对 比 模 块 , 且 使 用
Transformer 作为自回归模型,整体结构较为复杂。这导致模型训练对计算资源的需求较
高,训练时间相对较长。未来将尝试采用更高效的网络架构或改进现有的模块设计,减
少模型参数数量,提高模型训练速度,降低对计算资源的依赖。
(4)优化特征的提取和组合方式。未来研究会进一步探索优化这些特征的提取和组
合方式,以提升模型的性能和可解释性。一方面,挖掘癫痫脑电信号中尚未被充分利用
的信息,丰富特征维度。另一方面,深入研究不同特征之间的交互作用,让模型能够更


山东师范大学硕士学位论文
58
好地学习和利用这些特征间的关系,从而提高对致痫区的定位精度。
(5)动态调整致痫区脑电码本。可解释的癫痫脑电预训练模型缺乏在训练过程中动
态调整编码本大小的机制,未来将考虑设计动态调整编码本大小的机制,避免手动选择
编码本大小,使模型能根据数据特点自动优化码本,提高模型的适应性和性能。
(6)多数据集验证计划。每个方法均只使用了一个数据集,不能很好的证明论文模
型的有效性,未来计划在多个不同的数据集上进行测试,验证其在不同场景和任务中的
性能表现。


山东师范大学硕士学位论文
59
参考文献
[1] 中国抗癫痫协会. 临床诊疗指南 癫痫病分册 2023 版 [M]. 北京: 人民卫生出版社, 2023:
15-171.
[2] Huang X, Sun X, Zhang L, et al. A novel epilepsy detection method based on feature extraction
by deep autoencoder on EEG signal [J]. International Journal of Environmental Research and
Public Health, 2022, 19(22): 15110.
[3] Wang L-H, Zhang Z-N, Xie C-X, et al. A Novel Real-Time Threshold Algorithm for Closed
Loop Epilepsy Detection and Stimulation System [J]. Sensors, 2024, 25(1): 33.
[4] Polat K, Güneş S. Classification of epileptiform EEG using a hybrid system based on decision
tree classifier and fast Fourier transform[J]. Applied Mathematics and Computation, 2007,
187(2): 1017-1026.
[5] Dash S, Dash D K, Tripathy R K, et al. Time–frequency domain machine learning for detection
of epilepsy using wearable EEG sensor signals recorded during physical activities[J].
Biomedical Signal Processing and Control, 2025, 100: 107041.
[6] Swami P, Maheshwari J, Kumar M, et al. Evolutionary transfer optimization-based approach
for automated ictal pattern recognition using brain signals[J]. Frontiers in Human
Neuroscience, 2024, 18: 1386168.
[7] Savadkoohi M, Oladunni T, Thompson L. A machine learning approach to epileptic seizure
prediction using Electroencephalogram (EEG) Signal[J]. Biocybernetics and Biomedical
Engineering, 2020, 40(3): 1328-1341.
[8] Kong G, Ma S, Zhao W, et al. A novel method for optimizing epilepsy detection features
through multi-domain feature fusion and selection[J]. Frontiers in Computational
Neuroscience, 2024, 18: 1416838.
[9] Fan Q, Jiang L, El Gohary A, et al. A multi-domain feature fusion epilepsy seizure detection
method based on spike matching and PLV functional networks[J]. Journal of Neural
Engineering, 2025, 22(1): 016025.


山东师范大学硕士学位论文
60
[10]O'shea K, Nash R. An introduction to convolutional neural networks [J]. arXiv:151108458,
2015.
[11] Medsker L R, Jain L. Recurrent neural networks [J]. Design and Applications, 2001, 5(64-67):
2.
[12]Scarselli F, Gori M, Tsoi A C, et al. The graph neural network model [J]. IEEE Transactions
on Neural Networks, 2008, 20(1): 61-80.
[13]刘 启 元,张 栋,吴 良 庆,等.基 于 上 下 文 增 强 LSTM 的 多 模 态 情 感 分 析[J].计 算 机 科
学,2019,46(11):181-185.
[14]Zhang L, Wang X, Jiang J, et al. Automatic interictal epileptiform discharge (IED) detection
based on convolutional neural network (CNN)[J]. Frontiers in Molecular Biosciences, 2023,
10: 1146606.
[15]Abderrahim N, Echtioui A, Khemakhem R, et al. Epileptic seizures detection using iEEG
signals and deep learning models[J]. Circuits, Systems, and Signal Processing, 2024, 43(3):
1597-1626.
[16]Pilcevic D, Djuric Jovicic M, Antonijevic M, et al. Performance evaluation of metaheuristics
tuned recurrent neural networks for electroencephalography anomaly detection[J]. Frontiers
in Physiology, 2023, 14: 1267011.
[17]Hochreiter S, Schmidhuber J. Long short-term memory [J]. Neural Computation, 1997, 9(8):
1735-1780.
[18]Najafi T, Jaafar R, Remli R, et al. A classification model of EEG signals based on RNN-LSTM
for diagnosing focal and generalized epilepsy[J]. Sensors, 2022, 22(19): 7269.
[19]Tang Y, Wu Q, Mao H, et al. Epileptic seizure detection based on path signature and Bi-LSTM
network with attention mechanism[J]. IEEE Transactions on Neural Systems and
Rehabilitation Engineering, 2024, 32: 304-313.
[20]Ravi S, Radhakrishnan A. A hybrid 1D CNN-BiLSTM model for epileptic seizure detection
using multichannel EEG feature fusion[J]. Biomedical Physics & Engineering Express, 2024,
10(3): 035040.
[21]Mohammed A H, Cabrerizo M, Pinzon A, et al. Graph neural networks in EEG spike


山东师范大学硕士学位论文
61
detection[J]. Artificial Intelligence in Medicine, 2023, 145: 102663.
[22]Wang J, Liang S, Zhang J, et al. EEG signal epilepsy detection with a weighted neighbor graph
representation and two-stream graph-based framework[J]. IEEE Transactions on Neural
Systems and Rehabilitation Engineering, 2023, 31: 3176-3187.
[23]Liu G, Yan Y, Cai J, et al. GCD: Graph contrastive denoising module for GNNs in EEG
classification[J]. Expert Systems with Applications, 2025, 265: 126013.
[24]Abadal S, Galván P, Mármol A, et al. Graph neural networks for electroencephalogram
analysis: Alzheimer’s disease and epilepsy use cases[J]. Neural Networks, 2025, 181: 106792.
[25]Islam T, Islam R, Basak M, et al. Performance investigation of epilepsy detection from noisy
EEG signals using base-2-meta stacking classifier[J]. Scientific Reports, 2024, 14(1): 10792.
[26]Shen M, Yang F, Wen P, et al. A real-time epilepsy seizure detection approach based on EEG
using short-time Fourier transform and Google-Net convolutional neural network[J]. Heliyon,
2024, 10(11): e31827.
[27]Xu T, Wu Y, Tang Y, et al. Dynamic functional connectivity neural network for epileptic
seizure prediction using multi-channel EEG signal[J]. IEEE Signal Processing Letters, 2024,
31: 1499-1503.
[28]Madhavan S, Tripathy R K, Pachori R B. Time-frequency domain deep convolutional neural
network for the classification of focal and non-focal EEG signals[J]. IEEE Sensors Journal,
2019, 20(6): 3078-3086.
[29]Jabran Y, Mahmoudzadeh M, Martinez N, et al. Temporal and spatial dynamics of different
interictal epileptic discharges: a time-frequency EEG approach in pediatric focal refractory
epilepsy[J]. Frontiers in Neurology, 2020, 11: 941.
[30]Al-Salman W, Li Y, Wen P, et al. Extracting epileptic features in EEGs using a dual-tree
complex wavelet transform coupled with a classification algorithm[J]. Brain Research, 2022,
1779: 147777.
[31]Abirami S, Kathiravan M, Yuvraj R, et al. Automated multi-class seizure-type classification
system using EEG signals and machine learning algorithms[J]. IEEE Access, 2024, 12:
136524-136541.


山东师范大学硕士学位论文
62
[32]Partamian H, Jahromi S, Corona L, et al. Machine learning on interictal intracranial EEG
predicts surgical outcome in drug resistant epilepsy[J]. NPJ Digital Medicine, 2025, 8(1): 138.
[33]Sharma R, Sircar P, Pachori R B. Automated focal EEG signal detection based on third order
cumulant function[J]. Biomedical signal processing and control, 2020, 58: 101856.
[34]Yakovleva T V, Kutepov I E, Karas A Y, et al. EEG analysis in structural focal epilepsy using
the methods of nonlinear dynamics (Lyapunov exponents, Lempel–Ziv complexity, and
multiscale entropy)[J]. The Scientific World Journal, 2020, 2020(1): 8407872.
[35]You Y, Chen W, Li M, et al. Automatic focal and non-focal EEG detection using entropy-based
features from flexible analytic wavelet transform[J]. Biomedical Signal Processing and
Control, 2020, 57: 101761.
[36]Karasmanoglou A, Giannakakis G, Vorgia P, et al. Semi-Supervised anomaly detection for the
prediction and detection of pediatric focal epileptic seizures on fused EEG and ECG data[J].
Biomedical Signal Processing and Control, 2025, 101: 107083.
[37]Sairamya N J, Subathra M S P, Suviseshamuthu E S, et al. A new approach for automatic
detection of focal EEG signals using wavelet packet decomposition and quad binary pattern
method[J]. Biomedical Signal Processing and Control, 2021, 63: 102096.
[38]Saminu S, Xu G, Shuai Z, et al. Application of deep learning and WT-SST in localization of
epileptogenic zone using epileptic EEG signals[J]. Applied Sciences, 2022, 12(10): 4879.
[39]Grattarola D, Livi L, Alippi C, et al. Seizure localisation with attention-based graph neural
networks[J]. Expert systems with applications, 2022, 203: 117330.
[40]Liu X, Ding X, Liu J, et al. Automatic focal EEG identification based on deep reinforcement
learning[J]. Biomedical Signal Processing and Control, 2023, 83: 104693.
[41]Karimi-Rouzbahani H, McGonigal A. Generalisability of epileptiform patterns across time
and patients[J]. Scientific Reports, 2024, 14(1): 6293.
[42]Eldele E, Ragab M, Chen Z, et al. Time-series representation learning via temporal and
contextual contrasting[J]. arXiv: 2106.14112, 2021.
[43] 解骞,刘柏泽,丁进中,等.基于多粒度注意力机制的隔离开关故 障诊断[J].电工电能新技
术,2024,43(10):71-84.


山东师范大学硕士学位论文
63
[44]Wang Z, Yan W, Oates T. Time series classification from scratch with deep neural networks:
A strong baseline[C]. 2017 International Joint Conference on Neural Networks, 2017: 1578
1585.
[45]Devlin J, Chang M W, Lee K, et al. Bert: Pre-training of deep bidirectional transformers for
language understanding[C]. Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language Technologies,
2019: 4171-4186.
[46]Chen T, Kornblith S, Norouzi M, et al. A simple framework for contrastive learning of visual
representations[C]. International Conference on Machine Learning, 2020: 1597-1607.
[47]Obeid I, Picone J. The temple university hospital EEG data corpus[J]. Frontiers in
neuroscience, 2016, 10: 196.
[48]Shah V, Von Weltin E, Lopez S, et al. The temple university hospital seizure detection
corpus[J]. Frontiers in Neuroinformatics, 2018, 12: 83.
[49]McCallan N, Davidson S, Ng K Y, et al. Epileptic multi-seizure type classification using
electroencephalogram signals from the Temple University Hospital Seizure Corpus: A
review[J]. Expert Systems with Applications, 2023, 234: 121040.
[50]Liu Y, Jiang Y, Liu J, et al. Efficient EEG Feature Learning Model Combining Random
Convolutional Kernel with Wavelet Scattering for Seizure Detection[J]. International Journal
of Neural Systems, 2024, 34(11): 2450060-2450060.
[51]Zhu Y, Saqib M, Ham E, et al. Mitigating patient-to-patient variation in EEG seizure detection
using meta transfer learning[C]. 2020 IEEE 20th International Conference on Bioinformatics
and Bioengineering, 2020: 548-555.
[52]Tsiouris K M, Konitsiotis S, Gatsios D, et al. Automatic absence seizures detection in EEG
signals: an unsupervised module[C]. 2020 42nd Annual International Conference of the IEEE
Engineering in Medicine & Biology Society, 2020: 532-535.
[53]Zhang Z, Ren Y, Sabor N, et al. DWT‐Net: Seizure Detection System with Structured EEG
Montage and Multiple Feature Extractor in Convolution Neural Network[J]. Journal of
Sensors, 2020, 2020(7):1-13.


山东师范大学硕士学位论文
64
[54]Ayodele K P, Ikezogwo W O, Komolafe M A, et al. Supervised domain generalization for
integration of disparate scalp EEG datasets for automatic epileptic seizure detection[J].
Computers in Biology and Medicine, 2020, 120: 103757.
[55]Sabor N, Mohammed H, Li Z, et al. BHI-Net: Brain-heart interaction-based deep architectures
for epileptic seizures and firing location detection[J]. Ieee Transactions on Neural Systems
and Rehabilitation Engineering, 2022, 30: 1576-1588.
[56]Thuwajit P, Rangpong P, Sawangjai P, et al. EEGWaveNet: Multiscale CNN-based
spatiotemporal feature extraction for EEG seizure detection[J]. IEEE Transactions on
Industrial Informatics, 2021, 18(8): 5547-5557.
[57]Rahmani A, Venkitaraman A, Frossard P. A Meta-GNN approach to personalized seizure
detection and classification[C]. ICASSP 2023-2023 IEEE International Conference on
Acoustics, Speech and Signal Processing, 2023: 1-5.
[58]Baghersalimi S, Teijeiro T, Aminifar A, et al. Decentralized federated learning for epileptic
seizures detection in low-power wearable systems[J]. IEEE Transactions on Mobile
Computing, 2023, 23(5): 6392-6407.
[59]Statsenko Y, Babushkin V, Talako T, et al. Automatic detection and classification of epileptic
seizures from eeg data: Finding optimal acquisition settings and testing interpretable machine
learning approach[J]. Biomedicines, 2023, 11(9): 2370.
[60]Wen Y, Ma T, Weng L, et al. Abstracted Shapes as Tokens-A Generalizable and Interpretable
Model for Time-series Classification[J]. Advances in Neural Information Processing Systems,
2024, 37: 92246-92272.
[61]Nie Y, Nguyen N H, Sinthong P, et al. A time series is worth 64 words: Long-term forecasting
with transformers[J]. arXiv: 2211.14730, 2022.
[62]Goswami M, Szafer K, Choudhry A, et al. Moment: A family of open time-series foundation
models[J]. arXiv: 2402.03885, 2024.
[63]Esser P, Rombach R, Ommer B. Taming transformers for high-resolution image synthesis[C].
Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2021:
12873-12883.


山东师范大学硕士学位论文
65
[64]Van Den Oord A, Vinyals O. Neural discrete representation learning[C]. Proceedings of the
31st Annual Conference on Neural Information Processing Systems, 2017: 6306-6315.
[65]Yu L, Lezama J, Gundavarapu N B, et al. Language Model Beats Diffusion--Tokenizer is Key
to Visual Generation[J]. arXiv: 2310.05737, 2023.
[66]Koh P W, Nguyen T, Tang Y S, et al. Concept bottleneck models[C]. International Conference
on Machine Learning, 2020: 5338-5348.
[67]Hu X, Yuan S, Xu F, et al. Scalp EEG classification using deep Bi-LSTM network for seizure
detection[J]. Computers in Biology and Medicine, 2020, 124: 103919.
[68]Jenke R, Peer A, Buss M. Feature extraction and selection for emotion recognition from
EEG[J]. IEEE Transactions on Affective computing, 2014, 5(3): 327-339.
[69]Hariharan M, Sindhu R, Vijean V, et al. Improved binary dragonfly optimization algorithm
and wavelet packet based non-linear features for infant cry classification[J]. Computer
Methods and Programs in Biomedicine, 2018, 155: 39-51.
[70]Geethanjali P, Mohan Y K, Sen J. Time domain feature extraction and classification of EEG
data for brain computer interface[C]. 2012 9th International Conference on Fuzzy Systems
and Knowledge Discovery, 2012: 1136-1139.
[71]Memar P, Faradji F. A novel multi-class EEG-based sleep stage classification system[J]. IEEE
Transactions on Neural Systems and Rehabilitation Engineering, 2017, 26(1): 84-95.
[72]Şen B, Peker M, Çavuşoğlu A, et al. A comparative study on classification of sleep stage based
on EEG signals using feature selection and classification algorithms[J]. Journal of Medical
Systems, 2014, 38: 1-21.
[73]Gupta V, Priya T, Yadav A K, et al. Automated detection of focal EEG signals using features
extracted from flexible analytic wavelet transform[J]. Pattern Recognition Letters, 2017, 94:
180-188.
[74]Abou-Abbas L, Henni K, Jemal I, et al. Patient-independent epileptic seizure detection by
stable feature selection[J]. Expert Systems with Applications, 2023, 232: 120585.
[75]Acharya U R, Hagiwara Y, Koh J E W, et al. Entropies for automated detection of coronary
artery disease using ECG signals: A review[J]. Biocybernetics and Biomedical Engineering,


山东师范大学硕士学位论文
66
2018, 38(2): 373-384.
[76]He K, Chen X, Xie S, et al. Masked autoencoders are scalable vision learners[C]. Proceedings
of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2022: 16000
16009.
[77]Bagnall A, Dau H A, Lines J, et al. The UEA multivariate time series classification archive,
2018[J]. arXiv: 1811.00075, 2018.
[78]Sharma R, Pachori R B, Acharya U R. An integrated index for the identification of focal
electroencephalogram signals using discrete wavelet transform and entropy measures[J].
Entropy, 2015, 17(8): 5218-5240.
[79]Das A B, Bhuiyan M I H. Discrimination and classification of focal and non-focal EEG signals
using entropy-based features in the EMD-DWT domain[J]. Biomedical Signal Processing and
Control, 2016, 29: 11-21.
[80]Bhattacharyya A, Sharma M, Pachori R B, et al. A novel approach for automated detection of
focal EEG signals using empirical wavelet transform[J]. Neural Computing and Applications,
2018, 29: 47-57.
[81]Acharya U R, Hagiwara Y, Deshpande S N, et al. Characterization of focal EEG signals: a
review[J]. Future Generation Computer Systems, 2019, 91: 290-299.
[82]Modak S, Roy S S, Samanta K, et al. Detection of focal EEG signals employing weighted
visibility graph[C]. 2020 International Conference on Computer, Electrical & Communication
Engineering, 2020: 1-5.
[83]Akbari H, Sadiq M T. Detection of focal and non-focal EEG signals using non-linear features
derived from empirical wavelet transform rhythms[J]. Physical and Engineering Sciences in
Medicine, 2021, 44(1): 157-171.
[84]Narin A. Detection of focal and non-focal epileptic seizure using continuous wavelet
transform-based scalogram images and pre-trained deep neural networks[J]. Irbm, 2022, 43(1):
22-31.